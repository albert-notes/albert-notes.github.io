<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>2021 AIS3 Pre-exam Write Up | M3t30r</title><meta name="keywords" content="AIS3,Security,CTF"><meta name="author" content="Albert Huang"><meta name="copyright" content="Albert Huang"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="ä»Šå¹´ç¬¬ä¸€æ¬¡åƒåŠ AIS3 Pre-examï¼Œä¹‹å‰æœ‰å…ˆçœ‹éä¸€äº›åˆ¥äººå¯«çš„Write Upsï¼Œç™¼ç¾ä»Šå¹´çš„è§£é¡Œæƒ³æ³•å¥½åƒå·®è »å¤šçš„TATï¼Œä»Šå¹´æˆç¸¾ç¬¬71åï¼Œç®—åœ¨éŒ„å–é‚Šç·£ï¼ŒæœŸå¾…æ˜å¹´æˆ‘èƒ½è¡¨ç¾æ›´å¥½å›‰! é€™è£¡å°±ä¾†æ•´ç†ä¸€ä¸‹æˆ‘è³½ä¸­è·Ÿè³½å¾Œæœ‰è§£å‡ºçš„é¡Œç›®å§!å¦‚æœè¦ºå¾—æœ‰å•é¡Œçš„è©±å¯ä»¥åœ¨ç•™è¨€å€å‘Šè¨´æˆ‘å–”XD P.S. ä¹‹å‰è³½å¾Œäº¤å‡ºå»çš„é‚£ä»½Write Upè¦ºå¾—å¤ªçˆ›äº†ä¸æƒ³è²¼å‡ºä¾†ï¼Œæ±ºå®šé‡æ‰“ä¸€ä»½w  WelcomeCat Slayer á¶ áµƒáµáµ‰">
<meta property="og:type" content="article">
<meta property="og:title" content="2021 AIS3 Pre-exam Write Up">
<meta property="og:url" content="http://albert-notes.github.io/2021/06/06/AIS3-2021-preexam/index.html">
<meta property="og:site_name" content="M3t30r">
<meta property="og:description" content="ä»Šå¹´ç¬¬ä¸€æ¬¡åƒåŠ AIS3 Pre-examï¼Œä¹‹å‰æœ‰å…ˆçœ‹éä¸€äº›åˆ¥äººå¯«çš„Write Upsï¼Œç™¼ç¾ä»Šå¹´çš„è§£é¡Œæƒ³æ³•å¥½åƒå·®è »å¤šçš„TATï¼Œä»Šå¹´æˆç¸¾ç¬¬71åï¼Œç®—åœ¨éŒ„å–é‚Šç·£ï¼ŒæœŸå¾…æ˜å¹´æˆ‘èƒ½è¡¨ç¾æ›´å¥½å›‰! é€™è£¡å°±ä¾†æ•´ç†ä¸€ä¸‹æˆ‘è³½ä¸­è·Ÿè³½å¾Œæœ‰è§£å‡ºçš„é¡Œç›®å§!å¦‚æœè¦ºå¾—æœ‰å•é¡Œçš„è©±å¯ä»¥åœ¨ç•™è¨€å€å‘Šè¨´æˆ‘å–”XD P.S. ä¹‹å‰è³½å¾Œäº¤å‡ºå»çš„é‚£ä»½Write Upè¦ºå¾—å¤ªçˆ›äº†ä¸æƒ³è²¼å‡ºä¾†ï¼Œæ±ºå®šé‡æ‰“ä¸€ä»½w  WelcomeCat Slayer á¶ áµƒáµáµ‰">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://albert-notes.github.io/img/ais.png">
<meta property="article:published_time" content="2021-06-06T06:08:29.000Z">
<meta property="article:modified_time" content="2021-06-07T03:09:24.087Z">
<meta property="article:author" content="Albert Huang">
<meta property="article:tag" content="AIS3">
<meta property="article:tag" content="Security">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://albert-notes.github.io/img/ais.png"><link rel="shortcut icon" href="/img/ken.jpg"><link rel="canonical" href="http://albert-notes.github.io/2021/06/06/AIS3-2021-preexam/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-06-07 11:09:24'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/ban.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">8</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">10</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/certificates/"><i class="fa-fw fas fa-certificate"></i><span> Certificates</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/ais.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">M3t30r</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/certificates/"><i class="fa-fw fas fa-certificate"></i><span> Certificates</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">2021 AIS3 Pre-exam Write Up</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2021-06-06T06:08:29.000Z" title="Created 2021-06-06 14:08:29">2021-06-06</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2021-06-07T03:09:24.087Z" title="Updated 2021-06-07 11:09:24">2021-06-07</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Computer-Science/">Computer Science</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">4.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>19min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="2021 AIS3 Pre-exam Write Up"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>ä»Šå¹´ç¬¬ä¸€æ¬¡åƒåŠ AIS3 Pre-examï¼Œä¹‹å‰æœ‰å…ˆçœ‹éä¸€äº›åˆ¥äººå¯«çš„Write Upsï¼Œç™¼ç¾ä»Šå¹´çš„è§£é¡Œæƒ³æ³•å¥½åƒå·®è »å¤šçš„TATï¼Œä»Šå¹´æˆç¸¾ç¬¬71åï¼Œç®—åœ¨éŒ„å–é‚Šç·£ï¼ŒæœŸå¾…æ˜å¹´æˆ‘èƒ½è¡¨ç¾æ›´å¥½å›‰!</p>
<p>é€™è£¡å°±ä¾†æ•´ç†ä¸€ä¸‹æˆ‘è³½ä¸­è·Ÿè³½å¾Œæœ‰è§£å‡ºçš„é¡Œç›®å§!å¦‚æœè¦ºå¾—æœ‰å•é¡Œçš„è©±å¯ä»¥åœ¨ç•™è¨€å€å‘Šè¨´æˆ‘å–”XD</p>
<p>P.S. ä¹‹å‰è³½å¾Œäº¤å‡ºå»çš„é‚£ä»½Write Upè¦ºå¾—å¤ªçˆ›äº†ä¸æƒ³è²¼å‡ºä¾†ï¼Œæ±ºå®šé‡æ‰“ä¸€ä»½w</p>
<p><img src="https://i.imgur.com/B8OCOaR.png"></p>
<h1 id="Welcome"><a href="#Welcome" class="headerlink" title="Welcome"></a>Welcome</h1><h2 id="Cat-Slayer-á¶ áµƒáµáµ‰-Nekogoroshi"><a href="#Cat-Slayer-á¶ áµƒáµáµ‰-Nekogoroshi" class="headerlink" title="Cat Slayer á¶ áµƒáµáµ‰ | Nekogoroshi"></a>Cat Slayer á¶ áµƒáµáµ‰ | Nekogoroshi</h2><blockquote>
<p>Author: splitline feat. Hojo Satoko</p>
</blockquote>
<p>é¡Œç›®çµ¦äº†ä¸€è¡Œcommand</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TERM=xterm-256color ssh -p 5566 h173@quiz.ais3.org</span><br></pre></td></tr></table></figure>
<p>æŠŠå®ƒæ‹¿åˆ°TerminalåŸ·è¡Œå¾Œå¯ä»¥ç™¼ç¾ä»–è·³å‡ºäº†ä¸€å€‹Pythonçš„åŸ·è¡Œç•«é¢ï¼Œç”¨éµç›¤å¯ä»¥è¼¸å…¥æ•¸å­—ï¼Œè¼¸å…¥éŒ¯èª¤æœƒé–èµ·ä¾†ï¼Œå› æ­¤å¯ä»¥ç”¨æ‰‹å‹•çš„è¼¸å…¥çŒœå¯†ç¢¼ï¼Œå¾—åˆ°æ­£ç¢ºçš„å¯†ç¢¼å°±å¯ä»¥è§£é–flagã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Password: 202583045529</span><br></pre></td></tr></table></figure>
<p>FLAG:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;H1n4m1z4w4_Sh0k0gun&#125;</span><br></pre></td></tr></table></figure>

<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="Microcheese"><a href="#Microcheese" class="headerlink" title="Microcheese"></a>Microcheese</h2><blockquote>
<p>Author: toxicpie</p>
</blockquote>
<p>é€™é¡Œä¸€æ¨£çµ¦äº†ncè·Ÿsource codeï¼Œä½†source codeçœ‹äº†åŠå¤©é‚„æ˜¯æ²’ä»€éº¼æƒ³æ³•ï¼Œå…ˆå»ncç©ç©å†èªªã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">$ nc quiz.ais3.org 10234</span><br><span class="line">+-------------------- welcome --------------------+</span><br><span class="line">| omg hi!                                         |</span><br><span class="line">|                                                 |</span><br><span class="line">| welcome to microchess, the minimal online chess |</span><br><span class="line">| platform.                                       |</span><br><span class="line">| i am a super powerful chess AI!                 |</span><br><span class="line">| can you win against me and get the flag?        |</span><br><span class="line">+---+--------------- main menu -------------------+</span><br><span class="line">| 0 | read the rules of the game                  |</span><br><span class="line">| 1 | start a new game against me                 |</span><br><span class="line">| 2 | load a saved game                           |</span><br><span class="line">| 3 | leave                                       |</span><br><span class="line">+---+---------------------------------------------+</span><br><span class="line">what would you like to do? 1</span><br><span class="line">+---+-------------- stones info ------------------+</span><br><span class="line">| 0 | ooooooooooooo                               |</span><br><span class="line">| 1 | ooooo                                       |</span><br><span class="line">| 2 | ooooooooooo                                 |</span><br><span class="line">| 3 | o                                           |</span><br><span class="line">| 4 | oooooooooooooooooooooooooooooo              |</span><br><span class="line">| 5 | ooooooo                                     |</span><br><span class="line">| 6 | ooooooooooooooooooooooooooo                 |</span><br><span class="line">+---+--------------- game menu -------------------+</span><br><span class="line">| 0 | make a move                                 |</span><br><span class="line">| 1 | save the current game and leave             |</span><br><span class="line">| 2 | resign the game                             |</span><br><span class="line">+---+---------------------------------------------+</span><br><span class="line">it&#39;s your turn to move! what do you choose? 0</span><br><span class="line">which pile do you choose? 3</span><br><span class="line">how many stones do you remove? 1</span><br><span class="line">+--------------------- moved ---------------------+</span><br><span class="line">| you removed 1 stones from pile 3                |</span><br><span class="line">+---+-------------- stones info ------------------+</span><br><span class="line">| 0 | ooooooooooooo                               |</span><br><span class="line">| 1 | ooooo                                       |</span><br><span class="line">| 2 | ooooooooooo                                 |</span><br><span class="line">| 3 | oooooooooooooooooooooooooooooo              |</span><br><span class="line">| 4 | ooooooo                                     |</span><br><span class="line">| 5 | ooooooooooooooooooooooooooo                 |</span><br><span class="line">+--------------------- moved ---------------------+</span><br><span class="line">| i removed 1 stones from pile 0                  |</span><br><span class="line">+---+-------------- stones info ------------------+</span><br><span class="line">| 0 | oooooooooooo                                |</span><br><span class="line">| 1 | ooooo                                       |</span><br><span class="line">| 2 | ooooooooooo                                 |</span><br><span class="line">| 3 | oooooooooooooooooooooooooooooo              |</span><br><span class="line">| 4 | ooooooo                                     |</span><br><span class="line">| 5 | ooooooooooooooooooooooooooo                 |</span><br><span class="line">+---+--------------- game menu -------------------+</span><br><span class="line">| 0 | make a move                                 |</span><br><span class="line">| 1 | save the current game and leave             |</span><br><span class="line">| 2 | resign the game                             |</span><br><span class="line">+---+---------------------------------------------+</span><br><span class="line">it&#39;s your turn to move! what do you choose?</span><br></pre></td></tr></table></figure>

<p>çœ‹èµ·ä¾†æ˜¯å€‹éŠæˆ²ï¼Œä½†ç©äº†å¹¾è¼ªä¹‹å¾Œç™¼ç¾æ€éº¼ç©éƒ½è¼¸ï¼Œå›å»çœ‹source codeç™¼ç¾<code>game.py</code>è£¡é¢å¥½åƒæœ‰äº›æ±è¥¿ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Tuple</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Game</span>:</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    a simple Nim game with normal rules.</span></span><br><span class="line"><span class="string">    grundy&#x27;s theorem: if nim_sum() is zero, then the player to move has a</span></span><br><span class="line"><span class="string">    winning strategy. otherwise, the other player has a winning strategy.</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.stones = []</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">generate_winning_game</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;generate a game such that the first player has a winning strategy&#x27;&#x27;&#x27;</span></span><br><span class="line">        self.stones = []</span><br><span class="line">        xor_sum = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        piles = random.randint(<span class="number">6</span>, <span class="number">8</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(piles):</span><br><span class="line">            self.stones.append(count := random.randint(<span class="number">1</span>, <span class="number">31</span>))</span><br><span class="line">            xor_sum ^= count</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> xor_sum == <span class="number">0</span>:</span><br><span class="line">            self.stones.append(random.randint(<span class="number">1</span>, <span class="number">31</span>))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">generate_losing_game</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;generate a game such that the second player has a winning strategy&#x27;&#x27;&#x27;</span></span><br><span class="line">        self.stones = []</span><br><span class="line">        xor_sum = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        piles = random.randint(<span class="number">6</span>, <span class="number">8</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(piles):</span><br><span class="line">            self.stones.append(count := random.randint(<span class="number">1</span>, <span class="number">31</span>))</span><br><span class="line">            xor_sum ^= count</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> xor_sum != <span class="number">0</span>:</span><br><span class="line">            self.stones.append(xor_sum)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">make_move</span>(<span class="params">self, pile: <span class="built_in">int</span>, count: <span class="built_in">int</span></span>) -&gt; <span class="built_in">bool</span>:</span></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;makes a move, returns whether the move is legal&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> pile <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(self.stones)):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">if</span> count <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, self.stones[pile] + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        self.stones[pile] -= count</span><br><span class="line">        <span class="keyword">if</span> self.stones[pile] == <span class="number">0</span>:</span><br><span class="line">            self.stones.pop(pile)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">nim_sum</span>(<span class="params">self</span>) -&gt; <span class="built_in">int</span>:</span></span><br><span class="line">        xor_sum = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> count <span class="keyword">in</span> self.stones:</span><br><span class="line">            xor_sum ^= count</span><br><span class="line">        <span class="keyword">return</span> xor_sum</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">ended</span>(<span class="params">self</span>) -&gt; <span class="built_in">bool</span>:</span></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        checks if the game has ended, i.e., the player has no more moves.</span></span><br><span class="line"><span class="string">        if True, the current player loses the game</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(self.stones) == <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">show</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;+---+-------------- stones info ------------------+&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> pile, count <span class="keyword">in</span> <span class="built_in">enumerate</span>(self.stones):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;| <span class="subst">&#123;pile&#125;</span> | <span class="subst">&#123;<span class="string">&quot;o&quot;</span> * count:&lt;<span class="number">43</span>&#125;</span> |&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">load</span>(<span class="params">self, game_str: <span class="built_in">str</span></span>) -&gt; <span class="literal">None</span>:</span></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;loads a saved game from string&#x27;&#x27;&#x27;</span></span><br><span class="line">        self.stones = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>, game_str.split(<span class="string">&#x27;,&#x27;</span>)))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">save</span>(<span class="params">self</span>) -&gt; <span class="built_in">str</span>:</span></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;returns the current game as a string&#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;,&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, self.stones))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AIPlayer</span>:</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    a perfect Nim player. if there exists a winning strategy for a game, this</span></span><br><span class="line"><span class="string">    player will always win.</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_move</span>(<span class="params">self, game: Game</span>) -&gt; <span class="type">Tuple</span>[<span class="built_in">int</span>, <span class="built_in">int</span>]:</span></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        if there is a winning strategy, returns a move that guarantees a win.</span></span><br><span class="line"><span class="string">        otherwise, returns a random move.</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        nim_sum = game.nim_sum()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> nim_sum == <span class="number">0</span>:</span><br><span class="line">            <span class="comment"># losing game, make a random move</span></span><br><span class="line">            pile = random.randint(<span class="number">0</span>, <span class="built_in">len</span>(game.stones) - <span class="number">1</span>)</span><br><span class="line">            count = random.randint(<span class="number">1</span>, game.stones[pile])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># winning game, make a winning move</span></span><br><span class="line">            <span class="keyword">for</span> i, v <span class="keyword">in</span> <span class="built_in">enumerate</span>(game.stones):</span><br><span class="line">                target = v ^ nim_sum</span><br><span class="line">                <span class="keyword">if</span> target &lt; v:</span><br><span class="line">                    pile = i</span><br><span class="line">                    count = v - target</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> (pile, count)</span><br></pre></td></tr></table></figure>

<p>å¾ç¨‹å¼å…§å®¹è·Ÿè¨»è§£å¯ä»¥å¾ˆæ˜é¡¯çš„çœ‹åˆ°ï¼Œæ¯”è³½çš„å¿…å‹é—œéµä¾¿æ˜¯ç›¤é¢æ‰€æœ‰è¡Œæ£‹æ•¸çš„xorç‚º0ã€‚ä½†æ˜¯ç¨‹å¼è£¡é¢çš„AIPlayerä¾¿æ˜¯åˆ©ç”¨é€™å€‹è¦å‰‡ï¼Œè®“è‡ªå·±ä¸‹å®Œæ™‚çš„ç›¤é¢ä¿æŒ0çš„ç‹€æ…‹ï¼Œæœç„¶æ˜¯å¿…å‹è¨£ç«…é˜¿â€¦</p>
<p>åŸæœ¬é€™é¡Œè³½ä¸­æˆ‘æ‡‰è©²æ˜¯è§£ä¸å‡ºä¾†çš„ï¼Œä½†æ˜¯å› ç‚ºæœ‰ä¸€æ¬¡æŠŠè™Ÿç¢¼æŒ‰éŒ¯ä¹‹å¾Œç™¼ç¾ä¸€å€‹è¶…ç´šå¤§çš„bugï¼Œç•¶æˆ‘åœ¨é¸æ“‡ä¸‹ä¸€å€‹æ­¥é©Ÿæ™‚ï¼Œæˆ‘æŒ‰äº†<code>3</code>(ä¸åœ¨æŒ‰éˆ•å…§)ï¼Œçµæœä»–å°±ç›´æ¥è·³éäº†æˆ‘çš„å›åˆï¼Œè®“ç›¤é¢ä¸å†ä¿æŒxorç‚º0çš„ç‹€æ…‹ï¼Œæ¥è‘—å°±åªéœ€è¦è®“æœ€å¾Œä¸€é¡†æ£‹æ˜¯ç”±æˆ‘æ‹¿èµ°çš„å°±å¯ä»¥æ‹¿åˆ°flagäº†ã€‚</p>
<p>P.S. é€™æ‡‰è©²æ˜¯å› ç‚ºæ²’æœ‰éæ¿¾å…¶ä»–è¼¸å…¥çš„å•é¡Œâ€¦ç¸½ä¹‹æˆ‘æ‹¿åˆ°flagäº†XD</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">+---+--------------- game menu -------------------+</span><br><span class="line">| 0 | make a move                                 |</span><br><span class="line">| 1 | save the current game and leave             |</span><br><span class="line">| 2 | resign the game                             |</span><br><span class="line">+---+---------------------------------------------+</span><br><span class="line">it&#39;s your turn to move! what do you choose? 3</span><br><span class="line">+--------------------- moved ---------------------+</span><br><span class="line">| you removed 3 stones from pile 1                |</span><br><span class="line">+---+-------------- stones info ------------------+</span><br><span class="line">| 0 | o                                           |</span><br><span class="line">| 1 | o                                           |</span><br><span class="line">+--------------------- moved ---------------------+</span><br><span class="line">| i removed 1 stones from pile 1                  |</span><br><span class="line">+---+-------------- stones info ------------------+</span><br><span class="line">| 0 | o                                           |</span><br><span class="line">+---+--------------- game menu -------------------+</span><br><span class="line">| 0 | make a move                                 |</span><br><span class="line">| 1 | save the current game and leave             |</span><br><span class="line">| 2 | resign the game                             |</span><br><span class="line">+---+---------------------------------------------+</span><br><span class="line">it&#39;s your turn to move! what do you choose? 0</span><br><span class="line">which pile do you choose? 0</span><br><span class="line">how many stones do you remove? 1</span><br><span class="line">+---------------- congratulations ----------------+</span><br><span class="line">| you are a true grandmaster of chess! here is    |</span><br><span class="line">| the flag for you:                               |</span><br><span class="line">| AIS3&#123;5._e3_b5_6._a4_Bb4_7._Bd2_a5_8._axb5_Bxc3&#125; |</span><br><span class="line">+-------------------------------------------------+</span><br></pre></td></tr></table></figure>

<p>FLAG:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;5._e3_b5_6._a4_Bb4_7._Bd2_a5_8._axb5_Bxc3&#125;</span><br></pre></td></tr></table></figure>


<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="â²©â²‰â²§-â²â²›â²Ÿâ²§â²â²‰s-ğ“µâ²Ÿğ“°â²“â²›-â²£â²ğ“°â²‰"><a href="#â²©â²‰â²§-â²â²›â²Ÿâ²§â²â²‰s-ğ“µâ²Ÿğ“°â²“â²›-â²£â²ğ“°â²‰" class="headerlink" title="â²©â²‰â²§ â²â²›â²Ÿâ²§â²â²‰ê… ğ“µâ²Ÿğ“°â²“â²› â²£â²ğ“°â²‰"></a>â²©â²‰â²§ â²â²›â²Ÿâ²§â²â²‰ê… ğ“µâ²Ÿğ“°â²“â²› â²£â²ğ“°â²‰</h2><blockquote>
<p>Author: splitline</p>
</blockquote>
<p>é€™é¡Œçµ¦äº†ä¸€å€‹å¾ˆé›£æŒ‰çš„é¡Œç›®ï¼Œé€£é€²å»ä¹‹å¾Œç™¼ç¾æ˜¯ä¸€å€‹loginç•«é¢ï¼Œé‚„æœ‰ä¸€å€‹sauce linkï¼Œå…ˆé»é€²å»çœ‹åŸå§‹ç¢¼ï¼Œç™¼ç¾ä»–æ˜¯ä¸€å€‹jsonè³‡æ–™åº«ï¼Œè£¡é¢å­˜æœ‰ç™»å…¥çš„è³‡è¨Š:</p>
<p><img src="https://i.imgur.com/zv1wxp9.png"></p>
<p>ç”¨äº†guestæˆåŠŸç™»å…¥ï¼Œä½†æ²’æœ‰flagã€‚æ¥è‘—ç”¨adminè©¦è©¦ï¼Œå› ç‚ºos.environ.get()çš„æ„æ€æ˜¯å¦‚æœkeyä¸å­˜åœ¨å°±ç”¨å¾Œé¢çš„å€¼ä¾†ä»£æ›¿ï¼Œä½†æ˜¯é‚„æ˜¯ç™»å…¥å¤±æ•—äº†ã€‚</p>
<p>æ¥è‘—è§€å¯Ÿè¼¸å…¥å¾Œçš„è¡Œç‚º:</p>
<p><img src="https://i.imgur.com/etLTbQM.png"></p>
<p>ä»–æŠŠæˆ‘å€‘çš„è¼¸å…¥å¡é€²äº†<code>%s</code>çš„åœ°æ–¹åŒ…è£æˆjsonæ ¼å¼ï¼Œä½†ä»–ä¸¦æ²’æœ‰éæ¿¾<code>%s</code>çš„å…§å®¹ï¼Œæ‰€ä»¥å¯ä»¥å¾è¼¸å…¥å‹•æ‰‹è…³ã€‚</p>
<p>å¾ä¸Šé¢å¯ä»¥çœ‹å‡ºä¾†ï¼Œä»–æŠŠæ–°è¼¸å…¥çš„ä½¿ç”¨è€…showflagåƒæ•¸ä¸€å¾‹è¨­ç‚º$false$ï¼Œæ‰€ä»¥æˆ‘å€‘æ‹¿ä¸åˆ°flagã€‚ä½†å¦‚æœæˆ‘å€‘åœ¨è¼¸å…¥ä¸­å¡å…¥jsonæ ¼å¼çš„æ–‡å­—ï¼Œä»–å°±æœƒè¢«åŒ…åˆ°é€™å€‹jsonè£¡é¢é€é€²å»åŸ·è¡Œã€‚</p>
<p>ä½†å› ç‚ºæˆ‘å€‘å¿…é ˆæ§‹é€ ä¸€å€‹ä¸å­˜åœ¨æ–¼åŸdatabaseçš„ä½¿ç”¨è€…ï¼Œè€Œjsonæ‰¾ä¸åˆ°usernameæœƒå›å‚³$null$ï¼Œå› æ­¤æˆ‘å€‘å°‡passwordä¹Ÿè¨­ç‚º$null$å³å¯ã€‚</p>
<p>æ§‹é€ payload:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username payload: M3t30r&quot;, &quot;showflag&quot;: true, &quot;username&quot;: &quot;m3t30r</span><br><span class="line">password payload: M3T30r&quot;, &quot;password&quot;: null, &quot;username&quot;: &quot;M3T30R</span><br></pre></td></tr></table></figure>
<p>FLAG:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;&#x2F;r&#x2F;badUIbattles?!?!&#125;</span><br></pre></td></tr></table></figure>

<h2 id="HaaS"><a href="#HaaS" class="headerlink" title="HaaS"></a>HaaS</h2><blockquote>
<p>Author: anonymous</p>
</blockquote>
<p>é€£é€²é€™é¡Œçš„ç¶²å€å¾Œæœƒæ˜¯/haasçš„åˆ†é ï¼Œä½†æœƒé¡¯ç¤ºå‡º405 Method Not Allowed Error<br><img src="https://i.imgur.com/26qcGuM.png"></p>
<p>ç¨å¾®åœ¨ç¶²é ä¸­ç¿»æ‰¾ä¸€ä¸‹æœƒç™¼ç¾æ ¹ç›®éŒ„è£¡é¢æ˜¯ä¸€å€‹â€HealthCheck as a Serviceâ€ç¶²ç«™ï¼Œæœ‰ä¸€å€‹å¯ä»¥è¼¸å…¥ç¶²å€çš„æ¬„ä½ï¼Œç”¨F12ç¿»ä¸€ä¸‹é‚„å¯ä»¥ç™¼ç¾ä¸€å€‹hiddençš„status codeåƒæ•¸ã€‚</p>
<p><img src="https://i.imgur.com/1PiS3kH.png"></p>
<p>ä¸€é–‹å§‹è©¦äº†ä¸€äº›Command Injectionä¹‹é¡çš„æ±è¥¿ï¼Œä½†ç™¼ç¾å¥½åƒä¸å¤ªè¡Œã€‚å¾Œä¾†æ‰“é–‹Hintè£¡é¢å¯«äº†<code>SSRF</code>ï¼Œå°±é–‹å§‹å¾€localhostçš„æ–¹å‘èµ°äº†ï¼Œä½†æ˜¯å¦‚æœç›´æ¥é€£é€²localhostçš„IP(<a target="_blank" rel="noopener" href="https://127.0.0.1/)%E8%B7%9Fdomain%E6%9C%83%E7%99%BC%E7%8F%BE%E4%BB%96%E8%A2%AB%E9%81%8E%E6%BF%BE%E4%BA%86">https://127.0.0.1/)è·Ÿdomainæœƒç™¼ç¾ä»–è¢«éæ¿¾äº†</a>:</p>
<p><img src="https://i.imgur.com/t8TKijf.png"></p>
<p>æ–¼æ˜¯é–‹å§‹å˜—è©¦SSRFçš„bypassæ–¹æ³•ï¼Œé€™è£¡å˜—è©¦äº†å¹¾å€‹ç™¼ç¾<code>https://127.000000.000000.1/</code>(è¦æ³¨æ„å®ƒåªåƒçµ•å°ç¶²å€)é€™å€‹bypasså¯ä»¥æˆåŠŸè®“haasé¡¯ç¤º<code>&quot;Alive&quot;</code>ï¼Œä½†æˆ‘å€‘å¿…é ˆæ‹¿åˆ°è£¡é¢çš„å…§å®¹ï¼Œæ‰€ä»¥å°‡status codeæ”¹æ‰è®“haaså™´å‡ºErrorå¾Œå³å¯æ‹¿åˆ°flagã€‚</p>
<p>FLAG:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QQæˆ‘å¿˜äº†ï¼Œç„¶å¾Œé¡Œç›®æ©ŸæŠŠlocalhosté—œæ‰äº†TAT</span><br></pre></td></tr></table></figure>

<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="Microchip"><a href="#Microchip" class="headerlink" title="Microchip"></a>Microchip</h2><blockquote>
<p>Author: toxicpie</p>
</blockquote>
<p>é€™é¡Œçµ¦äº†ä¸€å€‹microchip.cppã€output.txtèˆ‡python.hæª”ï¼Œæ‰“é–‹è§€å¯Ÿå¾Œå¯ä»¥ç™¼ç¾å®ƒåˆ©ç”¨åŒ¯å…¥python.hçš„libraryé€²è¡Œpythonèªæ³•çš„æ··æ·†ï¼Œæ‰€ä»¥æ‡‰åªéœ€è¦è§€å¯Ÿç¨‹å¼é‚è¼¯å³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;python.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def track(name, id) -&gt; str ??                                                   &#123;</span><br><span class="line"></span><br><span class="line">    if len(name) % 4 == 0 ??                                                    )&#123;</span><br><span class="line">        padded = name + <span class="string">&quot;4444&quot;</span>                                                  ;&#125;</span><br><span class="line">    elif len(name) % 4 == 1 ??                                                  )&#123;</span><br><span class="line">        padded = name + <span class="string">&quot;333&quot;</span>                                                   ;&#125;</span><br><span class="line">    elif len(name) % 4 == 2 ??                                                  )&#123;</span><br><span class="line">        padded = name + <span class="string">&quot;22&quot;</span>                                                    ;&#125;</span><br><span class="line">    elif len(name) % 4 == 3 ??                                                  )&#123;</span><br><span class="line">        padded = name + <span class="string">&quot;1&quot;</span>                                                     ;&#125;</span><br><span class="line"></span><br><span class="line">    keys = <span class="built_in">list</span>()                                                               ;</span><br><span class="line">    temp = id                                                                   ;</span><br><span class="line">    for i in range(4) ??                                                        )&#123;</span><br><span class="line">        keys.<span class="built_in">append</span>(temp % <span class="number">96</span>)                                                  ;</span><br><span class="line">        temp = <span class="built_in"><span class="keyword">int</span></span>(temp / <span class="number">96</span>)                                                   ;&#125;</span><br><span class="line"></span><br><span class="line">    result = <span class="string">&quot;&quot;</span>                                                                 ;</span><br><span class="line">    for i in range(0, len(padded), 4) ??                                        )&#123;</span><br><span class="line"></span><br><span class="line">        nums = <span class="built_in">list</span>()                                                           ;</span><br><span class="line">        for j in range(4) ??                                                    )&#123;</span><br><span class="line">            num = <span class="built_in">ord</span>(padded[i + j]) - <span class="number">32</span>                                       ;</span><br><span class="line">            num = (num + keys[j]) % <span class="number">96</span>                                          ;</span><br><span class="line">            nums.<span class="built_in">append</span>(num + <span class="number">32</span>)                                               ;&#125;</span><br><span class="line"></span><br><span class="line">        result += <span class="built_in">chr</span>(nums[<span class="number">3</span>])                                                  ;</span><br><span class="line">        result += <span class="built_in">chr</span>(nums[<span class="number">2</span>])                                                  ;</span><br><span class="line">        result += <span class="built_in">chr</span>(nums[<span class="number">1</span>])                                                  ;</span><br><span class="line">        result += <span class="built_in">chr</span>(nums[<span class="number">0</span>])                                                  ;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result                                                               ;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main() -&gt; int ??                                                            &#123;</span><br><span class="line"></span><br><span class="line">    name = <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;r&quot;</span>).<span class="built_in">read</span>().<span class="built_in">strip</span>()                                 ;</span><br><span class="line">    id = <span class="built_in"><span class="keyword">int</span></span>(<span class="built_in">input</span>(<span class="string">&quot;key = &quot;</span>))                                                   ;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;result is:&quot;</span>, <span class="built_in">track</span>(name, id))                                        ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>                                                                    ;&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯output.txtçš„å…§å®¹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">result is:&#x3D;Js&amp;;*A&#96;odZHi&#39;&gt;D&#x3D;Js&amp;#i-DYf&gt;Uy&#39;yuyfyu&lt;)Gu</span><br></pre></td></tr></table></figure>
<p>å¾ç¨‹å¼ä¸­å¯ä»¥ç™¼ç¾ä»–å…ˆæŠŠflagé•·åº¦è£œæˆ4çš„å€æ•¸å¾Œï¼Œç”¨ä¸€çµ„å››å€‹keyä¾†å°flagé€²è¡Œä¸€æ¬¡4å­—å…ƒçš„é‹ç®—ã€‚ä½†æ˜¯ï¼Œæˆ‘å€‘æ²’æœ‰keyä¹Ÿæ²’æœ‰flagï¼Œè¦æ€éº¼é€†é‹ç®—å›å»?</p>
<p>å¾Œä¾†ç™¼ç¾æˆ‘å€‘å¯ä»¥åˆ©ç”¨flag format<code>AIS3&#123;...&#125;</code>ä¾†è§£æ±ºé€™ä»¶äº‹ï¼Œå…ˆç”¨å‰å››å€‹å·²çŸ¥flagå­—å…ƒæ­é…outputç®—å‡ºkeyä¹‹å¾Œï¼Œæˆ‘å€‘å°±èƒ½åˆ©ç”¨outputæ¨å›flagäº†ã€‚</p>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä»–æŠŠoutputå››å€‹é€†éä¾†è¼¸å‡ºï¼Œæ‰€ä»¥æˆ‘å€‘å…ˆæŠŠoutputé€†å›ä¾†æ¯”è¼ƒå®¹æ˜“è¨ˆç®—ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp;sJ&#x3D;&#96;A*;HZdoD&gt;&#39;i&amp;sJ&#x3D;D-i#U&gt;fYuy&#39;yuyfyuG)&lt;</span><br></pre></td></tr></table></figure>
<p>ç”¨<code>AIS3</code>èˆ‡<code>&amp;sJ=</code>å¯ä»¥ç®—å‡ºå››å€‹keyçš„å€¼:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;69,42,87,10&#125;</span><br></pre></td></tr></table></figure>
<p>æœ‰äº†outputèˆ‡keyå°±èƒ½å¯«ç¨‹å¼ä¾†é€†æ¨flagäº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line">string s=<span class="string">&quot;&amp;sJ=`A*;HZdoD&gt;&#x27;i&amp;sJ=D-i#U&gt;fYuy&#x27;yuyfyuG)&lt;&quot;</span>;</span><br><span class="line"><span class="keyword">int</span> k[<span class="number">4</span>]=&#123;<span class="number">69</span>,<span class="number">42</span>,<span class="number">87</span>,<span class="number">10</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">40</span>;i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">48</span>;;j++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(<span class="built_in"><span class="keyword">char</span></span>((((j<span class="number">-32</span>)+k[i%<span class="number">4</span>])%<span class="number">96</span>)+<span class="number">32</span>)==s[i])&#123;</span><br><span class="line">				cout&lt;&lt;<span class="built_in"><span class="keyword">char</span></span>(j);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	cout&lt;&lt;endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>P.S. å¾æˆ‘å€‘çš„çµæœå¯ä»¥ç™¼ç¾flagä¸€é–‹å§‹å¡äº†â€22â€åˆ°å¾Œé¢å–”~XD</p>
<p>FLAG:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;w31c0me_t0_AIS3_cryptoO0O0o0Ooo0&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ReSident-evil-villAge"><a href="#ReSident-evil-villAge" class="headerlink" title="ReSident evil villAge"></a>ReSident evil villAge</h2><blockquote>
<p>Author: Kuruwa</p>
</blockquote>
<p>é€™é¡Œçµ¦äº†ä¸€å€‹ncè·Ÿsource codeï¼Œæ‰“é–‹source codeçœ‹ä¸€ä¸‹ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socketserver</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> unhexlify</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Task</span>(<span class="params">socketserver.BaseRequestHandler</span>):</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">recv</span>(<span class="params">self</span>):</span></span><br><span class="line">		<span class="keyword">return</span> self.request.recv(<span class="number">1024</span>).strip()</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">send</span>(<span class="params">self, msg</span>):</span></span><br><span class="line">		self.request.sendall(msg + <span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">handle</span>(<span class="params">self</span>):</span></span><br><span class="line">		privkey = RSA.generate(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">		n = privkey.n</span><br><span class="line">		e = privkey.e</span><br><span class="line"></span><br><span class="line">		self.send(<span class="string">b&#x27;Welcome to ReSident evil villAge, sign the name &quot;Ethan Winters&quot; to get the flag.&#x27;</span>)</span><br><span class="line">		self.send(<span class="string">b&#x27;n = &#x27;</span> + <span class="built_in">str</span>(n).encode())</span><br><span class="line">		self.send(<span class="string">b&#x27;e = &#x27;</span> + <span class="built_in">str</span>(e).encode())</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">			self.request.sendall(<span class="string">b&#x27;1) sign\n2) verify\n3) exit\n&#x27;</span>)</span><br><span class="line">			option = self.recv()</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> option == <span class="string">b&#x27;1&#x27;</span>:</span><br><span class="line">				self.request.sendall(<span class="string">b&#x27;Name (in hex): &#x27;</span>)</span><br><span class="line">				msg = unhexlify(self.recv())</span><br><span class="line">				<span class="keyword">if</span> msg == <span class="string">b&#x27;Ethan Winters&#x27;</span> <span class="keyword">or</span> bytes_to_long(msg) &gt;= n:  <span class="comment"># msg+k*n not allowed</span></span><br><span class="line">					self.send(<span class="string">b&#x27;Nice try!&#x27;</span>)</span><br><span class="line">				<span class="keyword">else</span>:</span><br><span class="line">					sig = <span class="built_in">pow</span>(bytes_to_long(msg), privkey.d, n)     <span class="comment"># <span class="doctag">TODO:</span> Apply hashing first to prevent forgery</span></span><br><span class="line">					self.send(<span class="string">b&#x27;Signature: &#x27;</span> + <span class="built_in">str</span>(sig).encode())</span><br><span class="line"></span><br><span class="line">			<span class="keyword">elif</span> option == <span class="string">b&#x27;2&#x27;</span>:</span><br><span class="line">				self.request.sendall(<span class="string">b&#x27;Signature: &#x27;</span>)</span><br><span class="line">				sig = <span class="built_in">int</span>(self.recv())</span><br><span class="line">				verified = (<span class="built_in">pow</span>(sig, e, n) == bytes_to_long(<span class="string">b&#x27;Ethan Winters&#x27;</span>))</span><br><span class="line">				<span class="keyword">if</span> verified:</span><br><span class="line">					self.send(<span class="string">b&#x27;AIS3&#123;THIS_IS_A_FAKE_FLAG&#125;&#x27;</span>)</span><br><span class="line">				<span class="keyword">else</span>:</span><br><span class="line">					self.send(<span class="string">b&#x27;Well done!&#x27;</span>)</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ForkingServer</span>(<span class="params">socketserver.ForkingTCPServer, socketserver.TCPServer</span>):</span></span><br><span class="line">	<span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">	HOST, PORT = <span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">42069</span></span><br><span class="line">	<span class="built_in">print</span>(HOST, PORT)</span><br><span class="line">	server = ForkingServer((HOST, PORT), Task)</span><br><span class="line">	server.allow_reuse_address = <span class="literal">True</span></span><br><span class="line">	server.serve_forever()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å¾è£¡é¢å¯ä»¥ç™¼ç¾verifyçš„éƒ¨åˆ†æœƒæª¢æŸ¥è¨ˆç®—çš„çµæœæ˜¯å¦ç­‰æ–¼<code>bytes_to_long(b&#39;Ethan Winters&#39;)</code>ï¼Œè€Œå®ƒæœ‰çµ¦å®šnèˆ‡eï¼Œå› æ­¤åŸæœ¬çš„æƒ³æ³•æ˜¯çˆ†æœï¼Œä½†ç™¼ç¾æœä¸åˆ°æ–¼æ˜¯æ”¾æ£„é€™æ¢è·¯ã€‚</p>
<p>å†ä¾†çœ‹çœ‹æœ‰æ²’æœ‰å…¶ä»–çš„å¾Œé–€å¯ä»¥ç¹ã€‚signçš„éƒ¨åˆ†ï¼Œå®ƒæœƒæŠŠä½ çš„è¨»å†Šç”¨dè¨ˆç®—å¾Œå­˜ç‚ºsignatureã€‚ç”¨RSAçš„å°å¸¸è­˜ï¼Œç”¨då†ç”¨eé‹ç®—å¾ŒæœƒæŠŠåŸæœ¬çš„æ˜æ–‡ç®—å›ä¾†ï¼Œä½†å®ƒå‰é¢å‡ºç¾äº†ä¸€å€‹é™åˆ¶-<strong>è¦ç”¨16é€²ä½è¼¸å…¥è€Œä¸”ä¸èƒ½è¨»å†ŠEthan Wintersçš„å€¼</strong>ã€‚</p>
<p>åœ¨é€™è£¡è¦æ€éº¼ç¹éå‘¢?ç›´è§€çš„æƒ³æ³•ä¾¿æ˜¯åœ¨å‰é¢åŠ 00ï¼Œå› ç‚ºé€™æ¨£æ•¸å­—é‹ç®—çš„æ™‚å€™æœƒæŠŠ00çœç•¥ï¼Œä½†æ˜¯å­—ä¸²æ¯”è¼ƒæ™‚æœƒèˆ‡Ethan Wintersçš„å€¼ä¸åŒï¼Œæ‰€ä»¥ç”¨Ethan Wintersçš„16é€²ä½å€¼å†åŠ ä¸Š00å‰ç¶´è©¦è©¦çœ‹ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; <span class="string">&quot;Ethan Winters&quot;</span>.encode().hex()</span><br><span class="line"><span class="string">&#x27;457468616e2057696e74657273&#x27;</span></span><br></pre></td></tr></table></figure>
<p>æŠŠ<code>00457468616e2057696e74657273</code>ä¸Ÿé€²å»è¨»å†Šï¼Œå†æŠŠè·‘å‡ºä¾†çš„<code>Signature</code>verifyå³å¯æ‹¿åˆ°flagã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ nc quiz.ais3.org 42069</span><br><span class="line">Welcome to ReSident evil villAge, sign the name &quot;Ethan Winters&quot; to get the flag.</span><br><span class="line">n &#x3D; 116446349250477461211548564037305096646246352712613922877939621221682086442262006076658058243799666178199942844412251167013582517469698767681352409472676329468186602987766214457609857069612827869171818746620035374912701350547179213366848809313278051695960906542268549406826272373673111354786397335987091196949</span><br><span class="line">e &#x3D; 65537</span><br><span class="line">1) sign</span><br><span class="line">2) verify</span><br><span class="line">3) exit</span><br><span class="line">1</span><br><span class="line">Name (in hex): 00457468616e2057696e74657273</span><br><span class="line">Signature: 81461102639376645458445563890933604042666832496108067724180262424539703394619135196334363979456757148465714312599695970577392038142353089971541912561007212572874317390985050129115895139824645075534050013217923053352965259741321376550049801845665852962177362515169292380016928834541247529513691701369654301864</span><br><span class="line">1) sign</span><br><span class="line">2) verify</span><br><span class="line">3) exit</span><br><span class="line">2</span><br><span class="line">Signature: 81461102639376645458445563890933604042666832496108067724180262424539703394619135196334363979456757148465714312599695970577392038142353089971541912561007212572874317390985050129115895139824645075534050013217923053352965259741321376550049801845665852962177362515169292380016928834541247529513691701369654301864</span><br><span class="line">AIS3&#123;R3M383R_70_HAsh_7h3_M3Ssa93_83F0r3_S19N1N9&#125;</span><br></pre></td></tr></table></figure>
<p>FLAG:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;R3M383R_70_HAsh_7h3_M3Ssa93_83F0r3_S19N1N9&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Republic-of-South-Africa"><a href="#Republic-of-South-Africa" class="headerlink" title="Republic of South Africa"></a>Republic of South Africa</h2><blockquote>
<p>Author: Kuruwa</p>
</blockquote>
<p>é€™é¡Œçµ¦äº†ä¸€å€‹chall.pyèˆ‡output.txtï¼Œå…ˆä¾†çœ‹çœ‹ä»–çš„chall.pyè£¡é¢åšäº†ä»€éº¼äº‹æƒ…ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">gmpy2.get_context().precision = <span class="number">1024</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">collision</span>(<span class="params">m1, v1, m2, v2</span>):</span></span><br><span class="line">	<span class="keyword">return</span> v1*(m1-m2)/(m1+m2) + v2*(<span class="number">2</span>*m2)/(m1+m2), v1*(<span class="number">2</span>*m1)/(m1+m2) + v2*(m2-m1)/(m1+m2)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">keygen</span>(<span class="params">digits</span>):</span>     <span class="comment"># Warning: slow implementation</span></span><br><span class="line">	m1 = <span class="number">1</span></span><br><span class="line">	m2 = <span class="number">10</span> ** (<span class="number">2</span>*digits-<span class="number">2</span>)</span><br><span class="line">	v1 = gmpy2.mpfr(<span class="number">0</span>)</span><br><span class="line">	v2 = gmpy2.mpfr(-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">	count = <span class="number">0</span>       <span class="comment"># p+q</span></span><br><span class="line">	<span class="keyword">while</span> <span class="built_in">abs</span>(v1) &gt; v2 <span class="keyword">or</span> v1 &lt; <span class="number">0</span>:</span><br><span class="line">		<span class="keyword">if</span> v1 &lt; <span class="number">0</span>:</span><br><span class="line">			v1 = -v1</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			v1, v2 = collision(m1, v1, m2, v2)</span><br><span class="line">		count += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		p = random.randint(count//<span class="number">3</span>, count//<span class="number">2</span>)</span><br><span class="line">		q = count - p</span><br><span class="line">		<span class="keyword">if</span> isPrime(p) <span class="keyword">and</span> isPrime(q):</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">	<span class="keyword">return</span> p, q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p, q = keygen(<span class="number">153</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;e =&#x27;</span>, e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>, <span class="built_in">pow</span>(m, e, n))</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥ç™¼ç¾ä»–ç”¨ä¸€ç¨®ç¥å¥‡çš„ç®—æ³•ä¾†ç”¢å‡ºRSAåƒæ•¸ï¼Œé‚£å°±ä¾†çœ‹çœ‹ä»–æ˜¯æ€éº¼è¨ˆç®—çš„å§ã€‚</p>
<p>ä¸€é–‹å§‹çœŸçš„çœ‹ä¸å¤ªå‡ºä¾†ä¸Šé¢çš„è¨ˆç®—æ˜¯ä»€éº¼æ„æ€ï¼Œå¡äº†å¥½ä¸€é™£å­ã€‚å¾Œä¾†åˆå›é ­çœ‹çœ‹é¡Œç›®ï¼Œcollisionæ˜¯æŒ‡ç¢°æ’ï¼Œå†å›é ­çœ‹çœ‹source codeï¼Œç™¼ç¾ä»–å¾ˆå¥½å¿ƒçš„æŠŠè®Šæ•¸è¨­æˆm1è·Ÿv1é€™ç¨®å‹æ…‹ï¼Œåˆ†åˆ¥ä»£è¡¨äº†è³ªé‡å’Œé€Ÿåº¦!</p>
<p>è€Œcollision functionè£¡é¢å‚³å›çš„ä¾¿æ˜¯ä¸€ç¶­ç¢°æ’å¾Œå…©å€‹ç‰©é«”åˆ†åˆ¥çš„é€Ÿåº¦å…¬å¼ï¼Œå¾é€™è£¡å¯ä»¥ç¢ºå®šç¢°æ’çš„æƒ³æ³•æ˜¯æ­£ç¢ºçš„äº†ã€‚</p>
<p>å…¶ä¸­<code>v1</code>&lt;0æ™‚ï¼Œç¨‹å¼æœƒå°‡å®ƒè®Šæˆç›¸åæ•¸ï¼Œå°±åƒæ’ä¸Šäº†ç‰†å£ç„¡èƒ½é‡æå¤±çš„åå½ˆã€‚å› æ­¤ç¶œåˆèµ·ä¾†ï¼Œå…©å€‹ç‰©é«”åœ¨é€²è¡Œç¢°æ’ä¸”m1æ–¹æœ‰ä¸€é¢ç‰†å£ï¼Œè€Œé€™æ™‚å€™çœ‹çœ‹countè®Šæ•¸ï¼Œå®ƒæ¯ç¢°æ’ä¸€æ¬¡ä¾¿æœƒ+1ï¼Œå› æ­¤æ˜¯è¨ˆç®—ç¢°æ’æ¬¡æ•¸ï¼Œå¾é€™è£¡ç›´æ¥è¯æƒ³åˆ°ç‰©ç†ç¢°æ’çš„è‘—åç¶“å…¸å•é¡Œ:</p>
<p><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=Un7mK05b9oA">å¾ç‰©ç†ç¢°æ’å¾—å‡ºåœ“å‘¨ç‡$\pi$</a></p>
<p>å¾—åˆ°é€™å€‹çµè«–ä¹‹å¾Œå°±å®¹æ˜“è¨±å¤šäº†ï¼Œå®ƒçµ¦å®šè³ªé‡æ˜¯$1:10^{(2\times153-2)}$ï¼Œå› æ­¤å¯ä»¥å¾—åˆ°countä¾¿æ˜¯åœ“å‘¨ç‡çš„å‰154ä½(æ¨è«–éç¨‹è©³è¦‹å½±ç‰‡)ï¼Œè€Œå¾è£¡é¢å¯ä»¥å¾—åˆ°count=p+qï¼Œæ‰€ä»¥æˆ‘å€‘ä¾¿å¾—åˆ°äº†<code>p+q=314159265358979323846264338327950288419716939937510582097494459230781640628620899862803482534211706798214808651328230664709384460955058223172535940812848</code>é€™å€‹æ¢ä»¶ã€‚</p>
<p>é‚£æˆ‘å€‘éœ€è¦æŠŠpè·Ÿqè§£å‡ºä¾†å—?ä¸éœ€è¦!åˆ†åˆ¥å¾—åˆ°p,qæ˜¯å› ç‚ºæˆ‘å€‘éœ€è¦è¨ˆç®—$\phi(n)$çš„å€¼ï¼Œä½†ç¾åœ¨æˆ‘å€‘æœ‰$n=p\times q$èˆ‡$p+q$å…©å€‹æ¢ä»¶äº†ï¼Œé€™æ¨£$\phi(n)=(p-1)(q-1)=p\times q-(p+q)+1$ä¾¿å¯ä»¥è¨ˆç®—äº†ã€‚</p>
<p>æ¥ä¸‹ä¾†å°±æ˜¯ç”¨ç°¡å–®çš„RSAæ¦‚å¿µä¾†è§£æ±ºå®ƒå›‰!</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">23662270311503602529211462628663973377651035055221337186547659666520360329842954292759496973737109678655075242892199643594552737098393308599593056828393773327639809644570618472781338585802514939812387999523164606025662379300143159103239039862833152034195535186138249963826772564309026532268561022599227047</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">11458615427536252698065643586706850515055080432343893818398610010478579108516179388166781637371605857508073447120074461777733767824330662610330121174203247272860627922171793234818603728793293847713278049996058754527159158251083995933600335482394024095666411743953262490304176144151437205651312338816540536</span></span><br><span class="line">k = <span class="number">314159265358979323846264338327950288419716939937510582097494459230781640628620899862803482534211706798214808651328230664709384460955058223172535940812848</span></span><br><span class="line"></span><br><span class="line">phi = n-k+<span class="number">1</span></span><br><span class="line">d = inverse(e, phi)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c, d, n)))</span><br></pre></td></tr></table></figure>

<p>FLAG:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v&#x3D;jsYwFizhncE&#125;</span><br></pre></td></tr></table></figure>
<p>åŸä¾†flagè£¡é¢çµ¦äº†ä¸€å€‹ç¢°æ’çš„å½±ç‰‡å•Š~æœ‰è¶£çš„é¡Œç›®XD</p>
<h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="Piano"><a href="#Piano" class="headerlink" title="Piano"></a>Piano</h2><blockquote>
<p>Author: CSY54</p>
</blockquote>
<p>é€™é¡Œçµ¦äº†ä¸€å€‹zipï¼Œè£¡é¢åŒ…äº†ä¸€å †é¡å¤–çš„è¨­å®šæª”ä¹‹é¡çš„æ±è¥¿ã€‚å…ˆä¾†åŸ·è¡Œpiano.exeï¼Œä½†å®ƒè·³å‡ºäº†ä¸€å€‹alertè¦æˆ‘å…ˆå»ä¸‹è¼‰.NETçš„frameworkï¼Œé€™ç‚ºæˆ‘åœ¨ä¸‹ä¸€æ­¥è§£é¡Œæ™‚é–‹äº†ä¸€é“æ›™å…‰ã€‚</p>
<p>æ‰“é–‹ä¹‹å¾Œï¼Œå®ƒæ˜¯ä¸€å€‹GUIç´é¢ï¼Œä½†æ˜¯â€¦ä¸çŸ¥é“è¦å½ˆä»€éº¼ã€‚çœ‹èµ·ä¾†æ‡‰è©²ä¸èƒ½å¾é€™è£¡ä¸‹æ‰‹ï¼Œé‚£æ‡‰è©²å°±æ˜¯è¦reverseäº†ã€‚</p>
<p><img src="https://i.imgur.com/4eYCFcw.png"></p>
<p>å…ˆç”¨IDA Proæ‰“é–‹.exeçœ‹çœ‹ï¼Œä½†æ²’æœ‰ç™¼ç¾ä»€éº¼å¯ä»¥ç”¨çš„æ±è¥¿ã€‚å¾Œä¾†æƒ³åˆ°ä¸€é–‹å§‹é¡¯ç¤ºçš„<code>.NET</code>ï¼Œæ–¼æ˜¯ä¸Šç¶²æŸ¥äº†ä¸€ä¸‹é—œéµå­—<code>.NET reverse</code>ï¼Œåœ¨<a target="_blank" rel="noopener" href="https://pelock.medium.com/reverse-engineering-tools-for-net-applications-a28275f185b4">é€™å€‹ç¶²ç«™</a>è£¡é¢ç™¼ç¾äº†ä¸€å€‹å«<code>dnSpy</code>çš„å·¥å…·ï¼Œå¯ä»¥å°.NETä¸‹çš„frameworké€²è¡Œreverseã€‚é‚£å°±ä¾†ç”¨ç”¨å®ƒå§!</p>
<p>ç”¨dnSpyæ‰“é–‹piano.exeæ²’æœ‰ç™¼ç¾æ±è¥¿ï¼Œä½†æ‰“é–‹piano.dllä¹‹å¾Œç¿»æ‰¾äº†ä¸€ä¸‹ï¼Œç™¼ç¾å…©å€‹ç‰¹åˆ¥å¯ç–‘çš„function<code>isValid()</code>èˆ‡<code>nya()</code>:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// piano.Piano</span></span><br><span class="line"><span class="comment">// Token: 0x06000003 RID: 3 RVA: 0x00002220 File Offset: 0x00000420</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="built_in">bool</span> <span class="title">isValid</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	List&lt;<span class="built_in">int</span>&gt; list = <span class="keyword">new</span> List&lt;<span class="built_in">int</span>&gt;</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="number">14</span>,</span><br><span class="line">		<span class="number">17</span>,</span><br><span class="line">		<span class="number">20</span>,</span><br><span class="line">		<span class="number">21</span>,</span><br><span class="line">		<span class="number">22</span>,</span><br><span class="line">		<span class="number">21</span>,</span><br><span class="line">		<span class="number">19</span>,</span><br><span class="line">		<span class="number">18</span>,</span><br><span class="line">		<span class="number">12</span>,</span><br><span class="line">		<span class="number">6</span>,</span><br><span class="line">		<span class="number">11</span>,</span><br><span class="line">		<span class="number">16</span>,</span><br><span class="line">		<span class="number">15</span>,</span><br><span class="line">		<span class="number">14</span></span><br><span class="line">	&#125;;</span><br><span class="line">	List&lt;<span class="built_in">int</span>&gt; list2 = <span class="keyword">new</span> List&lt;<span class="built_in">int</span>&gt;</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="number">0</span>,</span><br><span class="line">		<span class="number">-3</span>,</span><br><span class="line">		<span class="number">0</span>,</span><br><span class="line">		<span class="number">-1</span>,</span><br><span class="line">		<span class="number">0</span>,</span><br><span class="line">		<span class="number">1</span>,</span><br><span class="line">		<span class="number">1</span>,</span><br><span class="line">		<span class="number">0</span>,</span><br><span class="line">		<span class="number">6</span>,</span><br><span class="line">		<span class="number">0</span>,</span><br><span class="line">		<span class="number">-5</span>,</span><br><span class="line">		<span class="number">0</span>,</span><br><span class="line">		<span class="number">1</span>,</span><br><span class="line">		<span class="number">0</span></span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">14</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">this</span>.notes[i] + <span class="keyword">this</span>.notes[(i + <span class="number">1</span>) % <span class="number">14</span>] != list[i])</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">this</span>.notes[i] - <span class="keyword">this</span>.notes[(i + <span class="number">1</span>) % <span class="number">14</span>] != list2[i])</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// piano.Piano</span></span><br><span class="line"><span class="comment">// Token: 0x06000004 RID: 4 RVA: 0x0000236C File Offset: 0x0000056C</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="built_in">string</span> <span class="title">nya</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	List&lt;<span class="built_in">int</span>&gt; list = <span class="keyword">new</span> List&lt;<span class="built_in">int</span>&gt;</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="number">70</span>,</span><br><span class="line">		<span class="number">78</span>,</span><br><span class="line">		<span class="number">89</span>,</span><br><span class="line">		<span class="number">57</span>,</span><br><span class="line">		<span class="number">112</span>,</span><br><span class="line">		<span class="number">60</span>,</span><br><span class="line">		<span class="number">125</span>,</span><br><span class="line">		<span class="number">96</span>,</span><br><span class="line">		<span class="number">103</span>,</span><br><span class="line">		<span class="number">104</span>,</span><br><span class="line">		<span class="number">50</span>,</span><br><span class="line">		<span class="number">109</span>,</span><br><span class="line">		<span class="number">87</span>,</span><br><span class="line">		<span class="number">115</span>,</span><br><span class="line">		<span class="number">112</span>,</span><br><span class="line">		<span class="number">54</span>,</span><br><span class="line">		<span class="number">100</span>,</span><br><span class="line">		<span class="number">97</span>,</span><br><span class="line">		<span class="number">103</span>,</span><br><span class="line">		<span class="number">56</span>,</span><br><span class="line">		<span class="number">85</span>,</span><br><span class="line">		<span class="number">101</span>,</span><br><span class="line">		<span class="number">56</span>,</span><br><span class="line">		<span class="number">119</span>,</span><br><span class="line">		<span class="number">119</span>,</span><br><span class="line">		<span class="number">100</span>,</span><br><span class="line">		<span class="number">59</span>,</span><br><span class="line">		<span class="number">88</span>,</span><br><span class="line">		<span class="number">50</span>,</span><br><span class="line">		<span class="number">48</span>,</span><br><span class="line">		<span class="number">62</span>,</span><br><span class="line">		<span class="number">120</span>,</span><br><span class="line">		<span class="number">84</span>,</span><br><span class="line">		<span class="number">58</span>,</span><br><span class="line">		<span class="number">100</span>,</span><br><span class="line">		<span class="number">86</span>,</span><br><span class="line">		<span class="number">74</span>,</span><br><span class="line">		<span class="number">92</span>,</span><br><span class="line">		<span class="number">54</span>,</span><br><span class="line">		<span class="number">96</span>,</span><br><span class="line">		<span class="number">60</span>,</span><br><span class="line">		<span class="number">117</span>,</span><br><span class="line">		<span class="number">119</span>,</span><br><span class="line">		<span class="number">122</span></span><br><span class="line">	&#125;;</span><br><span class="line">	List&lt;<span class="built_in">char</span>&gt; list2 = <span class="keyword">new</span> List&lt;<span class="built_in">char</span>&gt;();</span><br><span class="line">	<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; list.Count; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		list2.Add((<span class="built_in">char</span>)(list[i] ^ <span class="keyword">this</span>.notes[i % <span class="keyword">this</span>.notes.Count]));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">string</span>(list2.ToArray());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è§€å¯Ÿä¸€ä¸‹å…©å€‹$function$çš„é—œä¿‚ï¼Œç™¼ç¾åˆ©ç”¨<code>isValid()</code>çš„æ¢ä»¶å¯ä»¥ç®—å‡ºnotesçš„å€¼ï¼Œç„¶å¾Œé€åˆ°<code>nya()</code>å¯ä»¥æŠŠflagè¨ˆç®—å‡ºä¾†ï¼Œé‚£å°±å¯«å€‹ç¨‹å¼ä¾†å¯¦ä½œå°±å®Œæˆäº†ã€‚</p>
<p>å…ˆæ‰‹å‹•ç®—å‡ºnotesçš„å€¼(å¾ˆç°¡å–®å•¦ä¸éœ€è¦ç¨‹å¼XD):</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;7,7,10,10,11,11,10,9,9,3,3,8,8,7,7&#125;</span><br></pre></td></tr></table></figure>
<p>æ¥è‘—å¥—å…¥<code>nya()</code>é‚è¼¯:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> k[<span class="number">100</span>]=&#123;   <span class="number">70</span>,</span><br><span class="line">		<span class="number">78</span>,</span><br><span class="line">		<span class="number">89</span>,</span><br><span class="line">		<span class="number">57</span>,</span><br><span class="line">		<span class="number">112</span>,</span><br><span class="line">		<span class="number">60</span>,</span><br><span class="line">		<span class="number">125</span>,</span><br><span class="line">		<span class="number">96</span>,</span><br><span class="line">		<span class="number">103</span>,</span><br><span class="line">		<span class="number">104</span>,</span><br><span class="line">		<span class="number">50</span>,</span><br><span class="line">		<span class="number">109</span>,</span><br><span class="line">		<span class="number">87</span>,</span><br><span class="line">		<span class="number">115</span>,</span><br><span class="line">		<span class="number">112</span>,</span><br><span class="line">		<span class="number">54</span>,</span><br><span class="line">		<span class="number">100</span>,</span><br><span class="line">		<span class="number">97</span>,</span><br><span class="line">		<span class="number">103</span>,</span><br><span class="line">		<span class="number">56</span>,</span><br><span class="line">		<span class="number">85</span>,</span><br><span class="line">		<span class="number">101</span>,</span><br><span class="line">		<span class="number">56</span>,</span><br><span class="line">		<span class="number">119</span>,</span><br><span class="line">		<span class="number">119</span>,</span><br><span class="line">		<span class="number">100</span>,</span><br><span class="line">		<span class="number">59</span>,</span><br><span class="line">		<span class="number">88</span>,</span><br><span class="line">		<span class="number">50</span>,</span><br><span class="line">		<span class="number">48</span>,</span><br><span class="line">		<span class="number">62</span>,</span><br><span class="line">		<span class="number">120</span>,</span><br><span class="line">		<span class="number">84</span>,</span><br><span class="line">		<span class="number">58</span>,</span><br><span class="line">		<span class="number">100</span>,</span><br><span class="line">		<span class="number">86</span>,</span><br><span class="line">		<span class="number">74</span>,</span><br><span class="line">		<span class="number">92</span>,</span><br><span class="line">		<span class="number">54</span>,</span><br><span class="line">		<span class="number">96</span>,</span><br><span class="line">		<span class="number">60</span>,</span><br><span class="line">		<span class="number">117</span>,</span><br><span class="line">		<span class="number">119</span>,</span><br><span class="line">		<span class="number">122</span></span><br><span class="line">&#125;;</span><br><span class="line">		</span><br><span class="line"><span class="keyword">int</span> n[<span class="number">15</span>]=&#123;<span class="number">7</span>,<span class="number">7</span>,<span class="number">10</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">11</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">8</span>,<span class="number">8</span>,<span class="number">7</span>,<span class="number">7</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">50</span>;i++)&#123;</span><br><span class="line">		cout&lt;&lt;<span class="built_in"><span class="keyword">char</span></span>(k[i]^n[i%<span class="number">14</span>]);</span><br><span class="line">	&#125;</span><br><span class="line">	cout&lt;&lt;endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>FLAG:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;7wink1e_tw1nkl3_l1ttl3_574r_1n_C_5h4rp&#125;</span><br></pre></td></tr></table></figure>
<p>P.S. æ‰€ä»¥ç”¨C#èª¿å½ˆå°æ˜Ÿæ˜ŸçœŸçš„å¯ä»¥æ‹¿åˆ°flagå–”~XD<br><img src="https://i.imgur.com/xU0s8Qn.png"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Albert Huang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://albert-notes.github.io/2021/06/06/AIS3-2021-preexam/">http://albert-notes.github.io/2021/06/06/AIS3-2021-preexam/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/AIS3/">AIS3</a><a class="post-meta__tags" href="/tags/Security/">Security</a><a class="post-meta__tags" href="/tags/CTF/">CTF</a></div><div class="post_share"><div class="social-share" data-image="/img/ais.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/06/04/YMMC-1/"><img class="prev-cover" src="/img/ymc.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">2020 1st YMMC ç‡Ÿå¾Œæ•´ç† Day I</div></div></a></div><div class="next-post pull-right"><a href="/2021/06/06/myfirstctf-2021/"><img class="next-cover" src="/img/mfc.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">2021 MyFirstCTF Write Up</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2021/06/06/myfirstctf-2021/" title="2021 MyFirstCTF Write Up"><img class="cover" src="/img/mfc.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-06-06</div><div class="title">2021 MyFirstCTF Write Up</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="/img/ban.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Albert Huang</div><div class="author-info__description">Decide your own life.</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">8</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">10</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/albert-notes"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/albert-notes" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:alb105322129@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://www.instagram.com/albert.huang_57/" target="_blank" title="Instagram"><i class="fab fa-instagram"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>Announcement</span></div><div class="announcement_content">Here is Albert Huang's website!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Welcome"><span class="toc-number">1.</span> <span class="toc-text">Welcome</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Cat-Slayer-%E1%B6%A0%E1%B5%83%E1%B5%8F%E1%B5%89-Nekogoroshi"><span class="toc-number">1.1.</span> <span class="toc-text">Cat Slayer á¶ áµƒáµáµ‰ | Nekogoroshi</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MISC"><span class="toc-number">2.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Microcheese"><span class="toc-number">2.1.</span> <span class="toc-text">Microcheese</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Web"><span class="toc-number">3.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%B2%A9%E2%B2%89%E2%B2%A7-%E2%B2%81%E2%B2%9B%E2%B2%9F%E2%B2%A7%E2%B2%8F%E2%B2%89s-%F0%9D%93%B5%E2%B2%9F%F0%9D%93%B0%E2%B2%93%E2%B2%9B-%E2%B2%A3%E2%B2%81%F0%9D%93%B0%E2%B2%89"><span class="toc-number">3.1.</span> <span class="toc-text">â²©â²‰â²§ â²â²›â²Ÿâ²§â²â²‰ê… ğ“µâ²Ÿğ“°â²“â²› â²£â²ğ“°â²‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HaaS"><span class="toc-number">3.2.</span> <span class="toc-text">HaaS</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Crypto"><span class="toc-number">4.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Microchip"><span class="toc-number">4.1.</span> <span class="toc-text">Microchip</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ReSident-evil-villAge"><span class="toc-number">4.2.</span> <span class="toc-text">ReSident evil villAge</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Republic-of-South-Africa"><span class="toc-number">4.3.</span> <span class="toc-text">Republic of South Africa</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Reverse"><span class="toc-number">5.</span> <span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Piano"><span class="toc-number">5.1.</span> <span class="toc-text">Piano</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/06/09/Immune-2/" title="æ¼«è«‡å…ç–«å­¸BLOGç­†è¨˜-Day II"><img src="/img/bld.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="æ¼«è«‡å…ç–«å­¸BLOGç­†è¨˜-Day II"/></a><div class="content"><a class="title" href="/2021/06/09/Immune-2/" title="æ¼«è«‡å…ç–«å­¸BLOGç­†è¨˜-Day II">æ¼«è«‡å…ç–«å­¸BLOGç­†è¨˜-Day II</a><time datetime="2021-06-09T06:51:24.000Z" title="Created 2021-06-09 14:51:24">2021-06-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/06/06/myfirstctf-2021/" title="2021 MyFirstCTF Write Up"><img src="/img/mfc.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2021 MyFirstCTF Write Up"/></a><div class="content"><a class="title" href="/2021/06/06/myfirstctf-2021/" title="2021 MyFirstCTF Write Up">2021 MyFirstCTF Write Up</a><time datetime="2021-06-06T06:08:29.000Z" title="Created 2021-06-06 14:08:29">2021-06-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/06/06/AIS3-2021-preexam/" title="2021 AIS3 Pre-exam Write Up"><img src="/img/ais.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2021 AIS3 Pre-exam Write Up"/></a><div class="content"><a class="title" href="/2021/06/06/AIS3-2021-preexam/" title="2021 AIS3 Pre-exam Write Up">2021 AIS3 Pre-exam Write Up</a><time datetime="2021-06-06T06:08:29.000Z" title="Created 2021-06-06 14:08:29">2021-06-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/06/04/YMMC-1/" title="2020 1st YMMC ç‡Ÿå¾Œæ•´ç† Day I"><img src="/img/ymc.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2020 1st YMMC ç‡Ÿå¾Œæ•´ç† Day I"/></a><div class="content"><a class="title" href="/2021/06/04/YMMC-1/" title="2020 1st YMMC ç‡Ÿå¾Œæ•´ç† Day I">2020 1st YMMC ç‡Ÿå¾Œæ•´ç† Day I</a><time datetime="2021-06-04T11:55:18.000Z" title="Created 2021-06-04 19:55:18">2021-06-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/05/20/Immune-1/" title="æ¼«è«‡å…ç–«å­¸BLOGç­†è¨˜-Day I"><img src="/img/hog.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="æ¼«è«‡å…ç–«å­¸BLOGç­†è¨˜-Day I"/></a><div class="content"><a class="title" href="/2021/05/20/Immune-1/" title="æ¼«è«‡å…ç–«å­¸BLOGç­†è¨˜-Day I">æ¼«è«‡å…ç–«å­¸BLOGç­†è¨˜-Day I</a><time datetime="2021-05-20T07:37:00.000Z" title="Created 2021-05-20 15:37:00">2021-05-20</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By Albert Huang</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="Increase font size"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="Decrease font size"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    loader: {
      source: {
        '[tex]/amsCd': '[tex]/amscd'
      }
    },
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        addClass: [200,() => {
          document.querySelectorAll('mjx-container:not([display=\'true\']').forEach( node => {
            const target = node.parentNode
            if (!target.classList.contains('has-jax')) {
              target.classList.add('mathjax-overflow')
            }
          })
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.css"><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', '', 'katex-wrap')
  })
})()</script><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(() => {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'default',
      })
      false && mermaid.init()
    })
  }
}</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script src="//code.tidio.co/qqpjqsklrzstouh4l6ias23ukyxcbm3p.js" async="async"></script><script>function chatBtnHide () {
  if (window.tidioChatApi) {
    //- window.tidioChatApi.hide();
    document.getElementById('tidio-chat').style.display= 'none'
  }
}

function chatBtnShow () {
  if (window.tidioChatApi) {
    //- window.tidioChatApi.show();
    document.getElementById('tidio-chat').style.display= 'block'
  } 
}</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>